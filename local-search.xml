<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Power Automate</title>
    <link href="/2023/03/08/PowerAutomate/"/>
    <url>/2023/03/08/PowerAutomate/</url>
    
    <content type="html"><![CDATA[<p>在上一篇文章《<a href="https://hncd1024.github.io/2022/08/26/Python%20selenium/">Python|selenium实现自动点赞收藏(进阶版)</a>》中写过利用 python 的selenium 实现网页自动化点赞+收藏的功能，但使用上需要有一定 python 基础。<br />近期在电脑上发现了微软win11系统预装的 Power Automate，就用同样的某网站点赞的案例进行了体验。</p><h1 id="测试过程"><a class="markdownIt-Anchor" href="#测试过程"></a> 测试过程</h1><p>登录并打开待处理的列表界面。<br /><img src="https://i.328888.xyz/2023/03/08/5Sy23.png" alt="登录过程" /><br />获取未点赞的链接，并打开进行点赞、收藏。<br /><img src="https://i.328888.xyz/2023/03/08/5SVqv.png" alt="点赞、收藏过程" /><br />运行登录，并循环进行点赞、收藏。<br /><img src="https://i.328888.xyz/2023/03/08/5SidU.png" alt="循环遍历" /><br />测试结果基本满足需要，后续可发掘更丰富的应用场景。</p><h1 id="总结一下"><a class="markdownIt-Anchor" href="#总结一下"></a> 总结一下</h1><p>Microsoft Power Automate是一个低代码平台的RPA工具，可以辅助用户进行流程自动化办公，提升工作效率。相比我之前接触过的UIPath，个人感觉相对具有优势。</p><div class="note note-primary">            <p>优势一：Power Automate对终端个人用户免费，从win11系统预装就可以看出微软还是诚意满满的。相比UIPath作为一款需授权使用的软件，使用门槛较高。</p>          </div><div class="note note-primary">            <p>优势二：系统集成较好，作为微软出品，Power Automate对微软环境下的应用交互做的比较好。除office全家桶都能很好的交互外，对http、FTP等服务支持也比较友好，甚至Power Automate还支持python、JS、VB、shell等脚本。真香！</p>          </div><div class="note note-primary">            <p>优势三：你见过自动帮你进行流程设计的RPA工具吗？Power Automate可以！即便你不会自己设计流程，你可以打开Power Automate的捕获功能。然后你只需要给它演示下你要怎么做，Power Automate便会自动帮你生成流程（当然一般情况下还是要在此基础上再优化调整的）。</p>          </div> ]]></content>
    
    
    <categories>
      
      <category>PowerAutomate</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PowerAutomate</tag>
      
      <tag>RPA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>计算机|记一次CPU降频问题排查与修复</title>
    <link href="/2023/02/03/LowerCpuUsage/"/>
    <url>/2023/02/03/LowerCpuUsage/</url>
    
    <content type="html"><![CDATA[<p>去年买了台笔记本电脑，i7-11390H 3.42Ghz处理器，16.0 GB内存，512G SSD，使用一段时间感觉如德芙般丝滑。大概一个月前系统出现异常卡顿的现象，CPU和内存使用率低到不行，但开机和运行程序就是很卡，响应延迟和掉帧很严重。打开个文件夹都能慢到怀疑人生，感觉初中微机课的XP系统都比它要顺畅😂😂😂<br />折腾了很久都没有解决问题，我都想重装系统试一下了（考虑到本地的几个开发环境迁移太麻烦而不甘心）。就在今天终于找到了问题原因~</p><h2 id="结论在前"><a class="markdownIt-Anchor" href="#结论在前"></a> 结论在前</h2><p>CPU静电导致的降频、锁频</p><h2 id="排查过程"><a class="markdownIt-Anchor" href="#排查过程"></a> 排查过程</h2><h3 id="怀疑win11升级导致"><a class="markdownIt-Anchor" href="#怀疑win11升级导致"></a> 怀疑win11升级导致</h3><p>最近半年一直在体验win11，微软更新也挺积极的，我首先怀疑是win11系统本身导致的卡顿。恰巧我win11 22H2更新包一直打不上去，让我严重怀疑是当前版本的操作系统bug。<br />废了很大功夫去修复操作系统的更新问题，甚至重装了Windows Update功能也不行。</p><h3 id="怀疑病毒文件导致"><a class="markdownIt-Anchor" href="#怀疑病毒文件导致"></a> 怀疑病毒文件导致</h3><p>CPU和内存使用率很低，电脑却很卡。先确认电脑没有安装某数字安全管家、某度安全管家、某讯安全管家。然后扫描了全盘也没有发现病毒文件、恶意以文件，后台进程看起来也很正常。😂😂😂</p><h3 id="怀疑系统配置导致"><a class="markdownIt-Anchor" href="#怀疑系统配置导致"></a> 怀疑系统配置导致</h3><p>网上找了一大堆教程，Windows外观和性能设置调整位最佳性能了，没用；电池使用计划也调整为了高性能，没用；存储感知开了，没用；临时文件删了，没用……</p><h3 id="怀疑电脑品牌问题"><a class="markdownIt-Anchor" href="#怀疑电脑品牌问题"></a> 怀疑电脑品牌问题</h3><p>我购买的是小米pro14增强版顶配，网上搜索小米电脑卡顿时发现负面评价一大堆，但我内心仍然觉得硬件问题可能性不大，浏览很多网页觉得没有太多有效信息。</p><h3 id="怀疑硬件故障"><a class="markdownIt-Anchor" href="#怀疑硬件故障"></a> 怀疑硬件故障</h3><p>到这里我基本感觉就是硬件故障了，官方维修点也查了，都准备要走维修了。然后我打开任务管理器想看下磁盘卷是否故障，突然发现CPU一直是0.38Ghz，这肯定是不正常的。之后测试打开了几个程序服务，CPU始终锁频在0.38，终于找到故障的原因了！</p><h2 id="解决方法"><a class="markdownIt-Anchor" href="#解决方法"></a> 解决方法</h2><p>网上搜索CPU锁频、CPU降频：<br />有 <strong>更换风扇和重打硅胶</strong> 的：电脑才使用半年不到，灰尘肯定不多，这个可能性不大；<br />有帖子说 <strong>BIOS升级导致</strong> 的：我在小米官网上下载了最新的BIOS重新升级了驱动，依旧无效；<br />有帖子说小米工程师为了降低功耗延长使用时间 <strong>故意降频</strong> 了（保持中立），之后我找到ThrottleStop这款软件，专门解除笔记本电脑的温度墙，调整CPU时钟速度。为了性能已经不在乎温度了，果断下载测试了下，发现还是无效；<br />最终看到一个原因是 <strong>CPU静电</strong> ，会造成CPU静电保护主动降频锁频。至此终于找到了问题的根本原因！！！<br /><font color="#dd0000">电脑关机键长按了1min释放CPU静电，之后重新打开电脑发现德芙回来了，丝滑如初~👍👍👍  </font><br />最后也为小米电脑正个名，比起Thinkxxx，稳定性完胜。Thinkxxx已经不是当年的Thinkxxx了，惋惜~</p>]]></content>
    
    
    <categories>
      
      <category>计算机问题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机问题</tag>
      
      <tag>CPU降频</tag>
      
      <tag>CPU锁频</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NC|科目表调整</title>
    <link href="/2022/11/04/yonyouNC_account/"/>
    <url>/2022/11/04/yonyouNC_account/</url>
    
    <content type="html"><![CDATA[<p>一个朋友最近又碰到了关于用友NC系统科目表变更的问题，上次忘了记录过程，后悔莫及~ 这次完整的记录下来，以备后用。</p><h2 id="问题背景"><a class="markdownIt-Anchor" href="#问题背景"></a> 问题背景</h2><p>XX集团使用用友 NC Cloud 产品，下属多个业务单元，采用集团管控，系统中各业务单元均使用的是集团科目表。后因各业务单元主营业务差异，需改为集团+分级管控（即允许各业务单元会计科目的差异化管理）。</p><h2 id="环境现状"><a class="markdownIt-Anchor" href="#环境现状"></a> 环境现状</h2><ol><li><strong>业务单元:</strong><br />33个业务单元（含集团虚拟组织及4个工会组织），最多三级，其中一家启用了资金模块。</li><li><strong>账簿类型:</strong><br />默认基准账簿，另增加一个工会账簿（用于工会组织使用）。</li><li><strong>财务核算账簿:</strong><br />14个业务单元基准账簿（均使用集团科目表），四个工会账簿。</li><li><strong>科目体系:</strong><br />基准账簿引用“XX集团科目体系”。工会引用“工会科目体系”。</li><li><strong>会计科目:</strong> 【会计科目-财务组织】中没有维护科目表，会计科目未使用多版本。</li><li><strong>总账：</strong> 2020-12启用。</li></ol><h2 id="调整思路"><a class="markdownIt-Anchor" href="#调整思路"></a> 调整思路</h2><ol><li>【会计科目-财务组织】中为对应的财务组织增加组织级科目表。</li><li>后台更新对应财务组织的财务核算账簿所引用的科目表。</li><li>后台调整bd_account、bd_accasoa等科目相关基础数据表。</li><li>后台调整gl_detail等凭证相关数据表。</li><li>总账期初余额、凭证、科目余额表等功能验证。</li><li>会计平台梳理。</li></ol><h2 id="调整步骤"><a class="markdownIt-Anchor" href="#调整步骤"></a> 调整步骤</h2><div class="note note-info">            <p>下述调整以财务组织=AJJT0101 为例。</p>          </div><h3 id="科目表调整"><a class="markdownIt-Anchor" href="#科目表调整"></a> 科目表调整</h3><p>【会计科目-全局】节点下，修改全局科目表，根据实际管控需要将“科目控制级次”修改为“不控制”或其他具体的级次。<font color="#dd0000">若暂时需要控制财务组织不允许增加科目，则无需修改。</font><br />【会计科目-集团】节点下，修改集团科目表，根据实际管控需要将“科目控制级次”修改为“不控制”或其他具体的级次。<br />【会计科目-财务组织】节点下，选择财务组织、科目体系，点击[科目表维护]，增加科目表。</p><h3 id="财务核算账簿调整"><a class="markdownIt-Anchor" href="#财务核算账簿调整"></a> 财务核算账簿调整</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 查询集团科目表主键  1001A510000000000EQO</span><br><span class="hljs-keyword">select</span> pk_accchart,<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJ&#x27;</span>;<br><span class="hljs-comment">-- 查询AJJT0101新建立的组织级科目表主键  1001B310000000007HEW</span><br><span class="hljs-keyword">select</span> pk_accchart,<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>;<br><span class="hljs-comment">-- 查询AJJT0101当前对应财务核算账簿的科目表  1001A510000000000EQO</span><br><span class="hljs-keyword">select</span> pk_curraccchart,pk_accountingbook <span class="hljs-keyword">from</span> org_accountingbook <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101-0001&#x27;</span>;<br><span class="hljs-comment">/*逐个更新财务帐簿的科目表（由集团级改为组织级）*/</span><br><span class="hljs-keyword">update</span> org_accountingbook <span class="hljs-keyword">set</span> pk_curraccchart<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_accchart <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>) <span class="hljs-keyword">where</span>   pk_relorg<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>);<br></code></pre></td></tr></table></figure><h3 id="会计科目相关基础表整理"><a class="markdownIt-Anchor" href="#会计科目相关基础表整理"></a> 会计科目相关基础表整理</h3><p>因会计科目未使用多版本，可以在2022-12-31前完成调整，这样 bd_account 、 bd_accasoa 可不用调整。若先创建新版本再调整，会涉及 bd_account 、 bd_accasoa 及 bd_accasoahistory 、 bd_accasshistory 等历史表的调整。<br /><strong>关于 bd_account 和 bd_accasoa 的一些补充：</strong><br />bd_accasoa 不具备科目的继承性，即每一个科目表下都会生成具体的全量的科目明细，生成新的 pk_accasoa 。但 bd_accasoa 却继承了集团管控科目的 pk_account ，同一会计科目，集团和组织级的 pk_account 值一样;<br />bd_account 具备科目的继承性，集团管控下的会计科目在组织级不再新增，组织级仅记录新增的会计科目（pk_account)。</p><h3 id="凭证相关数据表整理"><a class="markdownIt-Anchor" href="#凭证相关数据表整理"></a> 凭证相关数据表整理</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*创建视图case_accasoaVo体现集团科目体系和财务组织（AJJT0101）的pk_accasoa对应关系。*/</span><br><span class="hljs-keyword">select</span> a.pk_accasoa <span class="hljs-keyword">as</span> old_accasoa,b.pk_accasoa <span class="hljs-keyword">as</span> new_accasoa  <span class="hljs-keyword">from</span> bd_accasoa a <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> bd_accasoa b <span class="hljs-keyword">on</span> a.pk_account<span class="hljs-operator">=</span>b.pk_account<br><span class="hljs-keyword">where</span>  a.pk_accchart <span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_accchart <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJ&#x27;</span>) <span class="hljs-comment">-- 固定集团</span><br><span class="hljs-keyword">and</span> b.pk_accchart<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_accchart <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>) <span class="hljs-comment">-- 此次调整的财务组织</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*修改凭证明细表中科目表主键。*/</span><br><span class="hljs-keyword">update</span> gl_detail <span class="hljs-keyword">set</span> pk_accchart<span class="hljs-operator">=</span>( <span class="hljs-keyword">select</span> pk_accchart <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>)  <span class="hljs-keyword">where</span> pk_org<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span> )<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*修改凭证明细表中会计科目主键。*/</span><br><span class="hljs-keyword">update</span>  gl_detail <span class="hljs-keyword">set</span>  pk_accasoa<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> new_accasoa <span class="hljs-keyword">from</span> case_accasoaVo <span class="hljs-keyword">where</span> old_accasoa<span class="hljs-operator">=</span>pk_accasoa) <span class="hljs-keyword">where</span> pk_org<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span> );<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*修改凭证余额表中会计科目主键。*/</span><br><span class="hljs-keyword">update</span>  gl_balance <span class="hljs-keyword">set</span>  pk_accasoa<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> new_accasoa <span class="hljs-keyword">from</span> case_accasoaVo <span class="hljs-keyword">where</span> old_accasoa<span class="hljs-operator">=</span>pk_accasoa) <span class="hljs-keyword">where</span> pk_org<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span> );<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*修改凭证明细表中对方科目主键。该步操作通过游标遍历所有科目，较为耗时。存储过程代码见下方附件。*/</span><br><span class="hljs-keyword">exec</span> gldetail_oppositesubj_update <span class="hljs-variable">@p</span>_org_code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="重建期初凭证-重建余额表"><a class="markdownIt-Anchor" href="#重建期初凭证-重建余额表"></a> 重建期初凭证、重建余额表</h3><p>【动态建模平台】-【财务会计】-【总账】-【期初余额】节点重建期初凭证；<br />【动态建模平台】-【财务会计】-【总账】-【结账】节点重建余额表。<br />清缓存，重新登录后再验证数据。</p><h3 id="会计平台梳理如有"><a class="markdownIt-Anchor" href="#会计平台梳理如有"></a> 会计平台梳理（如有）</h3><p>因pk_accasoa发生了变化，若使用了会计平台，业务单元级相关科目映射建议重新指定一遍。</p><h3 id="附存储过程"><a class="markdownIt-Anchor" href="#附存储过程"></a> 附：存储过程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*</span><br><span class="hljs-comment">创建存储过程 gldetail_oppositesubj_update ，更新凭证明细表中的对方科目</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">SET</span> ANSI_NULLS <span class="hljs-keyword">ON</span><br>GO<br><span class="hljs-keyword">SET</span> QUOTED_IDENTIFIER <span class="hljs-keyword">ON</span><br>GO<br><span class="hljs-comment">-- =============================================</span><br><span class="hljs-comment">-- Author:chendi</span><br><span class="hljs-comment">-- Create date: 2022-11-04</span><br><span class="hljs-comment">-- Description:XX集团凭证明细表对方科目更新</span><br><span class="hljs-comment">-- =============================================</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> [dbo].[gldetail_oppositesubj_update ]<br>(<br><span class="hljs-variable">@p</span>_org_code <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>)<br>)<br><span class="hljs-keyword">AS</span><br><span class="hljs-keyword">BEGIN</span><br><span class="hljs-keyword">SET</span> NOCOUNT <span class="hljs-keyword">ON</span>;<br>if <span class="hljs-keyword">exists</span> (<span class="hljs-keyword">select</span> old_accasoa,new_accasoa <span class="hljs-keyword">from</span> case_accasoaVo)<br><span class="hljs-keyword">begin</span><br><span class="hljs-comment">--声明变量</span><br><span class="hljs-keyword">declare</span> <span class="hljs-variable">@old</span>_accasoa <span class="hljs-type">varchar</span>(max)<br><span class="hljs-keyword">declare</span> <span class="hljs-variable">@new</span>_accasoa <span class="hljs-type">varchar</span>(max)<br><span class="hljs-keyword">declare</span> <span class="hljs-variable">@pk</span>_org <span class="hljs-type">varchar</span>(max)<br><span class="hljs-keyword">set</span> <span class="hljs-variable">@pk</span>_org <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-variable">@p</span>_org_code );<br><span class="hljs-comment">--将SQL语句设置为游标，游标名new_cursor</span><br><span class="hljs-keyword">declare</span> new_cursor <span class="hljs-keyword">cursor</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">select</span> old_accasoa,new_accasoa <span class="hljs-keyword">from</span> case_accasoaVo;<br><span class="hljs-keyword">open</span> new_cursor<br><br><span class="hljs-comment">--获取查询数据赋值给变量</span><br><span class="hljs-keyword">fetch</span> next <span class="hljs-keyword">from</span> new_cursor <span class="hljs-keyword">into</span> <span class="hljs-variable">@old</span>_accasoa,<span class="hljs-variable">@new</span>_accasoa<br><span class="hljs-comment">--若检索到数据继续执行</span><br>while @<span class="hljs-variable">@FETCH</span>_STATUS<span class="hljs-operator">=</span><span class="hljs-number">0</span> <br><span class="hljs-keyword">BEGIN</span><br>print  <span class="hljs-variable">@old</span>_accasoa <span class="hljs-operator">+</span><span class="hljs-string">&#x27;_&#x27;</span><span class="hljs-operator">+</span><span class="hljs-variable">@new</span>_accasoa<span class="hljs-operator">+</span><span class="hljs-string">&#x27;_&#x27;</span><span class="hljs-operator">+</span><span class="hljs-variable">@pk</span>_org <br><span class="hljs-keyword">update</span>  gl_detail <span class="hljs-keyword">set</span>  oppositesubj<span class="hljs-operator">=</span>REPLACE(oppositesubj,<span class="hljs-variable">@old</span>_accasoa,<span class="hljs-variable">@new</span>_accasoa) <span class="hljs-keyword">where</span> pk_org<span class="hljs-operator">=</span><span class="hljs-variable">@pk</span>_org;<br><span class="hljs-comment">--获取下一条数据并赋值给变量</span><br><span class="hljs-keyword">fetch</span> next <span class="hljs-keyword">from</span> new_cursor <span class="hljs-keyword">into</span> <span class="hljs-variable">@old</span>_accasoa,<span class="hljs-variable">@new</span>_accasoa<br><span class="hljs-keyword">END</span><br><span class="hljs-keyword">close</span> new_cursor<br><span class="hljs-keyword">deallocate</span> new_cursor<br><span class="hljs-keyword">END</span><br><span class="hljs-keyword">END</span><br>GO<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>NC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yonyou</tag>
      
      <tag>NC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Excel|多个dbf文件的合并处理</title>
    <link href="/2022/09/14/VBA-%E5%90%88%E5%B9%B6%E5%A4%9A%E4%B8%AAdbf%E6%96%87%E4%BB%B6/"/>
    <url>/2022/09/14/VBA-%E5%90%88%E5%B9%B6%E5%A4%9A%E4%B8%AAdbf%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<p>在以前的文章<a href="https://hncd1024.github.io/2022/08/15/Python%20os%20%E6%89%B9%E9%87%8F%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/">Python|OS、shutil实现批量扫描、复制、压缩文件</a>中介绍过批量从有规则的路径下复制文件的操作。<br />今天碰到的需求和上次类似，也是从有规则的路径中复制文件出来，但复制出来的数据文件（dbf格式）需要进行合并操作。关于Python处理dbf文件我没有研究过，于是我就想到了之前写过的<a href="https://hncd1024.github.io/2019/08/29/VBA-%E5%90%88%E5%B9%B6excel%E6%96%87%E4%BB%B6/">Excel|合并当前目录所有的excel文件</a>。因为dbf文件是可以在excel中进行处理的，所以就猜想是否可以修改.dbf文件的后缀为.xls，之后通过VBA实现批量合并操作~</p><h2 id="处理过程"><a class="markdownIt-Anchor" href="#处理过程"></a> 处理过程</h2><h3 id="dbf文件批量复制并修改后缀名"><a class="markdownIt-Anchor" href="#dbf文件批量复制并修改后缀名"></a> dbf文件批量复制并修改后缀名</h3><p>效果图如下：<br /><img src="https://s3.bmp.ovh/imgs/2022/09/14/b6311b07d6bb7718.png" alt="dbf文件批量复制并修改后缀名" /><br />源码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br><span class="hljs-comment"># 桌面创建文件夹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md</span>(<span class="hljs-params">tp=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\&#x27;</span>+tp):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        os.makedirs(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\&#x27;</span>+tp)<br>    <span class="hljs-keyword">return</span><br><br><span class="hljs-comment"># 读取文件夹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rd</span>(<span class="hljs-params">begindate,enddate</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(begindate),<span class="hljs-built_in">int</span>(enddate)+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)):<br>            <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;\\PAR_COMPANY_CREDIT&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.dbf&#x27;</span>):<br>                shutil.copy(<span class="hljs-string">&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;\\PAR_COMPANY_CREDIT&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.dbf&#x27;</span>,<span class="hljs-string">&#x27;C:\\Users\\admin\\Desktop\\聚源评级信息&#x27;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;&#125;日的评级信息已完成复制&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;无&#123;&#125;日的评级信息&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;无&#123;&#125;日的聚源数据文件夹&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br><br><span class="hljs-comment"># 修改dbf的文件格式为xls</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbf_to_xls</span>():<br>    os.chdir(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\聚源评级信息&#x27;</span>) <br>    os.system(<span class="hljs-string">r&#x27;rename *.dbf *.xls&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># 输入起止日期</span><br>    begindate = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入开始日期（格式：20220801）:&#x27;</span>)<br>    enddate =  <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入结束日期（格式：20220831）:&#x27;</span>)<br>    <span class="hljs-comment"># 检查文件夹</span><br>    md(<span class="hljs-string">&quot;聚源评级信息&quot;</span>)<br>    <span class="hljs-comment"># 遍历文件夹</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;#####开始复制&#123;&#125;-&#123;&#125;的评级信息#####&#x27;</span>.<span class="hljs-built_in">format</span>(begindate,enddate))<br>    rd(begindate,enddate)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####文件复制完成#####&quot;</span>)<br>    dbf_to_xls()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####文件后缀修改完成#####&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####任务执行完成#####&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="vba批量合并xls文件"><a class="markdownIt-Anchor" href="#vba批量合并xls文件"></a> VBA批量合并xls文件</h3><p>效果图如下：<br /><img src="https://s3.bmp.ovh/imgs/2022/09/14/49e89648b2be1e22.png" alt="VBA批量合并xls文件" /><br />源码参考：<a href="https://hncd1024.github.io/2019/08/29/VBA-%E5%90%88%E5%B9%B6excel%E6%96%87%E4%BB%B6/">Excel|合并当前目录所有的excel文件</a></p>]]></content>
    
    
    <categories>
      
      <category>Excel</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VBA</tag>
      
      <tag>Excel</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|PyPDF2实现PDF自动拆分</title>
    <link href="/2022/09/05/Python%20PyPDF2%E5%AE%9E%E7%8E%B0PDF%E8%87%AA%E5%8A%A8%E6%8B%86%E5%88%86/"/>
    <url>/2022/09/05/Python%20PyPDF2%E5%AE%9E%E7%8E%B0PDF%E8%87%AA%E5%8A%A8%E6%8B%86%E5%88%86/</url>
    
    <content type="html"><![CDATA[<h2 id="实现pdf自动拆分"><a class="markdownIt-Anchor" href="#实现pdf自动拆分"></a> 实现PDF自动拆分</h2><p>前段时间帮同事从系统中批量导出几十个流程，导出发现合并生成了一个PDF，需要每2页拆分为一个PDF。Adobe pdfreader虽然可以拆分，但逐一拆分还是比较耗费精力。在线PDF处理工具大多也可以实现PDF的批量拆分，考虑到公司内部文件，还是尽量避免使用在线工具。之后我就用python实现了PDF文件的自动拆分。<br /><img src="https://s3.bmp.ovh/imgs/2022/09/06/8e10d6d5a7414749.png" alt="" /><br />源码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader, PdfWriter<br><span class="hljs-comment"># 获取文件页数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_reader</span>(<span class="hljs-params">pdf_in</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_in,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> in_pdf:<br>        pdf_file = PdfReader(in_pdf)<br>        pages = pdf_file.getNumPages()<br>    <span class="hljs-keyword">return</span> pages<br>         <br><span class="hljs-comment"># 拆分pdf</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_split</span>(<span class="hljs-params">pdf_in,pdf_out,start,end</span>):<br>    <span class="hljs-comment"># 初始化一个pdf</span><br>    output = PdfWriter()<br>    <span class="hljs-comment"># 从指定路径读取目标pdf</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_in, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> in_pdf:<br>        pdf_file = PdfReader(in_pdf)<br>        <span class="hljs-comment"># 从目标pdf中取出指定页</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(start, end):<br>            output.addPage(pdf_file.getPage(i))<br>        <span class="hljs-comment"># 写入新的pdf，输出到指定路径</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_out, <span class="hljs-string">&#x27;ab&#x27;</span>) <span class="hljs-keyword">as</span> out_pdf:<br>            output.write(out_pdf)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    pdf_in = <span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\测试.pdf&#x27;</span><br>    pages = pdf_reader(pdf_in)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,pages):<br>        pdf_out = <span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\第&#123;&#125;个.pdf&#x27;</span>.<span class="hljs-built_in">format</span>(i)<br>        pdf_split(pdf_in, pdf_out, i-<span class="hljs-number">1</span> ,i)<br></code></pre></td></tr></table></figure><h2 id="pypdf2库基本用法整理"><a class="markdownIt-Anchor" href="#pypdf2库基本用法整理"></a> PyPDF2库基本用法整理</h2><h3 id="pypdf2历史"><a class="markdownIt-Anchor" href="#pypdf2历史"></a> PyPDF2历史</h3><p>PyPDF2是一个免费的开源纯 python PDF 库，能够分割、合并、裁剪和转换 PDF 文件的页面。它还可以向 PDF 文件添加自定义数据、查看选项和密码。PyPDF2也可以从 PDF 中检索文本和元数据。PyPDF2 近期也没有再更新了，最近一个版本发布在2016年，但使用热度依然没有消退。</p><h3 id="pdf文件信息处理"><a class="markdownIt-Anchor" href="#pdf文件信息处理"></a> PDF文件信息处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 读取pdf文件信息</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_info</span>(<span class="hljs-params">pdf_in</span>):<br>    reader = PdfReader(pdf_in)<br>    pdfinfo = reader.metadata<br>    <span class="hljs-keyword">return</span> reader.numPages , <span class="hljs-built_in">len</span>(reader.pages) , pdfinfo.author , pdfinfo.creator , pdfinfo.producer , pdfinfo.subject , pdfinfo.title<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span> : <br>    pdf_in = <span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/测试.pdf&#x27;</span><br>    pdfinfo = pdf_info(pdf_in)<br>    <span class="hljs-built_in">print</span>(pdfinfo)<br><span class="hljs-comment"># 执行结果： (7, 7, &#x27;chen di1&#x27;, &#x27;Microsoft® Word 适用于 Microsoft 365&#x27;, &#x27;Microsoft® Word 适用于 Microsoft 365&#x27;, None, None)</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 插入文件信息</span><br><span class="hljs-comment"># write metadata</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader,PdfWriter<br>reader = PdfReader(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\javascript原理.pdf&#x27;</span>)<br>writer = PdfWriter()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> reader.pages:<br>    writer.add_page(i)<br>writer.add_metadata(<br>    &#123;<br>        <span class="hljs-string">&#x27;/Author&#x27;</span>:<span class="hljs-string">&#x27;TestAuthor&#x27;</span>,<br>        <span class="hljs-string">&#x27;/Title&#x27;</span>:<span class="hljs-string">&#x27;TestTitle&#x27;</span>,<br>    &#125;<br>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test2.pdf&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> wf :<br>    writer.write(wf)<br></code></pre></td></tr></table></figure><h3 id="pdf合并"><a class="markdownIt-Anchor" href="#pdf合并"></a> PDF合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 简单合并pdf</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfMerger<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_combine</span>(<span class="hljs-params">pdf_in1,pdf_in2,pdf_out</span>):<br>    outpdf = PdfMerger()<br>    <span class="hljs-keyword">for</span> pdf <span class="hljs-keyword">in</span> [pdf_in1,pdf_in2]:<br>        outpdf.append(pdf)<br>    outpdf.write(pdf_out)<br>    outpdf.close()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    pdf_in1 = <span class="hljs-string">&#x27;C:/Users/admin/Desktop/case/第1个.pdf&#x27;</span><br>    pdf_in2 = <span class="hljs-string">&#x27;C:/Users/admin/Desktop/case/第2个.pdf&#x27;</span><br>    pdf_out = <span class="hljs-string">&#x27;C:/Users/admin/Desktop/case/合并后.pdf&#x27;</span><br>    pages = pdf_combine(pdf_in1,pdf_in2,pdf_out)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 多pdf灵活合并</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfMerger<br>merger = PdfMerger()<br>input1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/测试.pdf&#x27;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br>input2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/第6个.pdf&#x27;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br>input3 = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/第4个.pdf&#x27;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br><span class="hljs-comment"># 取input1文件的前三页</span><br>merger.append(fileobj=input1, pages=(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>))<br><span class="hljs-comment"># 在第二页后插入input2的第一页</span><br>merger.merge(position=<span class="hljs-number">2</span>, fileobj=input2, pages=(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))<br><span class="hljs-comment"># 在最后一页插入input3所有页</span><br>merger.append(input3)<br><span class="hljs-comment"># 写入新的pdf文件</span><br>output = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/合并测试.pdf&#x27;</span>, <span class="hljs-string">&quot;wb&quot;</span>)<br>merger.write(output)<br>merger.close()<br>output.close()<br></code></pre></td></tr></table></figure><h3 id="pdf裁剪与转换"><a class="markdownIt-Anchor" href="#pdf裁剪与转换"></a> PDF裁剪与转换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># PDF裁剪与转换</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfWriter, PdfReader<br>reader = PdfReader(<span class="hljs-string">&quot;example.pdf&quot;</span>)<br>writer = PdfWriter()<br><span class="hljs-comment"># 添加第一页到pdf:</span><br>writer.add_page(reader.pages[<span class="hljs-number">0</span>])<br><span class="hljs-comment"># 添加第二页并顺时针旋转90度到pdf:</span><br>writer.add_page(reader.pages[<span class="hljs-number">1</span>].rotate(<span class="hljs-number">90</span>))<br><span class="hljs-comment"># 添加第三页并截取1/4到pdf:</span><br>page3 = reader.pages[<span class="hljs-number">2</span>]<br>page3.mediabox.upper_right = (<br>    page3.mediabox.right / <span class="hljs-number">2</span>,<br>    page3.mediabox.top / <span class="hljs-number">2</span>,<br>)<br>writer.add_page(page3)<br><span class="hljs-comment"># 添加一些JavaScript以在打开此PDF时启动“打印窗口”。:</span><br>writer.add_js(<span class="hljs-string">&quot;this.print(&#123;bUI:true,bSilent:false,bShrinkToFit:true&#125;);&quot;</span>)<br><span class="hljs-comment"># 输出pdf</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;PyPDF2-output.pdf&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    writer.write(fp)<br></code></pre></td></tr></table></figure><h3 id="提取pdf中的文字"><a class="markdownIt-Anchor" href="#提取pdf中的文字"></a> 提取PDF中的文字</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader<br>reader = PdfReader(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test2.pdf&#x27;</span>)<br>page = reader.pages[<span class="hljs-number">0</span>]<br>content0 = page.extract_text()<br><span class="hljs-comment"># print(page.extract_text((0, 90))) # 页面左转90度提取</span><br><span class="hljs-built_in">print</span>(content0)<br></code></pre></td></tr></table></figure><h3 id="pdf加解密"><a class="markdownIt-Anchor" href="#pdf加解密"></a> PDF加解密</h3><p>如果计划使用 PyPDF2对使用 AES 的 PDF 进行加密或解密，则需要安装一些额外的依赖项。使用常规安装支持使用 RC4进行加密。</p><blockquote><p>pip install PyPDF2[crypto]</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader,PdfWriter<br>reader = PdfReader(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test2.pdf&#x27;</span>)<br>writer = PdfWriter()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> reader.pages:<br>    writer.add_page(i)<br><span class="hljs-comment"># 文件加密</span><br>writer.encrypt(<span class="hljs-string">&#x27;qwer1234&#x27;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test3.pdf&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f :<br>    writer.write(f)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader,PdfWriter<br>reader = PdfReader(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test3.pdf&#x27;</span>)<br>writer = PdfWriter()<br><span class="hljs-comment"># 文件解密</span><br><span class="hljs-keyword">if</span> reader.is_encrypted:<br>    reader.decrypt(<span class="hljs-string">&#x27;qwer1234&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> reader.pages:<br>    writer.add_page(i)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test4.pdf&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f :<br>    writer.write(f)<br></code></pre></td></tr></table></figure><h3 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h3><p>类似地，pypdf2还有翻页、缩放、添加水印、阅读/添加注释、表格处理等。具体可参照 <a href="https://pypdf2.readthedocs.io/en/latest/user/installation.html#anaconda">PyPDF2官方文档</a></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>PyPDF2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>PyPDF2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|PyAutoGUI根据文件清单自动下载文件</title>
    <link href="/2022/09/03/Python%20PyAutoGUI%E6%A0%B9%E6%8D%AE%E6%96%87%E4%BB%B6%E6%B8%85%E5%8D%95%E8%87%AA%E5%8A%A8%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/"/>
    <url>/2022/09/03/Python%20PyAutoGUI%E6%A0%B9%E6%8D%AE%E6%96%87%E4%BB%B6%E6%B8%85%E5%8D%95%E8%87%AA%E5%8A%A8%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="背景"><a class="markdownIt-Anchor" href="#背景"></a> 背景</h2><p>周五下班前公司合规部的同事找到我，说需要把公司制度管理系统中的所有制度下载下来，大概有三百多篇现行有效制度、五十多篇废止制度，离谱的是制度系统竟然没有批量下载的功能（供应商回复可以实现批量下载功能，但没这么快~ ），因为有点着急，就想到通过python脚本完成自动下载。这里参考了<a href="https://hncd1024.github.io/2022/08/14/Python%20PyAutoGUI/">Python|PyAutoGUI实现自动点赞收藏</a>里介绍的pyautogui库。<br />简单分析了下，文件下载的url是固定的url格式，且通过get的方法传的id参。我就后台数据库查到了要下载的制度的id列表，然后导出txt用于遍历。下载的脚本很简单，写完我就去出去吃饭了，吃个饭的功夫就全部下载完成了😁😁😁<br />源码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyautogui<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_download</span>(<span class="hljs-params">url</span>):<br>    pyautogui.click(<span class="hljs-number">500</span>,<span class="hljs-number">97</span>,duration=<span class="hljs-number">1.5</span>) <span class="hljs-comment"># 页面地址： Point(x=776, y=97)</span><br>    pyautogui.typewrite(url,<span class="hljs-number">0.01</span>)<br>    pyautogui.press(<span class="hljs-string">&#x27;Enter&#x27;</span>)<br>    time.sleep(<span class="hljs-number">1.5</span>) <span class="hljs-comment"># 确保页面完全加载完成</span><br>    pyautogui.click(<span class="hljs-number">2014</span>,<span class="hljs-number">236</span>,duration=<span class="hljs-number">2</span>) <span class="hljs-comment"># 下载正文： Point(x=2014, y=236)</span><br>    time.sleep(<span class="hljs-number">1.5</span>) <span class="hljs-comment"># 确保页面完全加载完成</span><br>    pyautogui.click(<span class="hljs-number">393</span>,<span class="hljs-number">250</span>,duration=<span class="hljs-number">2</span>) <span class="hljs-comment"># 打开附件： Point(x=393, y=250)</span><br>    pyautogui.click(<span class="hljs-number">116</span>,<span class="hljs-number">464</span>,duration=<span class="hljs-number">1.5</span>) <span class="hljs-comment"># 全选附件： Point(x=116, y=464)</span><br>    pyautogui.click(<span class="hljs-number">2371</span>,<span class="hljs-number">387</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># 下载附件： Point(x=2371, y=387)</span><br>    time.sleep(<span class="hljs-number">1.5</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># print(pyautogui.position())</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;***********请10秒内切换到浏览器中***********&#x27;</span>)<br>    time.sleep(<span class="hljs-number">10</span>)<br>    id_list = <span class="hljs-string">r&#x27;C:\Users\admin\Desktop\制度20220903\现行有效.txt&#x27;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(id_list , encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        count = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.readlines():<br>            url = (<span class="hljs-string">&#x27;http://xxxx/spa/document/index.jsp?id=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>            auto_download(url)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;***********已完成&#123;&#125;篇制度下载***********&#x27;</span>.<span class="hljs-built_in">format</span>(count))<br>            count += <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>这种通过GUI下载文件的方式只能用作应急方案，毕竟要专门腾出来电脑给它使用。如果时间不急的话，也完全可以通过系统标准接口实现文件下载。（当然最稳妥的方案是让供应商做成批量下载的标准功能）<br /><font color="#dd0000">事后反应过来，无中生有的工作我为啥揽过来了？大冤种本种就是我~😂😂😂</font></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>GUI自动化</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>自动化</tag>
      
      <tag>PyAutoGui</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|selenium实现自动点赞收藏(进阶版)</title>
    <link href="/2022/08/26/Python%20selenium/"/>
    <url>/2022/08/26/Python%20selenium/</url>
    
    <content type="html"><![CDATA[<p>在上一篇文章《<a href="https://hncd1024.github.io/2022/08/14/Python%20PyAutoGUI/">Python|PyAutoGUI实现自动点赞收藏</a>》中写过利用 PyAutoGUI 实现网页自动化点赞+收藏的功能，实测发现依靠屏幕坐标系完成鼠标操作的弊端（因为布局原因导致图标位置变化时，不能很好的处理），IT人当然不能接受这种瑕疵😂😂😂<br />今天用另一个 python 库实现全天候、全地域的精准点击😁😁😁</p><h2 id="思路"><a class="markdownIt-Anchor" href="#思路"></a> 思路</h2><p>和上一篇文章一样，也是基于网页实现循环打开未读文章，之后进行点赞+收藏操作。不同的是今天使用的 selenium 库在元素定位时是基于网页html的格式，可以通过元素 id 、 name 、 class 、 css 甚至 xpath 实现精准定位。在网页的处理上比 PyAutoGUI 有更高的稳定性。</p><h2 id="测试效果"><a class="markdownIt-Anchor" href="#测试效果"></a> 测试效果</h2><p><img src="https://s2.loli.net/2022/08/26/v8QpfH51kbxazW7.png" alt="测试效果" /></p><h3 id="源码如下"><a class="markdownIt-Anchor" href="#源码如下"></a> 源码如下</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver = webdriver.Edge(<span class="hljs-string">&#x27;C:\Program Files (x86)\Microsoft\Edge\Application\msedgedriver.exe&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-comment">#打开网页版APP，完成登录</span><br>    driver.get(<span class="hljs-string">&#x27;https://XXXX/&#x27;</span>)<br>    driver.maximize_window() <span class="hljs-comment">#窗口最大化</span><br>    time.sleep(<span class="hljs-number">25</span>) <span class="hljs-comment">#登录系统</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;----------登录成功----------&#x27;</span>)<br>    <span class="hljs-keyword">if</span> driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//img[@alt=&quot;资讯&quot;]&#x27;</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;----------打开资讯----------&#x27;</span>)<br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//img[@alt=&quot;资讯&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;----------打开推荐----------&#x27;</span>)<br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[text()=&quot;推荐&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_click</span>(<span class="hljs-params">num</span>):<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i&lt;num:<br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;热度优先&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">0.5</span>)<br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;时间优先&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">0.5</span>)<br>        <span class="hljs-comment"># 打开第一篇文章</span><br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div [@class=&quot;home-main-partyNews&quot; and  @style=&quot;margin-top: 0px;&quot;]//div [@class=&quot;dynamic-left-title&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># 切换标签</span><br>        window = driver.current_window_handle <span class="hljs-comment">#获取当前句柄</span><br>        all_handles = driver.window_handles<br>        driver.switch_to.window(all_handles[-<span class="hljs-number">1</span>])<br>        <span class="hljs-comment"># 收藏</span><br>        <span class="hljs-keyword">try</span> :<br>            driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;icon&quot;]/span[@class=&quot;pointer&quot;]/i[@class=&quot;iconfont icon-shoucanghuise&quot;]&#x27;</span>).click()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;第&#123;&#125;篇文章收藏成功&#x27;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">except</span> :<br>            <span class="hljs-keyword">try</span>:<br>                driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@style=&quot;display: block;&quot;]/span[@class=&quot;header-icon&quot;]/i[@class=&quot;iconfont icon-weishoucang&quot;]&#x27;</span>).click()<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;第&#123;&#125;篇文章收藏成功&#x27;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">except</span> :<br>                <span class="hljs-built_in">print</span>(driver.current_url) <span class="hljs-comment"># 输出不能执行的页面url</span><br>                <span class="hljs-comment"># print(driver.page_source) # 输出不能执行的页面源码</span><br>                <span class="hljs-keyword">pass</span><br><br>        time.sleep(<span class="hljs-number">0.2</span>)<br>        <span class="hljs-comment"># 点赞</span><br>        <span class="hljs-keyword">try</span> :<br>            driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;icon&quot;]/span[@class=&quot;pointer&quot;]/i[@class=&quot;iconfont icon-dianzanhuise&quot;]&#x27;</span>).click()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;第&#123;&#125;篇文章点赞成功&#x27;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">except</span> :<br>            <span class="hljs-keyword">try</span>:<br>                driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@style=&quot;display: block;&quot;]/span[@class=&quot;header-icon&quot;]/i[@class=&quot;iconfont icon-dianzanhuise&quot;]&#x27;</span>).click()<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;第&#123;&#125;篇文章点赞成功&#x27;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">except</span> :<br>                <span class="hljs-built_in">print</span>(driver.current_url) <span class="hljs-comment"># 输出不能执行的页面url</span><br>                <span class="hljs-comment"># print(driver.page_source) # 输出不能执行的页面源码</span><br>                <span class="hljs-keyword">pass</span><br>        time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># 关闭当前标签</span><br>        driver.close()<br>        driver.switch_to.window(window)<br>        time.sleep(<span class="hljs-number">0.5</span>)<br>        i +=<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;----------执行完毕----------&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    login()<br>    auto_click(<span class="hljs-number">10</span>)<br>    <br></code></pre></td></tr></table></figure><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>selenium 同样是一款 Web 自动化测试工具，但基本都被用来爬虫了。果真 python 的一切自动化测试工具的归宿都是爬虫😂😂😂<br />selenium 还是很强大的，在 web 页面解析、浏览器控制、鼠键处理上都是很灵活的，可以处理一些相对复杂的场景。并且selenium 支持 IE 、 chrome 、 edge 等常用浏览器，使用时需要借助 webdriver 插件完成。（ webdriver 插件最好和本地计算机对应浏览器的版本保持一致）</p><div class="note note-warning">            <p>需要提示的是，selenium的4.*版本语法做了更新，和3.*差异较大，使用时需留意官方文档。</p>          </div><p><img src="https://s2.loli.net/2022/08/26/eh2XlkuZPBOr1YK.png" alt="pip show selenium" /></p><h2 id="附selenium库基本用法整理"><a class="markdownIt-Anchor" href="#附selenium库基本用法整理"></a> 附：selenium库基本用法整理</h2><h3 id="模块导入"><a class="markdownIt-Anchor" href="#模块导入"></a> 模块导入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys<br><span class="hljs-keyword">import</span> time<br></code></pre></td></tr></table></figure><h3 id="调用webdriver"><a class="markdownIt-Anchor" href="#调用webdriver"></a> 调用webdriver</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver = webdriver.Edge(<span class="hljs-string">&quot;C:\Program Files (x86)\Microsoft\Edge\Application\msedgedriver.exe&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="使用get方法加载url界面"><a class="markdownIt-Anchor" href="#使用get方法加载url界面"></a> 使用get方法加载url界面</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.get(<span class="hljs-string">r&#x27;https://www.baidu.com&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="断言是否存在"><a class="markdownIt-Anchor" href="#断言是否存在"></a> 断言是否存在</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">assert</span> <span class="hljs-string">&#x27;百度一下，你就知道&#x27;</span> <span class="hljs-keyword">in</span> driver.title<br></code></pre></td></tr></table></figure><h3 id="通过-find-_-element-方法查找元素"><a class="markdownIt-Anchor" href="#通过-find-_-element-方法查找元素"></a> 通过 find _ element 方法查找元素</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># &lt;input type=&quot;text&quot; name=&quot;passwd&quot; id=&quot;passwd-id&quot; class=&quot;text-a&quot;/&gt;</span><br><span class="hljs-comment"># 支持的By类属性有：</span><br><span class="hljs-comment"># ID = &quot;id&quot;</span><br><span class="hljs-comment"># NAME = &quot;name&quot;</span><br><span class="hljs-comment"># XPATH = &quot;xpath&quot;</span><br><span class="hljs-comment"># LINK_TEXT = &quot;link text&quot;</span><br><span class="hljs-comment"># PARTIAL_LINK_TEXT = &quot;partial link text&quot;</span><br><span class="hljs-comment"># TAG_NAME = &quot;tag name&quot;</span><br><span class="hljs-comment"># CLASS_NAME = &quot;class name&quot;</span><br><span class="hljs-comment"># CSS_SELECTOR = &quot;css selector&quot;</span><br>element = driver.find_element(By.ID, <span class="hljs-string">&quot;passwd-id&quot;</span>)<br>element = driver.find_element(By.NAME, <span class="hljs-string">&quot;passwd&quot;</span>)<br>element = driver.find_element(By.CLASS_NAME, <span class="hljs-string">&quot;text-a&quot;</span>)<br>element = driver.find_element(By.XPATH, <span class="hljs-string">&quot;//input[@id=&#x27;passwd-id&#x27;]&quot;</span>)<br>element = driver.find_element(By.CSS_SELECTOR, <span class="hljs-string">&quot;input#passwd-id&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="键盘输入"><a class="markdownIt-Anchor" href="#键盘输入"></a> 键盘输入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">element.clear() <span class="hljs-comment"># 清除预加载信息</span><br>element.send_keys(<span class="hljs-string">&quot;pycon&quot;</span>) <span class="hljs-comment"># 输入信息</span><br>element.send_keys(Keys.RETURN) <span class="hljs-comment"># 执行查询</span><br></code></pre></td></tr></table></figure><h3 id="处理下拉选项"><a class="markdownIt-Anchor" href="#处理下拉选项"></a> 处理下拉选项</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># 调用webdriver</span><br>driver = webdriver.Edge(<span class="hljs-string">&quot;C:\Program Files (x86)\Microsoft\Edge\Application\msedgedriver.exe&quot;</span>)<br><span class="hljs-comment"># 使用get方法加载url界面</span><br>driver.get(<span class="hljs-string">r&#x27;https://www.sojson.com/time/jsq.html&#x27;</span>)<br>element = driver.find_element(By.ID, <span class="hljs-string">&quot;month3&quot;</span>)<br>all_options = element.find_elements(By.TAG_NAME, <span class="hljs-string">&quot;option&quot;</span>)<br><span class="hljs-keyword">for</span> option <span class="hljs-keyword">in</span> all_options:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Value is: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(option.get_attribute(<span class="hljs-string">&quot;value&quot;</span>))) <span class="hljs-comment"># 获取下拉选项</span><br>    <span class="hljs-keyword">if</span> option.get_attribute(<span class="hljs-string">&quot;value&quot;</span>)==<span class="hljs-number">10</span> : <span class="hljs-comment"># 获取选项：10</span><br>        option.click()<br>time.sleep(<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><h3 id="处理选择"><a class="markdownIt-Anchor" href="#处理选择"></a> 处理选择</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.support.ui <span class="hljs-keyword">import</span> Select<br>select = Select(driver.find_element(By.NAME, <span class="hljs-string">&#x27;name&#x27;</span>))<br>select.select_by_index(index)<br>select.select_by_visible_text(<span class="hljs-string">&quot;text&quot;</span>)<br>select.select_by_value(value)<br><span class="hljs-comment"># 选择/取消选择所有</span><br>select = Select(driver.find_element(By.ID, <span class="hljs-string">&#x27;id&#x27;</span>))<br>select.deselect_all()<br></code></pre></td></tr></table></figure><h3 id="处理拖放"><a class="markdownIt-Anchor" href="#处理拖放"></a> 处理拖放</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 处理拖放，将一个元素拖拽到另一个元素上</span><br>element = driver.find_element(By.NAME, <span class="hljs-string">&quot;source&quot;</span>)<br>target = driver.find_element(By.NAME, <span class="hljs-string">&quot;target&quot;</span>)<br><br><span class="hljs-keyword">from</span> selenium.webdriver <span class="hljs-keyword">import</span> ActionChains<br>action_chains = ActionChains(driver)<br>action_chains.drag_and_drop(element, target).perform()<br></code></pre></td></tr></table></figure><h3 id="实现窗口间的切换"><a class="markdownIt-Anchor" href="#实现窗口间的切换"></a> 实现窗口间的切换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.switch_to_window(<span class="hljs-string">&quot;windowName&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="触发弹窗后可以通过这种方式获取警报"><a class="markdownIt-Anchor" href="#触发弹窗后可以通过这种方式获取警报"></a> 触发弹窗后可以通过这种方式获取警报</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">alert = driver.switch_to.alert<br></code></pre></td></tr></table></figure><h3 id="处理浏览器当前网页的前进后退"><a class="markdownIt-Anchor" href="#处理浏览器当前网页的前进后退"></a> 处理浏览器（当前网页）的前进/后退</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.forward()<br>driver.back()<br></code></pre></td></tr></table></figure><h2 id="参考文档"><a class="markdownIt-Anchor" href="#参考文档"></a> 参考文档</h2><p><a href="https://selenium-python.readthedocs.io/index.html">Selenium with Python</a></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>GUI自动化</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>自动化</tag>
      
      <tag>selenium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Excel|关于Excel的一些奇怪探索</title>
    <link href="/2022/08/24/Excel_%E8%BD%AC%E5%8E%8B%E7%BC%A9%E5%8C%85/"/>
    <url>/2022/08/24/Excel_%E8%BD%AC%E5%8E%8B%E7%BC%A9%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h1 id="写在前面"><a class="markdownIt-Anchor" href="#写在前面"></a> 写在前面</h1><p>2020年参加网络攻防大赛的时候刷过一段时间CTF的题目，在CTF夺旗赛的题目选择上，我比较喜欢杂项，因为杂项的解题思路天马行空（各种骚操作层出不穷，流连忘返~ ）。记得jpg、gif、exe等文件作为题目的时候，有种解题思路是将文件后缀改成.txt或者.zip就能找到隐藏的flag。<br />前段时间有同事问我说excel里有大量的照片，需要保存到本地文件夹中，问有没有快捷的方法。我第一反应就是尝试改后缀名为.zip，后来发现果然可以。于是就有了这篇博文~<br />后来在网上找到了一篇文章，提供了更多的使用技巧。果真宇宙的尽头是0和1~<br />参考文献：<a href="https://zhuanlan.zhihu.com/p/30952873?utm_id=0">不为人知的Excel转压缩包逆天功能</a></p><h1 id="测试过程"><a class="markdownIt-Anchor" href="#测试过程"></a> 测试过程</h1><h2 id="目标excel"><a class="markdownIt-Anchor" href="#目标excel"></a> 目标excel</h2><p>在准备好的excel中，插入了图片、插入了批注、sheet2工作表设置了保护密码、sheet3工作表被隐藏。<br /><img src="https://s2.loli.net/2022/08/24/1OiehHKRyrUdslw.png" alt="sheet1插入了照片及批注" /><br /><img src="https://s2.loli.net/2022/08/24/qWaySHwI5GYX6tT.png" alt="sheet2被保护" /><br /><img src="https://s2.loli.net/2022/08/24/paJHt9y5DENjRuC.png" alt="sheet3被隐藏" /><br />复制excel，将后缀.xlsx改为.zip（或rar等压缩格式）后解压。可以看到有_rels，docProps、xl三个文件夹及一个[content_Types].xml文件。后续操作均在xl文件夹下进行~<br /><img src="https://s2.loli.net/2022/08/24/5HMtIDsm2fLu6kl.png" alt="修改后缀名并解压" /><br /><img src="https://s2.loli.net/2022/08/24/Zg4vR3yxWHcQN2X.png" alt="解压后文件组成" /><br /><img src="https://s2.loli.net/2022/08/24/GTJqFux6iAwYXaU.png" alt="xl目录组成" /></p><h2 id="批量修改sheet表名称"><a class="markdownIt-Anchor" href="#批量修改sheet表名称"></a> 批量修改sheet表名称</h2><p>在xl文件夹下找到workbook.xml，文本编辑器打开。可以看到name属性即为sheet表名称，修改name的值后保存。<br /><img src="https://s2.loli.net/2022/08/24/zJ8MZpmNcbeHSvT.png" alt="修改sheet表名称" /><br />修改后将解压的文件重新压缩为.zip文件，后修改后缀名为.xlsx。之后excel打开发现sheet表修改成功~<br /><img src="https://s2.loli.net/2022/08/24/IMYaVGw1PUNz9Jx.png" alt="修改sheet表名称验证" /></p><h2 id="取消隐藏sheet表"><a class="markdownIt-Anchor" href="#取消隐藏sheet表"></a> 取消隐藏sheet表</h2><p>在xl文件夹下找到workbook.xml，文本编辑器打开。可以看到state=&quot;hidden&quot;属性，对应的sheet表即为隐藏的sheet表。删除state=&quot;hidden&quot;后保存。<br /><img src="https://s2.loli.net/2022/08/24/9wnN6fJRAogqTeU.png" alt="取消隐藏sheet表" /><br />修改后将解压的文件重新压缩为.zip文件，后修改后缀名为.xlsx。之后excel打开发现隐藏的sheet表已取消隐藏~<br /><img src="https://s2.loli.net/2022/08/24/IastC3brgl8V7O5.png" alt="取消隐藏sheet表验证" /></p><h2 id="批量提取照片"><a class="markdownIt-Anchor" href="#批量提取照片"></a> 批量提取照片</h2><p>在xl文件夹下找到media文件夹，原excel中的照片已自动打包下载~<br /><img src="https://s2.loli.net/2022/08/24/UKJjRk3bGFwCETv.png" alt="批量提取照片" /></p><h2 id="解密受保护的sheet表"><a class="markdownIt-Anchor" href="#解密受保护的sheet表"></a> 解密受保护的sheet表</h2><p>在xl/worksheets文件夹下找到隐藏的sheet表（如sheet2.xml)，文本编辑器打开。可以看到&lt;sheetProtection&gt;&lt;/sheetProtection&gt;属性。删除sheetProtection标签后保存。</p><p><img src="https://s2.loli.net/2022/08/24/DCkUNK279ASLOpB.png" alt="解密受保护的sheet表" /><br />修改后将解压的文件重新压缩为.zip文件，后修改后缀名为.xlsx。之后excel打开发现受保护的sheet表已取消保护~<br /><img src="https://s2.loli.net/2022/08/24/ChLIY347cRNzjyr.png" alt="解密受保护的sheet表后验证" /></p><h2 id="批量修改批注"><a class="markdownIt-Anchor" href="#批量修改批注"></a> 批量修改批注</h2><p>在xl文件夹下找到comments1.xml，文本编辑器打开。可以看到&lt;t&gt;标签即为批注内容，修改批注内容后保存。<br /><img src="https://s2.loli.net/2022/08/24/16VWQ4iI2KSqZr9.png" alt="批量修改批注" /><br />修改后将解压的文件重新压缩为.zip文件，后修改后缀名为.xlsx。之后excel打开发现批注修改成功~<br /><img src="https://s2.loli.net/2022/08/24/y6JTDw5PURbx9nZ.png" alt="批量修改批注后验证" /></p>]]></content>
    
    
    <categories>
      
      <category>Excel</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VBA</tag>
      
      <tag>Excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Markdown|基本用法</title>
    <link href="/2022/08/19/markdown%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/"/>
    <url>/2022/08/19/markdown%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="关于markdown"><a class="markdownIt-Anchor" href="#关于markdown"></a> 关于markdown</h1><p>最近接触过的很多编辑器/网站感觉都很清爽，后来知道原来是支持了markdown。关于markdown我在前几年就有听说过，但当时觉得自己用不到，以为只是html的简化版，没想到有一天也会大型真香现场~ 😂😂😂<br />这个博客系统的博客就是通过markdown编写的，日常记笔记也慢慢习惯使用markdown了，好的工具当然事半功倍。<br />在编辑器的选择上，我用过有道笔记、Typora、vscode，个人最终还是倾向使用vscode。（vscode的插件太强大了，一款编辑器搞定日常涉及到的所有计算机语言，牛批爆了~ ）<br /><a href="https://baike.baidu.com/item/markdown/3245829?fr=kg_general">百度百科</a>如下：</p><blockquote><p>Markdown 是一种轻量级标记语言，创始人为约翰·格鲁伯（John Gruber）。 它允许人们使用易读易写的纯文本格式编写文档，然后转换成有效的 XHTML（或者HTML）文档。这种语言吸收了很多在电子邮件中已有的纯文本标记的特性。<br />由于 Markdown 的轻量化、易读易写特性，并且对于图片，图表、数学式都有支持，许多网站都广泛使用 Markdown 来撰写帮助文档或是用于论坛上发表消息。 如 GitHub、Reddit、Diaspora、Stack Exchange、OpenStreetMap 、SourceForge、简书等，甚至还能被使用来撰写电子书。<br />优势：</p><ul><li>世界上最流行的博客平台WordPress和大型CMS如Joomla、Drupal都能很好的支持Markdown。完全采用Markdown编辑器的博客平台有Ghost和Typecho等。</li><li>用于编写说明文档，以“<a href="http://README.md">README.md</a>”的文件名保存在软件的目录下面。</li><li>Markdown可以快速转化为演讲PPT、Word产品文档甚至是用非常少量的代码完成最小可用原型。</li></ul></blockquote><h1 id="markdown语法"><a class="markdownIt-Anchor" href="#markdown语法"></a> markdown语法</h1><p>基于<a href="https://www.runoob.com/markdown/md-tutorial.html">Markdown 教程|菜鸟教程</a>整理。</p><h2 id="标题"><a class="markdownIt-Anchor" href="#标题"></a> 标题</h2><p>使用“# ”标记1-6级标题，标题书写格式为“#”+“空格”：</p><blockquote><p># 一级标题<br />## 二级标题<br />### 三级标题<br />#### 四级标题<br />##### 五级标题<br />###### 六级标题</p></blockquote><h2 id="段落样式"><a class="markdownIt-Anchor" href="#段落样式"></a> 段落样式</h2><h3 id="换行"><a class="markdownIt-Anchor" href="#换行"></a> 换行</h3><ul><li>方式一：段落的换行是使用两个以上空格加上回车；</li><li>方式二：段落后增加:&lt;br&gt;段落符</li></ul><hr /><h3 id="字体"><a class="markdownIt-Anchor" href="#字体"></a> 字体</h3><blockquote><p>*斜体文本*<br />_斜体文本_<br />*<em>粗体文本</em>*<br />_<em>粗体文本</em>_<br />*<strong>粗斜体文本</strong>*<br />_<strong>粗斜体文本</strong>_</p></blockquote><hr /><h3 id="分割线"><a class="markdownIt-Anchor" href="#分割线"></a> 分割线</h3><p>可以在一行中用三个以上的星号、减号、底线来建立一个分隔线，行内不能有其他东西。</p><blockquote><p>***<br />—<br />___</p></blockquote><hr /><h3 id="删除线"><a class="markdownIt-Anchor" href="#删除线"></a> 删除线</h3><p>只需要在文字的两端加上两个波浪线 ~~ 即可</p><blockquote><p>示例：~<sub>要删除的内容~</sub><br />效果：<s>要删除的内容</s></p></blockquote><h3 id="下划线"><a class="markdownIt-Anchor" href="#下划线"></a> 下划线</h3><p>下划线可以通过 HTML 的 &lt;u&gt; 标签来实现</p><blockquote><p>示例：&lt;u&gt;带下划线的文本&lt;/u&gt;<br />效果：<u>带下划线的文本</u></p></blockquote><h3 id="脚注"><a class="markdownIt-Anchor" href="#脚注"></a> 脚注</h3><blockquote><p>创建脚注格式类似这样：社会主义核心价值观 [^1]。<br />[^1]: 富强、民主、文明、和谐，自由、平等、公正、法制，爱国、敬业、诚信、友善</p></blockquote><p>效果：社会主义核心价值观<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="富强民主文明和谐，自由平等公正法制，爱国敬业诚信友善">[1]</span></a></sup></p><h2 id="列表"><a class="markdownIt-Anchor" href="#列表"></a> 列表</h2><p>Markdown 支持有序列表和无序列表。<br />无序列表使用星号(*)、加号(+)或是减号(-)作为列表标记，这些标记后面要添加一个空格，然后再填写内容：</p><blockquote><p>* 第一项<br />+ 第二项<br />- 第三项</p></blockquote><ul><li>第一项</li></ul><ul><li>第二项</li></ul><ul><li>第三项</li></ul><hr /><p>有序列表使用数字并加上 . 号来表示，如：</p><ol><li>序号1</li><li>序号2</li></ol><hr /><p><strong>列表嵌套</strong><br />列表嵌套只需在子列表中的选项前面添加两个或四个空格即可：</p><ol><li>第一项：<ul><li>第一项嵌套的第一个元素</li><li>第一项嵌套的第二个元素</li></ul></li><li>第二项：<ul><li>第二项嵌套的第一个元素</li><li>第二项嵌套的第二个元素</li></ul></li></ol><h2 id="区块-代码"><a class="markdownIt-Anchor" href="#区块-代码"></a> 区块、代码</h2><p><strong>区块</strong>：Markdown 区块引用是在段落开头使用 &gt; 符号 ，然后后面紧跟一个空格符号。<br />另外区块是可以嵌套的，一个 &gt; 符号是最外层，两个 &gt; 符号是第一层嵌套，以此类推。</p><hr /><p><strong>代码</strong>：用 ``` 包裹一段代码，并指定一种语言（也可以不指定）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hello world&#x27;</span>)<br>    time.sleep(<span class="hljs-number">2</span>)<br>    i += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h2 id="链接-图片"><a class="markdownIt-Anchor" href="#链接-图片"></a> 链接、图片</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-selector-attr">[链接名称]</span>(链接地址)<br><br>或者<br><br>&lt;链接地址&gt;<br></code></pre></td></tr></table></figure><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">!<span class="hljs-selector-attr">[alt 属性文本]</span>(图片地址)<br></code></pre></td></tr></table></figure><h2 id="表格"><a class="markdownIt-Anchor" href="#表格"></a> 表格</h2><p>Markdown 制作表格使用 | 来分隔不同的单元格，使用 - 来分隔表头和其他行。</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">|<span class="hljs-string">  表头   </span>|<span class="hljs-string"> 表头  </span>|<br>|<span class="hljs-string">  ----  </span>|<span class="hljs-string"> ----  </span>|<br>|<span class="hljs-string"> 单元格  </span>|<span class="hljs-string"> 单元格 </span>|<br>|<span class="hljs-string"> 单元格  </span>|<span class="hljs-string"> 单元格 </span>|<br></code></pre></td></tr></table></figure><p>效果如下：</p><table><thead><tr><th>表头</th><th>表头</th></tr></thead><tbody><tr><td>单元格</td><td>单元格</td></tr><tr><td>单元格</td><td>单元格</td></tr></tbody></table><p><strong>对齐方式</strong></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">-: 设置内容和标题栏居右对齐。<br>:- 设置内容和标题栏居左对齐。<br><span class="hljs-meta">:-:</span> 设置内容和标题栏居中对齐。<br></code></pre></td></tr></table></figure><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">|<span class="hljs-string"> 左对齐 </span>|<span class="hljs-string"> 右对齐 </span>|<span class="hljs-string"> 居中对齐 </span>|<br>|<span class="hljs-string"> :-----</span>|<span class="hljs-string"> ----: </span>|<span class="hljs-string"> :----: </span>|<br>|<span class="hljs-string"> 单元格 </span>|<span class="hljs-string"> 单元格 </span>|<span class="hljs-string"> 单元格 </span>|<br>|<span class="hljs-string"> 单元格 </span>|<span class="hljs-string"> 单元格 </span>|<span class="hljs-string"> 单元格 </span>|<br></code></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">左对齐</th><th style="text-align:right">右对齐</th><th style="text-align:center">居中对齐</th></tr></thead><tbody><tr><td style="text-align:left">单元格</td><td style="text-align:right">单元格</td><td style="text-align:center">单元格</td></tr><tr><td style="text-align:left">单元格</td><td style="text-align:right">单元格</td><td style="text-align:center">单元格</td></tr></tbody></table><h2 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h2><h3 id="html元素"><a class="markdownIt-Anchor" href="#html元素"></a> HTML元素</h3><p>不在 Markdown 涵盖范围之内的标签，都可以直接在文档里面用 HTML 撰写。<br />目前支持的 HTML 元素有：&lt;kbd&gt; &lt;b&gt; &lt;i&gt; &lt;em&gt; &lt;sup&gt; &lt;sub&gt; &lt;br&gt;等 ，如：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">使用 &lt;<span class="hljs-selector-tag">kbd</span>&gt;Ctrl&lt;/<span class="hljs-selector-tag">kbd</span>&gt;+&lt;<span class="hljs-selector-tag">kbd</span>&gt;Alt&lt;/<span class="hljs-selector-tag">kbd</span>&gt;+&lt;<span class="hljs-selector-tag">kbd</span>&gt;<span class="hljs-selector-tag">Del</span>&lt;/<span class="hljs-selector-tag">kbd</span>&gt; 重启电脑<br></code></pre></td></tr></table></figure><p>使用 <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd> 重启电脑</p><hr /><h3 id="tag便签"><a class="markdownIt-Anchor" href="#tag便签"></a> Tag便签</h3><p>在 markdown 中加入如下的代码来使用便签。标签属性包括：primary、secondary、success、danger、warning、info、light<br />格式如下：</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="hljs-template-tag">&#123;% <span class="hljs-name">note</span> success %&#125;</span><span class="language-xml"></span><br><span class="language-xml">测试便签success</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;% <span class="hljs-name">endnote</span> %&#125;</span><br></code></pre></td></tr></table></figure><div class="note note-success">            <p>测试便签 success</p>          </div><div class="note note-primary">            <p>测试便签 primary</p>          </div><div class="note note-secondary">            <p>测试便签 secondary</p>          </div><div class="note note-danger">            <p>测试便签 danger</p>          </div><div class="note note-warning">            <p>测试便签 warning</p>          </div><div class="note note-info">            <p>测试便签 info</p>          </div><div class="note note-light">            <p>测试便签 light</p>          </div><h3 id="数学公式"><a class="markdownIt-Anchor" href="#数学公式"></a> 数学公式</h3><p>Markdown Preview Enhanced 使用 KaTeX 或者 MathJax 来渲染数学表达式。</p><p>KaTeX 拥有比 MathJax 更快的性能，但是它却少了很多 MathJax 拥有的特性。你可以查看 KaTeX supported functions/symbols 来了解 KaTeX 支持那些符号和函数。</p><p>默认下的分隔符：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-symbol">$</span>...<span class="hljs-symbol">$</span> 或者 \(...\) 中的数学表达式将会在行内显示。<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>...<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span> 或者 \[...\] 或者 ```math 中的数学表达式将会在块内显示。<br></code></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">f(x)=sin(x)+12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>d</mi></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\begin{Bmatrix}   a &amp; b \\   c &amp; d\end{Bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">}</span></span></span></span></span></span></span></p>\begin{CD}   A @>a>> B \\@VbVV @AAcA \\   C @= D\end{CD}<hr /><h3 id="流程图"><a class="markdownIt-Anchor" href="#流程图"></a> 流程图</h3><p>1、横向流程图源码格式：</p><pre><code class=" \mermaid">graph LRA[方形] --&gt;B(圆角)    B --&gt; C&#123;条件a&#125;    C --&gt;|a=1| D[结果1]    C --&gt;|a=2| E[结果2]    F[横向流程图]</code></pre><p>2、竖向流程图源码格式：</p><pre><code class=" \mermaid">graph TDA[方形] --&gt; B(圆角)    B --&gt; C&#123;条件a&#125;    C --&gt; |a=1| D[结果1]    C --&gt; |a=2| E[结果2]    F[竖向流程图]</code></pre><p>3、标准流程图源码格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs \flow">st=&gt;start: 开始框<br>op=&gt;operation: 处理框<br>cond=&gt;condition: 判断框(是或否?)<br>sub1=&gt;subroutine: 子流程<br>io=&gt;inputoutput: 输入输出框<br>e=&gt;end: 结束框<br>st-&gt;op-&gt;cond<br>cond(yes)-&gt;io-&gt;e<br>cond(no)-&gt;sub1(right)-&gt;op<br></code></pre></td></tr></table></figure><p>4、标准流程图源码格式（横向）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs \flow">st=&gt;start: 开始框<br>op=&gt;operation: 处理框<br>cond=&gt;condition: 判断框(是或否?)<br>sub1=&gt;subroutine: 子流程<br>io=&gt;inputoutput: 输入输出框<br>e=&gt;end: 结束框<br>st(right)-&gt;op(right)-&gt;cond<br>cond(yes)-&gt;io(bottom)-&gt;e<br>cond(no)-&gt;sub1(right)-&gt;op<br></code></pre></td></tr></table></figure><p>5、UML时序图源码样例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs \sequence">对象A-&gt;对象B: 对象B你好吗?（请求）<br>Note right of 对象B: 对象B的描述<br>Note left of 对象A: 对象A的描述(提示)<br>对象B--&gt;对象A: 我很好(响应)<br>对象A-&gt;对象B: 你真的好吗？<br></code></pre></td></tr></table></figure><p>6、UML时序图源码复杂样例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs \sequence">Title: 标题：复杂使用<br>对象A-&gt;对象B: 对象B你好吗?（请求）<br>Note right of 对象B: 对象B的描述<br>Note left of 对象A: 对象A的描述(提示)<br>对象B--&gt;对象A: 我很好(响应)<br>对象B-&gt;小三: 你好吗<br>小三--&gt;&gt;对象A: 对象B找我了<br>对象A-&gt;对象B: 你真的好吗？<br>Note over 小三,对象B: 我们是朋友<br>participant C<br>Note right of C: 没人陪我玩<br></code></pre></td></tr></table></figure><p>7、UML标准时序图样例：</p><pre><code class=" \mermaid">%% 时序图例子,-&gt; 直线，--&gt;虚线，-&gt;&gt;实线箭头  sequenceDiagram    participant 张三    participant 李四    张三-&gt;王五: 王五你好吗？    loop 健康检查        王五-&gt;王五: 与疾病战斗    end    Note right of 王五: 合理 食物 &lt;br/&gt;看医生...    李四--&gt;&gt;张三: 很好!    王五-&gt;李四: 你怎么样?    李四--&gt;王五: 很好!</code></pre><p>8、甘特图样例：</p><pre><code class=" \mermaid">%% 语法示例        gantt        dateFormat  YYYY-MM-DD        title 软件开发甘特图        section 设计        需求                      :done,    des1, 2014-01-06,2014-01-08        原型                      :active,  des2, 2014-01-09, 3d        UI设计                     :         des3, after des2, 5d    未来任务                     :         des4, after des3, 5d        section 开发        学习准备理解需求                      :crit, done, 2014-01-06,24h        设计框架                             :crit, done, after des2, 2d        开发                                 :crit, active, 3d        未来任务                              :crit, 5d        耍                                   :2d        section 测试        功能测试                              :active, a1, after des3, 3d        压力测试                               :after a1  , 20h        测试报告                               : 48h</code></pre><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>富强民主文明和谐，自由平等公正法制，爱国敬业诚信友善<p><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section></p>]]></content>
    
    
    <categories>
      
      <category>Markdown</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Markdown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|OS、shutil实现批量扫描、复制、压缩文件</title>
    <link href="/2022/08/15/Python%20os%20%E6%89%B9%E9%87%8F%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/"/>
    <url>/2022/08/15/Python%20os%20%E6%89%B9%E9%87%8F%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<p>每天一划水，无事小神仙。<br/><br />今天有个需求：服务器上有个文件夹，里面按日期生成了文件夹。工作日所在的文件夹内有需要我复制下来的文件。要求每个月取一次。<br/><br />每月要翻三十个文件夹，找二十多个文件，让我手工复制是绝不可能的！🙂🙂🙂那必须要搞个脚本自己跑。</p><h2 id="思路"><a class="markdownIt-Anchor" href="#思路"></a> 思路</h2><p>1、服务器磁盘已映射（本地可直接访问）。<br/><br />2、确定要批量扫描的文件夹名称（按日期命名的文件夹）。<br/><br />3、根据要扫描的日期，按文件夹名进行遍历，找到要复制的文件。<br/><br />4、在桌面创建一个文件夹，把找到的文件复制进去。<br/><br />5、将复制出来的文件夹进行压缩。<br/></p><h2 id="过程"><a class="markdownIt-Anchor" href="#过程"></a> 过程</h2><h3 id="效果截图"><a class="markdownIt-Anchor" href="#效果截图"></a> 效果截图</h3><p>要扫描的文件夹，不敢想象让我手工去复制要搞到什么时候~<br /><img src="https://s2.loli.net/2022/08/15/LB2IrOTtkRqbmMN.png" alt="目标文件夹" /><br />代码批量执行还是很快的，输入要执行的区间即可。<br /><img src="https://s2.loli.net/2022/08/15/Uwz6fT5xXNYyAtH.png" alt="执行日志" /><br />执行结果完全符合预期😁😁😁<br /><img src="https://s2.loli.net/2022/08/15/3AG1UhmXs96qiod.png" alt="执行结果" /><br />然后再自动生成压缩文件~</p><h3 id="源码如下"><a class="markdownIt-Anchor" href="#源码如下"></a> 源码如下</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br><span class="hljs-comment"># 桌面创建文件夹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md</span>(<span class="hljs-params">tp=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\&#x27;</span>+tp):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        os.makedirs(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\&#x27;</span>+tp)<br>    <span class="hljs-keyword">return</span><br><br><span class="hljs-comment"># 读取文件夹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rd</span>(<span class="hljs-params">begindate,enddate</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(begindate),<span class="hljs-built_in">int</span>(enddate)+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)):<br>            <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;\\PAR_YIELDCURVE_ALL&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.dbf&#x27;</span>):<br>                shutil.copy(<span class="hljs-string">&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;\\PAR_YIELDCURVE_ALL&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.dbf&#x27;</span>,<span class="hljs-string">&#x27;C:\\Users\\admin\\Desktop\\收益率曲线&#x27;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;&#125;日的收益率曲线已完成复制&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;无&#123;&#125;日的收益率曲线&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;无&#123;&#125;日的聚源数据文件夹&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br><br><span class="hljs-comment"># 生成压缩包</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">zip_dir</span>(<span class="hljs-params">dirname,zipfilename</span>):<br>    shutil.make_archive(zipfilename,<span class="hljs-string">&#x27;zip&#x27;</span>,root_dir=dirname)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># 输入起止日期</span><br>    begindate = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入开始日期（格式：20220801）:&#x27;</span>)<br>    enddate =  <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入结束日期（格式：20220831）:&#x27;</span>)<br>    <span class="hljs-comment"># 检查文件夹</span><br>    md(<span class="hljs-string">&quot;收益率曲线&quot;</span>)<br>    <span class="hljs-comment"># 遍历文件夹</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;#####开始复制&#123;&#125;-&#123;&#125;的收益率曲线#####&#x27;</span>.<span class="hljs-built_in">format</span>(begindate,enddate))<br>    rd(begindate,enddate)<br>    <span class="hljs-comment"># 创建压缩包</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####开始创建压缩包#####&quot;</span>)<br>    dirname=<span class="hljs-string">&#x27;C:\\Users\\admin\\Desktop\\收益率曲线&#x27;</span><br>    zipfilename=<span class="hljs-string">&#x27;C:\\Users\\admin\\Desktop\\收益率曲线&#123;&#125;-&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(begindate,enddate)<br>    zip_dir(dirname, zipfilename)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####任务执行完成#####&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="附os库基本用法整理"><a class="markdownIt-Anchor" href="#附os库基本用法整理"></a> 附：OS库基本用法整理</h2><p>os是“operating system”的缩写，顾名思义，就是与操作系统相关的标准库。如：文件，目录，执行系统命令等。</p><h3 id="工作路径"><a class="markdownIt-Anchor" href="#工作路径"></a> 工作路径</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 工作路径</span><br><span class="hljs-built_in">print</span>(os.getcwd()) <span class="hljs-comment"># 返回当前工作目录</span><br>os.chdir(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\test&quot;</span>) <span class="hljs-comment"># 改变当前</span><br></code></pre></td></tr></table></figure><h3 id="工作目录"><a class="markdownIt-Anchor" href="#工作目录"></a> 工作目录</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 工作目录</span><br><span class="hljs-built_in">print</span>(os.listdir()) <span class="hljs-comment"># 返回当前工作目录下所有文件和文件夹列表</span><br><span class="hljs-built_in">print</span>(os.path.exists(<span class="hljs-string">&#x27;modules&#x27;</span>)) <span class="hljs-comment"># 判断文件夹或文件是否存在</span><br><br><span class="hljs-comment"># os.walk()</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">for</span> i, j, k <span class="hljs-keyword">in</span> os.walk(os.getcwd()):<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;path =&quot;</span>, i) <span class="hljs-comment"># 返回当前路径</span><br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;List of directories =&quot;</span>, j) <span class="hljs-comment"># 返回当前路径下的文件夹</span><br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;List of files =&quot;</span>, k) <span class="hljs-comment"># 返回当前路径下的文件列表</span><br></code></pre></td></tr></table></figure><h3 id="文件夹的增删"><a class="markdownIt-Anchor" href="#文件夹的增删"></a> 文件夹的增删</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 文件夹的增删改</span><br>os.mkdir(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test\testa&#x27;</span>) <span class="hljs-comment"># 创建文件夹,当找不到任何中间目录时，它会引发 FileNotFoundError。</span><br>os.makedirs(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test\testb&#x27;</span>) <span class="hljs-comment"># 创建文件夹,与 mkdir ()不同，它不会引发错误。相反，它创建所有缺少的子目录。</span><br>os.removedirs(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test\testa&#x27;</span>) <span class="hljs-comment"># 删除文件夹，当文件夹不存在时报错。</span><br>os.rmdir(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test\testb&#x27;</span>) <span class="hljs-comment"># 删除现有目录 </span><br>os.remove(<span class="hljs-string">&#x27;test.txt&#x27;</span>) <span class="hljs-comment"># 删除文件</span><br>os.unlink(<span class="hljs-string">&#x27;test2.txt&#x27;</span>) <span class="hljs-comment"># 删除文件</span><br>os.renames(<span class="hljs-string">r&#x27;C:\Users\a&#x27;</span>,<span class="hljs-string">r&#x27;C:\Users\test\b&#x27;</span>) <span class="hljs-comment"># 修改目录</span><br>os.rename(<span class="hljs-string">&quot;modules2&quot;</span>, <span class="hljs-string">&quot;modules3&quot;</span>) <span class="hljs-comment"># 重命名文件夹或文件</span><br></code></pre></td></tr></table></figure><h3 id="运行shell命令"><a class="markdownIt-Anchor" href="#运行shell命令"></a> 运行shell命令</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">os.system(<span class="hljs-string">&#x27;ipconfig&#x27;</span>) <span class="hljs-comment"># 运行shell命令</span><br></code></pre></td></tr></table></figure><h3 id="获取文件大小"><a class="markdownIt-Anchor" href="#获取文件大小"></a> 获取文件大小</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(os.path.getsize(<span class="hljs-string">&#x27;main.py&#x27;</span>)) <span class="hljs-comment"># 获取文件大小，字节</span><br></code></pre></td></tr></table></figure><h3 id="打开到命令的管道或从命令打开管道"><a class="markdownIt-Anchor" href="#打开到命令的管道或从命令打开管道"></a> 打开到命令的管道或从命令打开管道</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 打开到命令的管道或从命令打开管道</span><br>file_name=<span class="hljs-string">r&#x27;python C:\Users\Administrator\Desktop\test\a.py&#x27;</span><br>file = os.popen(file_name,<span class="hljs-string">&#x27;w&#x27;</span>)<br>file.writelines(<span class="hljs-string">&#x27;print(&quot;hello world2!!!&quot;&#x27;</span>)<br>file = os.popen(file_name,<span class="hljs-string">&#x27;r&#x27;</span>) <br><span class="hljs-built_in">print</span>(file.read())<br>file.close() <span class="hljs-comment"># 关闭由 popen ()或 tube ()打开的文件</span><br></code></pre></td></tr></table></figure><h3 id="参考文档"><a class="markdownIt-Anchor" href="#参考文档"></a> 参考文档</h3><p><a href="https://pythongeeks.org/python-os-module/">Python OS Module - Python Geeks</a></p><h2 id="附shutil库基本用法整理"><a class="markdownIt-Anchor" href="#附shutil库基本用法整理"></a> 附：shutil库基本用法整理</h2><p>shutil 是 python 中的高级文件操作模块，与 os 模块形成互补的关系，os 主要提供了文件或文件夹的新建、删除、查看等方法，还提供了对文件以及目录的路径操作。shutil 模块提供了移动、复制、 压缩、解压等操作，恰好与 os 互补，os 和 shutil 一起使用，基本能完成所有文件的操作。是一个非常重要的模块。</p><h3 id="复制"><a class="markdownIt-Anchor" href="#复制"></a> 复制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 复制文件</span><br>shutil.copy(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case.txt&quot;</span>,<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case&quot;</span>)<br><br><span class="hljs-comment"># 将一个文件的内容复制到另一个文件中</span><br>shutil.copyfile(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case.txt&quot;</span>,<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case\case3.txt&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">shutil.copytree() 描述：复制整个目录及文件，不需要的文件类型可以不复制</span><br><span class="hljs-string">语法：shutil.copytree(oripath, despath, ignore= shutil.ignore_patterns(&quot;*.xls&quot;, &quot;*.doc&quot;))</span><br><span class="hljs-string">参数：</span><br><span class="hljs-string">oripath : &quot;来源路径&quot;</span><br><span class="hljs-string">despath : &quot;目标路径&quot;</span><br><span class="hljs-string">ignore : shutil.ignore_patterns() 是对内容进行忽略筛选，将对应的内容进行忽略。</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>path1 = <span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\case&#x27;</span><br>path2 = <span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\case1\copytree&#x27;</span><br>shutil.copytree(path1,path2,ignore=shutil.ignore_patterns(<span class="hljs-string">&#x27;case.txt&#x27;</span>,<span class="hljs-string">&#x27;*.DOC&#x27;</span>)) <span class="hljs-comment"># case.txt和doc文件忽略</span><br></code></pre></td></tr></table></figure><h3 id="移动"><a class="markdownIt-Anchor" href="#移动"></a> 移动</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 移动文件</span><br>shutil.move(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case.txt&quot;</span>,<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="递归删除"><a class="markdownIt-Anchor" href="#递归删除"></a> 递归删除</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 递归删除文件及文件夹</span><br>shutil.rmtree(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\unpack&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="查看磁盘信息"><a class="markdownIt-Anchor" href="#查看磁盘信息"></a> 查看磁盘信息</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 查看磁盘信息</span><br><span class="hljs-built_in">print</span>(shutil.disk_usage(<span class="hljs-string">&#x27;d:&#x27;</span>))<br></code></pre></td></tr></table></figure><h3 id="压缩与解压缩"><a class="markdownIt-Anchor" href="#压缩与解压缩"></a> 压缩与解压缩</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">shutil.make_archive 描述：压缩打包</span><br><span class="hljs-string">语法：make_archive(base_name, format, root_dir=None, base_dir=None, verbose=0,dry_run=0, owner=None, group=None, logger=None)</span><br><span class="hljs-string">压缩打包</span><br><span class="hljs-string">base_name： 压缩包的文件名，也可以是压缩包的路径。只是文件名时，则保存至当前目录，否则保存至指定路径</span><br><span class="hljs-string">format： 压缩或者打包格式 &quot;zip&quot;, &quot;tar&quot;, &quot;bztar&quot;or &quot;gztar&quot;</span><br><span class="hljs-string">root_dir : 将哪个目录或者文件打包（也就是源文件）</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>shutil.make_archive(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\a&quot;</span>,<span class="hljs-string">&#x27;zip&#x27;</span>,root_dir=<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">shutil.unpack_archive 描述： 获取支持的压缩文件格式。目前支持的有：tar、zip、gztar、bztar。在Python3还多支持一种格式xztar</span><br><span class="hljs-string">语法：unpack_archive(filename, extract_dir=None, format=None)</span><br><span class="hljs-string">filename：文件路径</span><br><span class="hljs-string">extract_dir：解压至的文件夹路径。文件夹可以不存在，会自动生成</span><br><span class="hljs-string">format：解压格式，默认为None，会根据扩展名自动选择解压格式</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>shutil.unpack_archive(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\a.zip&quot;</span>,<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\unpack&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="参考文档-2"><a class="markdownIt-Anchor" href="#参考文档-2"></a> 参考文档</h3><p><a href="https://docs.python.org/zh-cn/3/library/shutil.html">shutil — 高阶文件操作 — Python 3.10.7 文档</a></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>OS</category>
      
      <category>shutil</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>自动化</tag>
      
      <tag>OS</tag>
      
      <tag>shutil</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|PyAutoGUI实现自动点赞收藏</title>
    <link href="/2022/08/14/Python%20PyAutoGUI/"/>
    <url>/2022/08/14/Python%20PyAutoGUI/</url>
    
    <content type="html"><![CDATA[<p>最近公司要求每月要在某APP中完成1000积分的积累，算下来每月要点赞+收藏文章三百多篇。像我这样积极的青年当然要想办法偷个懒~</p><h2 id="思路"><a class="markdownIt-Anchor" href="#思路"></a> 思路</h2><p>该APP恰巧有网页版（没有网页版的话PC端估计还要搭建个安卓模拟器）。最开始尝试过通过<a href="https://pypi.org/project/requests/">requests库</a>获取未读文章并更新积分，不过尝试了很多浏览器的伪装依然失败了😂😂后来考虑通过<a href="https://pypi.org/project/PyAutoGUI/">PyAutoGUI库</a>实现模拟鼠标的操作。<br><br />PyAutoGUI是一个纯Python的GUI自动化库，可实现鼠标和键盘的操作。实现方式也很简单：打开目标网站，通过代码控制鼠标，打开未读的文章，并找到“点赞”和“收藏”的按钮坐标，完成点击+收藏操作后关闭该篇文章，之后更新未读文章后循环操作即可。</p><h2 id="过程"><a class="markdownIt-Anchor" href="#过程"></a> 过程</h2><p>实操下来就用了十几行代码，实测了五六分钟完成了100篇文章的处理，轻轻松松完成两百多积分的获取。事了拂衣去，深藏功与名~<br></p><h3 id="源码如下"><a class="markdownIt-Anchor" href="#源码如下"></a> 源码如下</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyautogui<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_click</span>():<br>    pyautogui.click(<span class="hljs-number">1645</span>,<span class="hljs-number">774</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># 收藏 Point(x=1645, y=774)</span><br>    pyautogui.click(<span class="hljs-number">1742</span>,<span class="hljs-number">772</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># 点赞 Point(x=1742, y=772)</span><br>    pyautogui.click(<span class="hljs-number">1016</span>,<span class="hljs-number">29</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># 关闭标签 Point(x=1016, y=29)</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    time.sleep(<span class="hljs-number">5</span>) <span class="hljs-comment"># 手工打开待处理浏览器</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> (i&lt;<span class="hljs-number">100</span>):<br>        <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            pyautogui.click(<span class="hljs-number">1594</span>,<span class="hljs-number">447</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># 时间优先 Point(x=1594, y=447)</span><br>            pyautogui.click(<span class="hljs-number">615</span>,<span class="hljs-number">578</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># 打开第一篇文章 Point(x=615, y=578)</span><br>        <span class="hljs-keyword">else</span>:<br>            pyautogui.click(<span class="hljs-number">1751</span>,<span class="hljs-number">447</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># 热度优先 Point(x=1751, y=447)</span><br>            pyautogui.click(<span class="hljs-number">615</span>,<span class="hljs-number">578</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># 打开第一篇文章 Point(x=615, y=578)</span><br>        auto_click()  <br>        i+=<span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;累计处理&#123;&#125;篇&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br></code></pre></td></tr></table></figure><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>PyAutoGUI相比requests、urllib库可以用更少的代码量解决此问题，免去了反爬虫的处理，但实际使用时还是发现了一些小的问题：因为是依靠屏幕坐标系完成鼠标的操作，在点赞、收藏图标位置变化（虽然频次很低）时不能很好的处理。我尝试过pyautogui.locateCenterOnScreen()去定位点赞和收藏按钮的具体位置来完成每一篇精准无误的点赞+收藏，但因为识别成功率和识别效率也没有很高就放弃了。即便如此，PyAutoGUI依旧是神器，助我顺利划水，轻松完成月度积分目标😁😁😁</p><p>PyAutoGUI库的功能有点像我前几年使用过的按键精灵、UIPath机器人。类似PyAutoGUI的python库还有win32gui、pywinauto等，后续有机会了再研究下。不可否认的是，作为一种解释性语言，python毫无疑问是值得我深入学习和使用的。</p><h2 id="附pyautogui库基本用法整理"><a class="markdownIt-Anchor" href="#附pyautogui库基本用法整理"></a> 附：PyAutoGUI库基本用法整理</h2><h3 id="鼠标键盘提示框基本操作"><a class="markdownIt-Anchor" href="#鼠标键盘提示框基本操作"></a> 鼠标/键盘/提示框基本操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">####鼠标操作####</span><br>pyautogui.position() <span class="hljs-comment"># 获取当前鼠标的坐标</span><br>pyautogui.locateCenterOnScreen(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/sc.png&#x27;</span>) <span class="hljs-comment"># 根据图像获取当前界面含有该图像的中心坐标</span><br>pyautogui.click(<span class="hljs-number">1751</span>,<span class="hljs-number">447</span>,button=<span class="hljs-string">&#x27;left&#x27;</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># 鼠标左单击。button的参数值有：left,righ,middle</span><br>pyautogui.doubleClick(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)  <span class="hljs-comment"># 指定位置，双击左键</span><br>pyautogui.rightClick(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)   <span class="hljs-comment"># 指定位置，双击右键</span><br>pyautogui.middleClick(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)  <span class="hljs-comment"># 指定位置，双击中键</span><br>pyautogui.mouseDown()   <span class="hljs-comment"># 鼠标按下</span><br>pyautogui.mouseUp()    <span class="hljs-comment"># 鼠标释放</span><br>pyautogui.dragTo(<span class="hljs-number">100</span>,<span class="hljs-number">300</span>,duration=<span class="hljs-number">1</span>)   <span class="hljs-comment"># 拖动到指定的位置</span><br>pyautogui.dragRel(<span class="hljs-number">100</span>,<span class="hljs-number">500</span>,duration=<span class="hljs-number">4</span>)   <span class="hljs-comment"># 按方向拖动，第一个参数是左右移动像素值，第二个是上下</span><br>pyautogui.scroll(<span class="hljs-number">300</span>)  <span class="hljs-comment"># 向上滚动300个单位；</span><br>pyautogui.moveTo(<span class="hljs-number">100</span>,<span class="hljs-number">300</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># 移动鼠标到x,y的位置，移动时间1秒</span><br>pyautogui.moveRel(<span class="hljs-number">100</span>,<span class="hljs-number">500</span>,duration=<span class="hljs-number">4</span>) <span class="hljs-comment"># 向右移动x，向下移动y，移动时间4秒</span><br><br><span class="hljs-comment">####界面操作####</span><br>im = pyautogui.screenshot() <span class="hljs-comment">#返回屏幕的截图，是一个Pillow的image对象</span><br>im.save(<span class="hljs-string">&#x27;屏幕截图.png&#x27;</span>) <span class="hljs-comment">#保存屏幕截图</span><br>im.getpixel((<span class="hljs-number">500</span>, <span class="hljs-number">500</span>)) <span class="hljs-comment">#返回im对象上，（500，500）这一点像素的颜色，是一个RGB元组</span><br>pyautogui.pixelMatchesColor(<span class="hljs-number">500</span>,<span class="hljs-number">500</span>,(<span class="hljs-number">12</span>,<span class="hljs-number">120</span>,<span class="hljs-number">400</span>)) <span class="hljs-comment">#是一个对比函数，对比的是屏幕上（500，500）这一点像素的颜色，与所给的元素是否相同；</span><br><br><span class="hljs-comment">####键盘输入####</span><br>pyautogui.keyDown(<span class="hljs-string">&#x27;shift&#x27;</span>)    <span class="hljs-comment"># 按下shift</span><br>pyautogui.press(<span class="hljs-string">&#x27;4&#x27;</span>)    <span class="hljs-comment"># 按下 4</span><br>pyautogui.keyUp(<span class="hljs-string">&#x27;shift&#x27;</span>)   <span class="hljs-comment"># 释放 shift</span><br>pyautogui.typewrite(<span class="hljs-string">&#x27;this&#x27;</span>,<span class="hljs-number">0.5</span>)  <span class="hljs-comment"># 第一参数是输入内容，第二个参数是每个字符间的间隔时间；</span><br>pyautogui.typewrite([<span class="hljs-string">&#x27;T&#x27;</span>,<span class="hljs-string">&#x27;h&#x27;</span>,<span class="hljs-string">&#x27;i&#x27;</span>,<span class="hljs-string">&#x27;s&#x27;</span>]) <span class="hljs-comment">#typewrite 还可以传入单字母的列表；</span><br>pyautogui.typewrite([<span class="hljs-string">&#x27;T&#x27;</span>,<span class="hljs-string">&#x27;i&#x27;</span>,<span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>,<span class="hljs-string">&#x27;h&#x27;</span>,])   <span class="hljs-comment"># 有时我们需要输入一些特殊的按键，比如向左的箭头，这些有相对应的键盘字符串表示，例如输出：This</span><br>pyautogui.hotkey(<span class="hljs-string">&#x27;ctrl&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>) <span class="hljs-comment"># 快捷键</span><br><br><span class="hljs-comment">####提示信息框####</span><br>a = pyautogui.alert(text=<span class="hljs-string">&#x27;This is an alert box.&#x27;</span>, title=<span class="hljs-string">&#x27;Test&#x27;</span>) <span class="hljs-comment"># 提示框/警示框</span><br><span class="hljs-built_in">print</span>(a)<br>a = pyautogui.confirm(<span class="hljs-string">&#x27;选择一项&#x27;</span>, buttons=[<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>]) <span class="hljs-comment"># 选择框</span><br><span class="hljs-built_in">print</span>(a)<br>a = pyautogui.password(<span class="hljs-string">&#x27;Enter password (text will be hidden)&#x27;</span>) <span class="hljs-comment"># 密码输入，返回值为刚刚输入的值</span><br><span class="hljs-built_in">print</span>(a)<br>a = pyautogui.prompt(<span class="hljs-string">&#x27;请输入一个数字：&#x27;</span>) <span class="hljs-comment"># 普通输入，返回值为刚刚输入的值</span><br><span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-comment">####其他####</span><br>pyautogui.size() <span class="hljs-comment"># 获取屏幕分辨率</span><br><br><span class="hljs-comment">## 停顿功能。意味着所有pyautogui的指令都要暂停一秒；其他指令不会停顿；这样做，可以防止键盘鼠标操作太快；</span><br>pyautogui.PAUSE = <span class="hljs-number">1</span> <br><span class="hljs-comment">## 自动防故障，默认这项功能为True, 这项功能意味着：当鼠标的指针在屏幕的最坐上方，程序会报错；目的是为了防止程序无法停止；</span><br>pyautogui.FAILSAFE =<span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure><h3 id="识别图像"><a class="markdownIt-Anchor" href="#识别图像"></a> 识别图像</h3><p>首先，我们需要先获得一个屏幕快照，例如我们想要点赞，我们就先把大拇指的图片保存下来；然后使用函数：locateOnScreen(‘zan.png’) ，如果可以找到图片，则返回图片的位置，如：Box(left=25, top=703, width=22, height=22)；如果找不到图片，则返回None;<br />如果，屏幕上有多处图片可以匹配，则需要使用locateAllOnScreen(‘zan.png’) ，如果匹配到多个值，则返回一个list，参考如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyautogui<br>pyautogui.PAUSE = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># 图像识别（一个）</span><br>btm = pyautogui.locateOnScreen(<span class="hljs-string">&#x27;zan.png&#x27;</span>)<br><span class="hljs-built_in">print</span>(btm)  <span class="hljs-comment"># Box(left=1280, top=344, width=22, height=22)</span><br><br><span class="hljs-comment"># 图像识别（多个）</span><br>btm = pyautogui.locateAllOnScreen(<span class="hljs-string">&#x27;zan.png&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(btm)) <br></code></pre></td></tr></table></figure><p>pyautogui.center((left, top, width, height)) 返回指定位置的中心点；这样，我们就可以再配合鼠标操作点击找到图片的中心。</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>GUI自动化</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>自动化</tag>
      
      <tag>PyAutoGui</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kettle|自助巡检</title>
    <link href="/2022/04/25/Kettle-%E8%87%AA%E5%8A%A9%E5%B7%A1%E6%A3%80/"/>
    <url>/2022/04/25/Kettle-%E8%87%AA%E5%8A%A9%E5%B7%A1%E6%A3%80/</url>
    
    <content type="html"><![CDATA[<h2 id="想划水肯定有它的原因"><a class="markdownIt-Anchor" href="#想划水肯定有它的原因"></a> 想划水肯定有它的原因</h2><p>是的，我又想划水了~ 不知道什么时候开始，我负责的系统突然就多的一批。每天一大早要开浏览器检查B/S类的几个系统是否正常、要开客户端检查C/S类的几个系统是否正常、还要检查好几个系统的定时任务是否正常、还要检查七八台数据库的备份是不是正常。后来发现！！！我竟然还有一个LDAP的数据要及时检查更新（关于LDAP真的是又爱又恨，有空要展开说说）。前段时间每天早上忙活一阵已经二十分钟过去了~反正我又想偷懒了😵😵😵</p><h2 id="怎么突然想到了kettle"><a class="markdownIt-Anchor" href="#怎么突然想到了kettle"></a> 怎么突然想到了KETTLE</h2><p>ETL工具我平时工作其实是不怎么用得到的，感觉日常的使用需求用ETL工具太笨重了。想到用KETTLE也是没办法了，日常巡检涉及到数据库和网络的检查/处理，很少有一款工具可以一键搞定，而且自己写Shell或Python脚本的话也很有点麻烦。<br><br />Kettle是一款开源的ETL工具，纯java编写，可以在Window、Linux、Unix上运行，绿色无需安装，数据抽取高效稳定。（这一句源于百度~ ）反正KETTL在数据处理上就是很灵活，基本支持常用的各类格式的数据接入、常见规则下的数据转换和加工、常见格式的数据输出，而且对Web服务的常见需求也可以搞定。简直万金油一样的工具~👍👍👍</p><h2 id="简单尝试了一下"><a class="markdownIt-Anchor" href="#简单尝试了一下"></a> 简单尝试了一下</h2><p>Kettle分为作业和转换模式，“作业”基本就等同于完整的流程化处理、“转换”常用于数据的处理和加工。<br><br />✔️公司日常人员变动需要去LDAP中进行物理删除相关信息：写个转换，查询出来内网门户中人员变动清单，然后去LDAP中查到后执行删除操作。<br><br />✔️公司通讯录名单（excel）定期更新到数据库中：写个转换，读取excel数据，然后去对应的数据库中执行更新操作。<br><br />✔️几个日常需要检查服务是否正常的系统：通过作业，检查Web服务是否正常<br><br />✔️几个日常需要检查定时任务是否正常的系统：通过作业，检查数据库是否正常<br><br />现在每天早上点开执行以下，然后只需要检查下数据库备份就完事了~（数据库巡检的事我早晚也要搞一下😂😂😂）<br /><img src="https://s2.loli.net/2022/08/17/IXgUKAqOFnzcGV9.png" alt="LDAP离职人员处理" /><br /><img src="https://s2.loli.net/2022/08/17/U1PW689arvsJFOH.png" alt="员工电话号码更新" /><br /><img src="https://s2.loli.net/2022/08/17/U6XLeYaOcW7bpEi.png" alt="kettle日常巡检执行" /></p><h2 id="最后"><a class="markdownIt-Anchor" href="#最后"></a> 最后</h2><p>用Kettle来做日常巡检感觉有点大材小用了，但借此机会又了解一个新的工具还是很满意的。总体看来Kettle还是很容易上手的，图形化界面也相对友好，操作也很简单。本着虚心学习的心态我在B站上找了操作教程，但根本没坚持看完😂😂😂UP主讲的很好，主要是Kettle太容易上手了。<br><br />B站链接：<a href="https://b23.tv/P65jHuI">2019kettle8.2最新教程-哔哩哔哩</a></p>]]></content>
    
    
    <categories>
      
      <category>Kettle</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Kettle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Excel|合并当前目录所有的excel文件</title>
    <link href="/2019/08/29/VBA-%E5%90%88%E5%B9%B6excel%E6%96%87%E4%BB%B6/"/>
    <url>/2019/08/29/VBA-%E5%90%88%E5%B9%B6excel%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="功能描述"><a class="markdownIt-Anchor" href="#功能描述"></a> 功能描述</h2><p>前几年做项目时有次项目组整理客户的物料编码，涉及上万条数据的整理。十几个人分工整理后还需要合并到一个excel做进一步处理。逐个粘贴到一个表中不仅费时间还容易出错，后来百度了一个方法：通过VBA合并当前文件夹下所有工作簿的全部工作表。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs VBA">Sub 合并当前目录下所有工作簿的全部工作表()<br>Dim MyPath, MyName, AWbName<br>Dim Wb As Workbook, WbN As String<br>Dim G As Long<br>Dim Num As Long<br>Dim BOX As String<br>Application.ScreenUpdating = False<br>MyPath = ActiveWorkbook.Path<br>MyName = Dir(MyPath &amp; &quot;\&quot; &amp; &quot;*.xls&quot;)<br>AWbName = ActiveWorkbook.Name<br>Num = 0<br>Do While MyName &lt;&gt; &quot;&quot;<br>If MyName &lt;&gt; AWbName Then<br>Set Wb = Workbooks.Open(MyPath &amp; &quot;\&quot; &amp; MyName)<br>Num = Num + 1<br>With Workbooks(1).ActiveSheet<br>.Cells(.Range(&quot;B65536&quot;).End(xlUp).Row + 2, 1) = Left(MyName, Len(MyName) - 4)<br>For G = 1 To Sheets.Count<br>Wb.Sheets(G).UsedRange.Copy .Cells(.Range(&quot;B65536&quot;).End(xlUp).Row + 1, 1)<br>Next<br>WbN = WbN &amp; Chr(13) &amp; Wb.Name<br>Wb.Close False<br>End With<br>End If<br>MyName = Dir<br>Loop<br>Range(&quot;B1&quot;).Select<br>Application.ScreenUpdating = True<br>MsgBox &quot;共合并了&quot; &amp; Num &amp; &quot;个工作薄下的全部工作表。如下：&quot; &amp; Chr(13) &amp; WbN, vbInformation, &quot;提示&quot;<br>End Sub<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Excel</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VBA</tag>
      
      <tag>Excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
