<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Python|å®ç°æ³›å¾®E-Mobileæ¶ˆæ¯å‘é€å¯¹æ¥</title>
    <link href="/2023/06/29/Python_emobileapi/"/>
    <url>/2023/06/29/Python_emobileapi/</url>
    
    <content type="html"><![CDATA[<p>â€ƒâ€ƒå‰é¢å·²ç»ç ”ç©¶è¿‡å¦‚ä½•é€šè¿‡å¾®ä¿¡ã€é’‰é’‰è¿›è¡Œæ¶ˆæ¯é€šçŸ¥ï¼Œä½†å…¬å¸å†…éƒ¨è¿˜åœ¨ä½¿ç”¨æ³›å¾®çš„E-Mobileé€šè®¯å·¥å…·ï¼Œéƒ¨åˆ†æ¶‰å¯†ä¿¡æ¯è¿˜æ˜¯é€šè¿‡å†…éƒ¨é€šè®¯å·¥å…·å‘é€æ¯”è¾ƒåˆé€‚ã€‚ä»Šå¤©ç ”ç©¶ä¸‹å¦‚ä½•é€šè¿‡pythonå®ç°E-Mobileçš„æ¶ˆæ¯é€šçŸ¥ã€‚</p><h1 id="åˆ†æè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#åˆ†æè¿‡ç¨‹"></a> åˆ†æè¿‡ç¨‹</h1><p>ä¾›åº”å•†æä¾›äº†ä¸€ä¸ªæ¥å£æ–‡æ¡£ã€Š<a href="https://e-cloudstore.com/doc.html?appId=0d084e0145f044d3888b2e16b1875951">E9äºŒå¼€ã€ç¬¬ä¸‰æ–¹ç³»ç»Ÿæ¨é€æ¶ˆæ¯</a>ã€‹,  ä½†è¿™ç§æ–¹å¼éœ€è¦åœ¨ecologyçš„æ¶ˆæ¯ä¸­å¿ƒè¿›è¡Œé…ç½®ã€‚è€Œæˆ‘å®é™…çš„ä½¿ç”¨éœ€æ±‚ä»…ä»…æ˜¯é€šè¿‡pythonå°†æ¶ˆæ¯æ¨é€åˆ°emobileã€‚<br />åœ¨è·Ÿå‚å•†ç¡®è®¤åå¾—çŸ¥ï¼Œæ³›å¾®æ²¡æœ‰é’ˆå¯¹emobileçš„æ¥å£æ–‡æ¡£ã€‚åæ¥æˆ‘æ›¾æƒ³è¿‡é€šè¿‡æŠ“åŒ…å·¥å…·æŠ“å–å®¢æˆ·ç«¯çš„è¯·æ±‚ä½“ï¼Œä¸è¿‡æ²¡æœ‰æˆåŠŸã€‚<br />åœ¨emobileçš„ç®¡ç†åå°æˆ‘å‘ç°äº†è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ï¼šå¯ä»¥åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯å‹åº”ç”¨ï¼Œé€šè¿‡å‘é€æ¶ˆæ¯çš„åŠŸèƒ½å®ç°ç±»ä¼¼æ¶ˆæ¯é€šçŸ¥/æ¶ˆæ¯å¹¿æ’­çš„åœºæ™¯ã€‚<br /><a href="https://postimg.cc/XZ09L6S8"><img src="https://i.postimg.cc/N0KbgQdW/web.png" alt="emobileç®¡ç†åå°" /></a><br />åˆ†æè¯¥é¡µé¢çš„ç½‘ç»œè¯·æ±‚å¾ˆå®¹æ˜“å°±æ‰¾åˆ°äº†è¯·æ±‚åœ°å€å’Œè¯·æ±‚ä½“ï¼š<br /><a href="https://postimg.cc/RNN1VTLc"><img src="https://i.postimg.cc/m2SmjXc6/image.png" alt="æ¥å£åœ°å€" /></a><br />ä¹‹ååˆ†åˆ«è·å–äº†æ–‡æœ¬ã€å›¾ç‰‡ã€æ–‡ä»¶ã€åˆ†äº«å‡ ç§åœºæ™¯çš„è¯·æ±‚ä½“ï¼Œé€šè¿‡pythonè°ƒç”¨æµ‹è¯•æ»¡è¶³éœ€æ±‚ï¼š<br /><a href="https://postimg.cc/jLmHWJMB"><img src="https://i.postimg.cc/Z5KVM8pY/image.png" alt="å¼¹çª—æ˜¾ç¤º" /></a><br /><a href="https://postimg.cc/4YczpNMy"><img src="https://i.postimg.cc/kg1f32vQ/image.png" alt="æ¶ˆæ¯åˆ—è¡¨" /></a></p><h1 id="æºç æ–‡ä»¶"><a class="markdownIt-Anchor" href="#æºç æ–‡ä»¶"></a> æºç æ–‡ä»¶</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>loginurl = <span class="hljs-string">r&#x27;http://ip:port/emp/passport/login&#x27;</span><br>url = <span class="hljs-string">r&#x27;http://ip:port/emp/api/message/send&#x27;</span><br><br><span class="hljs-comment"># è·å–ç™»å½•ä¿¡æ¯</span><br>login_data = &#123;<span class="hljs-string">&quot;key&quot;</span>:<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;loginid&quot;</span>:<span class="hljs-string">&quot;********&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;********&quot;</span>,<span class="hljs-string">&quot;login_type&quot;</span>:<span class="hljs-number">2</span>,<span class="hljs-string">&quot;loginUUID&quot;</span>:<span class="hljs-string">&quot;&quot;</span>&#125;<br>login_content = requests.post(loginurl,json=login_data)<br>cookies = login_content.cookies<br><br><span class="hljs-comment"># å‘é€æ–‡æœ¬æ¶ˆæ¯</span><br>textContent = &#123;<br><span class="hljs-string">&quot;msgtype&quot;</span>: <span class="hljs-string">&quot;text&quot;</span>,<br><span class="hljs-string">&quot;agentid&quot;</span>: <span class="hljs-number">35</span>,<br><span class="hljs-string">&quot;text&quot;</span>: &#123;<br><span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&quot;æ¥è‡ªpythonçš„æ–‡æœ¬æµ‹è¯•&quot;</span><br>&#125;,<br><span class="hljs-string">&quot;todept&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;toparty&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;touser&quot;</span>: <span class="hljs-string">&quot;683|515&quot;</span>,<br><span class="hljs-string">&quot;totag&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;send_type&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;target_type&quot;</span>: <span class="hljs-number">1</span><br>&#125;<br><span class="hljs-comment"># å‘é€å›¾ç‰‡æ¶ˆæ¯</span><br>imgContent = &#123;<br><span class="hljs-string">&quot;msgtype&quot;</span>: <span class="hljs-string">&quot;image&quot;</span>,<br><span class="hljs-string">&quot;agentid&quot;</span>: <span class="hljs-number">35</span>,<br><span class="hljs-string">&quot;image&quot;</span>: &#123;<br><span class="hljs-string">&quot;media_id&quot;</span>: <span class="hljs-string">&quot;27d81a593df64726824af72e8e9fb2c2&quot;</span><br>&#125;,<br><span class="hljs-string">&quot;todept&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;toparty&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;touser&quot;</span>: <span class="hljs-string">&quot;683&quot;</span>,<br><span class="hljs-string">&quot;totag&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;send_type&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;target_type&quot;</span>: <span class="hljs-number">1</span><br>&#125;<br><span class="hljs-comment"># å‘é€æ–‡ä»¶æ¶ˆæ¯</span><br>fileContent = &#123;<br><span class="hljs-string">&quot;msgtype&quot;</span>: <span class="hljs-string">&quot;file&quot;</span>,<br><span class="hljs-string">&quot;agentid&quot;</span>: <span class="hljs-number">35</span>,<br><span class="hljs-string">&quot;file&quot;</span>: &#123;<br><span class="hljs-string">&quot;media_id&quot;</span>: <span class="hljs-string">&quot;ee736fc486e348d7b0662bf13ad5fa4e&quot;</span><br>&#125;,<br><span class="hljs-string">&quot;todept&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;toparty&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;touser&quot;</span>: <span class="hljs-string">&quot;683&quot;</span>,<br><span class="hljs-string">&quot;totag&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;send_type&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;target_type&quot;</span>: <span class="hljs-number">1</span><br>&#125;<br><span class="hljs-comment"># å‘é€åˆ†äº«æ¶ˆæ¯</span><br>shareContent = &#123;<br><span class="hljs-string">&quot;msgtype&quot;</span>: <span class="hljs-string">&quot;share&quot;</span>,<br><span class="hljs-string">&quot;agentid&quot;</span>: <span class="hljs-number">35</span>,<br><span class="hljs-string">&quot;share&quot;</span>: &#123;<br><span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&quot;ç™¾åº¦é¦–é¡µ&quot;</span>,<br><span class="hljs-string">&quot;extra&quot;</span>: &#123;<br><span class="hljs-string">&quot;linkurl&quot;</span>: <span class="hljs-string">&quot;http://www.baidu.com&quot;</span>,<br><span class="hljs-string">&quot;linkurl_pc&quot;</span>: <span class="hljs-string">&quot;http://www.baidu.com&quot;</span>,<br><span class="hljs-string">&quot;sharetypename&quot;</span>: <span class="hljs-string">&quot;å·¥ä½œé€šçŸ¥&quot;</span>,<br><span class="hljs-string">&quot;desc&quot;</span>: <span class="hljs-string">&quot;ç‚¹å‡»å¯è¿›å…¥ç™¾åº¦é¦–é¡µ&quot;</span>,<br><span class="hljs-string">&quot;show_in_mobile&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;show_in_pc&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;desc&quot;</span>: <span class="hljs-string">&quot;Senderï¼šé™ˆè¿ªï¼Œ2023-06-29 10:36:00&quot;</span>,<br><span class="hljs-string">&quot;sharetypebgcolor&quot;</span>: <span class="hljs-string">&quot;#965454&quot;</span><br>&#125;<br>&#125;,<br><span class="hljs-string">&quot;todept&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;toparty&quot;</span>: <span class="hljs-string">&quot;15&quot;</span>,<br><span class="hljs-string">&quot;touser&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;totag&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;send_type&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;target_type&quot;</span>: <span class="hljs-number">1</span><br>&#125;<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">send_type---å‘é€ç±»å‹ï¼š1-ç«‹å³å‘é€ï¼Œ2-å®šæ—¶å‘é€ï¼Œä¸ºç©ºé»˜è®¤ä¸º1ï¼Œå¦‚æœæ˜¯å®šæ—¶å‘é€æ¶ˆæ¯çš„è¯ï¼Œé‚£ä¹ˆå®šæ—¶å‘é€çš„å‘é€æ—¶é—´ ä¸º send_time å­—æ®µ</span><br><span class="hljs-string">target_type---æ¨é€ç›®æ ‡ç±»å‹ï¼Œ0-æ— ï¼Œ1-E-mobileï¼Œ2-ä¼ä¸šå·ï¼Œè¯¥æ¶ˆæ¯æ˜¯éœ€è¦æ¨é€åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Œ1-æ˜¯emçš„å³æ—¶é€šçš„æ¶ˆæ¯ä¸Šï¼Œ2-æ˜¯ç”¨æˆ·é›†æˆçš„åœ°æ–¹äº‘æ¡¥ä¸Šï¼Œæ¯”å¦‚ä¼ä¸šå¾®ä¿¡ï¼Œé’‰é’‰ç­‰ï¼Œ 0æ˜¯æ ¹æ®é…ç½®emobileå’Œä¼ä¸šå·éƒ½æ¨é€</span><br><span class="hljs-string">media_id---æ–‡ä»¶ç´ æidï¼Œæ˜¯ç”¨æˆ·ä¸Šä¼ åˆ°emçš„æ–‡ä»¶idï¼Œæ˜¯è¡¨ em_sys_base_file è¡¨å­˜å‚¨çš„æ–‡ä»¶ä¿¡æ¯çš„æ–‡ä»¶è®°å½•idä¸»é”®</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># result = requests.post(url,cookies=cookies,json = textContent)</span><br><span class="hljs-comment"># result = requests.post(url,cookies=cookies,json = imgContent)</span><br><span class="hljs-comment"># result = requests.post(url,cookies=cookies,json = fileContent)</span><br>result = requests.post(url,cookies=cookies,json = shareContent)<br><span class="hljs-built_in">print</span>(result.text)<br></code></pre></td></tr></table></figure><h1 id="e-mobileæ•°æ®åº“çš„è¿æ¥"><a class="markdownIt-Anchor" href="#e-mobileæ•°æ®åº“çš„è¿æ¥"></a> e-mobileæ•°æ®åº“çš„è¿æ¥</h1><p>æ¶‰åŠå›¾ç‰‡ã€æ–‡ä»¶æ¶ˆæ¯å‘é€æ—¶éœ€è¦media_idå€¼ï¼Œè¯¥å€¼è®°å½•åœ¨e-mobileçš„mysqlæ•°æ®åº“ä¸­ï¼ˆè¡¨åï¼šem_sys_base_fileï¼‰ã€‚è€Œmysqlæ•°æ®åº“é»˜è®¤æ˜¯ä¸å…è®¸è¿œç¨‹è¿æ¥çš„ï¼Œéœ€è¦è°ƒæ•´ç”¨æˆ·æƒé™ï¼Œå…è®¸è¿œç¨‹è¿æ¥ã€‚æ“ä½œæ–¹å¼å¦‚ä¸‹ï¼š</p><blockquote><p>1ã€æ‰“å¼€å‘½ä»¤è¡Œæˆ–ç»ˆç«¯ï¼Œè¿›å…¥ç§»åŠ¨å¹³å°å®‰è£…æ ¹ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤<br />windows: dbsvr\mysql\bin\mysql -P 4806 -u root -p<br />linux: /usr/emp/dbsvr/mysql/bin/mysql -u root -p --socket=/usr/emp/data/mysqldata/mysql.sock<br />2ã€è¾“å…¥å¯†ç å¹¶å›è½¦<br />3ã€è¾“å…¥sglè¯­å¥:<br />create user â€˜rootâ€™@â€™%â€™ identified with mysql_native_password by â€˜mysqlçš„å¯†ç â€™;<br />4ã€è¾“å…¥sqlè¯­å¥:<br />grant all privileges on <em>.</em> to â€˜rootâ€™@â€™%â€™;<br />å›è½¦<br />5ã€è¾“å…¥sqlè¯­å¥:<br />flush privileges;<br />å›è½¦</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>requests</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>requests</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|å®ç°PCç«¯å¾®ä¿¡å¯¹æ¥</title>
    <link href="/2023/06/26/Python_wechatapi/"/>
    <url>/2023/06/26/Python_wechatapi/</url>
    
    <content type="html"><![CDATA[<p>â€ƒâ€ƒä»Šå¤©ä»‹ç»ä¸€ä¸ªå…è´¹å¼€æºçš„å¾®ä¿¡HOOKå’Œæ¡†æ¶ï¼Œæä¾›HTTPAPIæ¥å£å’Œå°è£…å¥½çš„æ¡†æ¶ï¼Œå¯åŸºäºæ­¤é€šè¿‡pythonå¯¹æ¥å¾®ä¿¡ã€‚</p><h1 id="é¡¹ç›®åœ°å€"><a class="markdownIt-Anchor" href="#é¡¹ç›®åœ°å€"></a> é¡¹ç›®åœ°å€</h1><p>giteeåœ°å€ï¼š<a href="https://gitee.com/xiao-lis-personal-warehouse/mp_-weixin2">åƒå¯»æ¡†æ¶å¼€æºå¾®ä¿¡hookæ¡†æ¶</a><br />æ¥å£åœ°å€ï¼š<a href="https://www.apifox.cn/apidoc/shared-af49a169-8b5c-4137-a5ea-723a10e8e794/doc-1046131">https://www.apifox.cn/apidoc/shared-af49a169-8b5c-4137-a5ea-723a10e8e794/doc-1046131</a>  å¯†ç  vHCAG7IM<br />3.6.0.18ç‰ˆæœ¬å¾®ä¿¡ä¸‹è½½åœ°å€ï¼š<a href="https://pan.quark.cn/s/eee03fdec56e">https://pan.quark.cn/s/eee03fdec56e</a></p><h1 id="å®ç°è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#å®ç°è¿‡ç¨‹"></a> å®ç°è¿‡ç¨‹</h1><ol><li>ä¸‹è½½3.6.0.18ç‰ˆæœ¬å¾®ä¿¡è¿›è¡Œå®‰è£…ï¼ˆå¿…é¡»ä½¿ç”¨å¯¹åº”ç‰ˆæœ¬çš„å¾®ä¿¡ï¼Œå¦åˆ™ä¼šæœ‰å°å·é£é™©ï¼‰ã€‚</li><li>ä¸‹è½½åƒå¯»æ¡†æ¶å¹¶æ‰“å¼€ï¼Œåœ¨æ¡†æ¶è®¾ç½®ä¸­è®¾ç½®å¾®ä¿¡å®‰è£…ç›®å½•ã€å›¾ç‰‡ç¼“å­˜ç›®å½•ã€å¾®ä¿¡æ•°æ®ç›®å½•ä¿¡æ¯ï¼Œä¿å­˜åé‡å¯ã€‚</li><li>æ‰“å¼€åƒå¯»æ¡†æ¶ï¼Œåœ¨å¾®ä¿¡ç®¡ç†é¡µç­¾æ·»åŠ å¾®ä¿¡ï¼Œä¹‹åæ­£å¸¸æ‰«ç ç™»å½•å¾®ä¿¡ã€‚</li><li>ç™»å½•å¾®ä¿¡åè¿”å›åƒå¯»æ¡†æ¶ï¼Œè®°å½•wxidå€¼ã€‚åœ¨åç»­pythonçš„å¯¹æ¥ä¸­wxidä¼šä½œä¸ºä¸»è¦çš„postå‚æ•°ã€‚</li><li>åœ¨æ¥å£åœ°å€ä¸­å¯å‚è€ƒä»£ç ç¤ºä¾‹è¿›è¡Œæµ‹è¯•å’Œä½¿ç”¨ã€‚å¦‚è·å–å¾®ä¿¡åˆ—è¡¨ã€å‘é€æ–‡æœ¬/å›¾ç‰‡/æ–‡ä»¶ã€è·å–å¥½å‹åˆ—è¡¨/ä¸ªäººä¿¡æ¯ã€æ·»åŠ å¥½å‹ã€é‚€è¯·è¿›ç¾¤ç­‰æ¥å£ã€‚</li></ol><p><span style='color:red'>å»ºè®®æå‰å°†å¼€æºæ’ä»¶ã€æ¥å£åœ°å€ã€å¾®ä¿¡ç‰ˆæœ¬å®‰è£…åŒ…ç­‰ä¿å­˜ä¸€ä»½åˆ°æœ¬åœ°ï¼Œè¿™ç§å¥½çš„å·¥å…·æ€»æ‹…å¿ƒæŸä¸€å¤©ä¼šè¢«å’Œè°ğŸ˜‚åç»­ä¼šè€ƒè™‘å°†æ¥å£å†…å®¹æ¬è¿åˆ°è¿™ç¯‡åšå®¢ä¸­ã€‚</span></p>]]></content>
    
    
    <categories>
      
      <category>Hook</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|å®ç°å…¬å¸å‘¨æŠ¥çš„è‡ªåŠ¨ç”Ÿæˆ</title>
    <link href="/2023/06/25/Python_docx/"/>
    <url>/2023/06/25/Python_docx/</url>
    
    <content type="html"><![CDATA[<p>â€ƒâ€ƒå¦‚æœæ¯å‘¨è¦ç»™é¢†å¯¼å‘ä¸€ä¸ªå…¬å¸å‘¨æŠ¥ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿè€ƒè™‘åˆ°ç¾è§‚æ€§å’Œä¸€è‡´æ€§ï¼Œæˆ‘æƒ³åº”è¯¥æ˜¯åˆ¶å®šä¸€ä¸ªæ ¼å¼è§„èŒƒï¼Œè®¾è®¡å¥½é¡µçœ‰ã€é¡µè„šã€é¡µè¾¹è·ã€å­—ä½“ã€æ®µè½ã€è¡¨æ ¼æ¡†ç­‰å„ç±»çš„æ ·å¼ï¼Œä¹‹åæŒ‰ç…§è§„èŒƒè¦æ±‚å®šæœŸæ’°å†™å…¬å¸å‘¨æŠ¥ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„ä¸»æ„ï¼Œåªéœ€è¦æ±‡æ€»å„éƒ¨é—¨å‘¨æŠ¥å†…å®¹åï¼Œå¤åˆ¶ç²˜è´´åˆ°æ¨¡æ¿æ–‡ä»¶é‡Œï¼Œå°±å¯ä»¥ç”Ÿæˆä¸€ç¯‡ç¾è§‚çš„å‘¨æŠ¥äº†ã€‚ä½†å¦‚æœè¦è‡ªåŠ¨ç”Ÿæˆè¿™æ ·ä¸€ä¸ªå¤æ‚çš„wordå‘¢ï¼Ÿ<br />â€ƒâ€ƒæœ¬æ¬¡çš„éœ€æ±‚æ˜¯å®ç°å…¬å¸å‘¨æŠ¥ï¼ˆwordï¼‰çš„è‡ªåŠ¨ç”Ÿæˆã€‚åœ¨éœ€æ±‚åˆ†ææ—¶å‘ç°å®ç°èµ·æ¥è¿˜æ˜¯æœ‰äº›éš¾åº¦çš„ã€‚è®°å½•å¦‚ä¸‹ï¼š</p><h1 id="ç°çŠ¶æè¿°"><a class="markdownIt-Anchor" href="#ç°çŠ¶æè¿°"></a> ç°çŠ¶æè¿°</h1><p>â€ƒâ€ƒå…¬å¸å‘¨æŠ¥æ˜¯å…¬å¸å„éƒ¨é—¨/æ€»éƒ¨æ¯å‘¨é‚®ä»¶å‘é€ç»™æŒ‡å®šçš„ä¸“å‘˜ï¼Œä¸“å‘˜åˆ†åˆ«ä¸‹è½½é™„ä»¶åæŒ‰ç…§éƒ¨é—¨/æ€»éƒ¨çš„é¡ºåºåˆå¹¶åˆ°ä¸€ä¸ªwordæ–‡æ¡£ä¸­ã€‚å› å„éƒ¨é—¨/æ€»éƒ¨æŠ¥é€çš„æ–‡æ¡£æ ¼å¼ä¸å°½ç›¸åŒï¼Œä¸“å‘˜åœ¨åˆå¹¶çš„åŒæ—¶è¿˜éœ€è¦è°ƒæ•´wordä½¿å…¶æ»¡è¶³å‘¨æŠ¥è§„èŒƒã€‚</p><h1 id="åˆ†æè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#åˆ†æè¿‡ç¨‹"></a> åˆ†æè¿‡ç¨‹</h1><ul><li>å‘¨æŠ¥è§„èŒƒåˆ†æï¼ˆå‘¨æŠ¥é€šè¿‡åˆ†èŠ‚ç¬¦åˆ†ä¸ºäº†ä¸‰èŠ‚ï¼‰<ol><li>ç¬¬ä¸€èŠ‚ï¼š<br>é¡µçœ‰ï¼šæ— ï¼›<br>é¡µè„šï¼šå›ºå®šæ–‡å­—ï¼ˆå½©è™¹ç²—ä»¿å®‹10.5ç£…å­—ä½“ï¼‰ï¼›<br>é¡µé¢æ–¹å‘ï¼šçºµå‘ï¼›<br>é¡µè¾¹è·ï¼šä¸Š2.54å˜ç±³ï¼Œä¸‹2.54å˜ç±³ï¼Œå·¦3.17å˜ç±³ï¼Œå³3å˜ç±³ï¼›<br>å†…å®¹ï¼šå…¬å¸logoï¼›å°é¢å›¾ç‰‡ï¼›ç»è¥æƒ…å†µå‘¨æŠ¥å¤§æ ‡é¢˜ï¼ˆå½©è™¹å°æ ‡å®‹äºŒå·åŠ ç²—ï¼‰ï¼›æœŸå·å’Œæ—¥æœŸï¼ˆå½©è™¹ç²—ä»¿å®‹å››å·ï¼‰</li><li>ç¬¬äºŒèŠ‚ï¼š<br>é¡µçœ‰ï¼šå«æœŸå·å’Œæ—¥æœŸçš„å…¬å¸ç»è¥æƒ…å†µå‘¨æŠ¥æ–‡å­—ï¼Œå…¬å¸logoï¼›<br>é¡µè„šï¼šé¡µç ï¼›<br>é¡µé¢æ–¹å‘ï¼šçºµå‘ï¼›<br>é¡µè¾¹è·ï¼šä¸Š2.54å˜ç±³ï¼Œä¸‹2.54å˜ç±³ï¼Œå·¦3.17å˜ç±³ï¼Œå³3å˜ç±³ï¼›<br>å†…å®¹ï¼šä¸€çº§æ ‡é¢˜ï¼ˆå½©è™¹é»‘ä½“å››å·ï¼Œé¦–è¡Œç¼©è¿›2å­—ç¬¦ï¼Œæ®µå‰1è¡Œï¼Œä¸­æ–‡æ•°å­—ç¼–å·è§„åˆ™ï¼‰ï¼ŒäºŒçº§æ ‡é¢˜ï¼ˆå½©è™¹æ¥·ä½“å››å·åŠ ç²—ï¼Œé¦–è¡Œç¼©è¿›2å­—ç¬¦ï¼Œä¸­æ–‡æ•°å­—+æ‹¬å·ç¼–å·è§„åˆ™ï¼Œæ­£æ–‡ï¼ˆå½©è™¹ç²—ä»¿å®‹å››å·ï¼Œé¦–è¡Œç¼©è¿›2å­—ç¬¦ï¼‰</li><li>ç¬¬ä¸‰èŠ‚:<br>é¡µçœ‰ï¼šå«æœŸå·å’Œæ—¥æœŸçš„å…¬å¸ç»è¥æƒ…å†µå‘¨æŠ¥æ–‡å­—ï¼Œå…¬å¸logoï¼›<br>é¡µè„šï¼šé¡µç ï¼›<br>é¡µé¢æ–¹å‘ï¼šæ¨ªå‘ï¼›<br>é¡µè¾¹è·ï¼šä¸Š3.17å˜ç±³ï¼Œä¸‹3å˜ç±³ï¼Œå·¦2.54å˜ç±³ï¼Œå³2.54å˜ç±³ï¼›<br>å†…å®¹ï¼šè¡¨æ ¼å†…å®¹ï¼ˆå½©è™¹ç²—ä»¿å®‹11ç£…ï¼‰</li></ol></li><li>æ€»éƒ¨å‘¨æŠ¥å†…å®¹<br>å„æ€»éƒ¨çš„å†…å®¹éœ€è¦æ±‡æ€»è‡³ç¬¬äºŒèŠ‚ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ¶‰åŠä¸€çº§æ ‡é¢˜å’Œæ­£æ–‡ï¼Œéƒ¨åˆ†æƒ…å†µä¸‹ä¼šæ¶‰åŠäºŒçº§æ ‡é¢˜æˆ–è¡¨æ ¼ã€‚</li><li>èŒèƒ½éƒ¨é—¨å†…å®¹<br>å„æ™ºèƒ½éƒ¨é—¨çš„å†…å®¹éœ€è¦æ±‡æ€»è‡³ç¬¬ä¸‰èŠ‚ï¼ŒèŒèƒ½éƒ¨é—¨çš„å¡«æŠ¥å†…å®¹ç®€æ´æ˜äº†ï¼Œæ¶‰åŠéƒ¨é—¨ã€å·¥ä½œäº‹é¡¹åç§°ã€æœ¬å‘¨è¿›å±•æƒ…å†µã€ä¸‹å‘¨å·¥ä½œå®‰æ’å››ä¸ªå›ºå®šçš„å¡«å†™å†…å®¹ã€‚</li><li>å…¶ä»–å†…å®¹<br>åœ¨åˆ†ææ—¶å‘ç°å„æ€»éƒ¨æäº¤çš„å†…å®¹æ ¼å¼ä¸å®Œå…¨ç»Ÿä¸€ï¼Œéœ€è¦å‘¨æŠ¥ä¸“å‘˜æ‰‹å·¥è°ƒæ•´æ ¼å¼ï¼Œä¸”æ€»éƒ¨å‘¨æŠ¥åœ¨æ±‡æ€»æ—¶æœ‰æ’åºè¦æ±‚ã€‚<br>èŒèƒ½éƒ¨é—¨å¡«æŠ¥å†…å®¹è™½ç„¶ç®€æ´ï¼Œä½†ä¹Ÿä¼šå­˜åœ¨å¡«æŠ¥æ ¼å¼ä¸ç»Ÿä¸€çš„æƒ…å†µï¼Œå¦‚åºå·è§„åˆ™ä¸ç»Ÿä¸€ï¼Œç»“æŸæ ‡ç‚¹ç¬¦å·ä¸ç»Ÿä¸€ç­‰ã€‚èŒèƒ½éƒ¨é—¨æ±‡æ€»æ—¶ä¹Ÿæœ‰æ’åºè¦æ±‚ï¼Œä¸”ä¸ªåˆ«éƒ¨é—¨çš„åç§°ä¼šæœ‰è¦æ±‚ï¼ˆå¦‚ä¸€ä¸ªéƒ¨é—¨æœ‰ä¸¤å—ç‰Œå­ï¼‰ã€‚</li></ul><h1 id="å®ç°è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#å®ç°è¿‡ç¨‹"></a> å®ç°è¿‡ç¨‹</h1><ol><li>è€ƒè™‘åˆ°éƒ¨é—¨æ¶æ„æˆ–æ˜¾ç¤ºé¡ºåºå¯èƒ½ä¼šè°ƒæ•´ã€å› æ³•å®šå‡æ—¥å¯¼è‡´çš„å‘¨æŠ¥æœŸå·ä¸å…·å¤‡ä¸¥æ ¼çš„å‘¨æœŸè§„å¾‹ã€ä¸“å‘˜å®šæœŸæ›´æ¢ç­‰åŸå› ï¼Œåˆ›å»ºä¸‰ä¸ªæ•°æ®åº“è¡¨ï¼Œç”¨äºç»´æŠ¤å…¬å¸å‘¨æŠ¥æœŸå·ã€å„æ€»éƒ¨/éƒ¨é—¨åˆæˆé¡ºåºï¼ˆåŠéƒ¨é—¨æ˜¾ç¤ºåç§°ï¼‰ã€ç”Ÿæˆå‘¨æŠ¥çš„æé†’äººå‘˜é‚®ç®±ã€‚</li><li>åˆ›å»ºä¸€ä¸ªwordçš„moduleæ–‡ä»¶ï¼Œæå‰è®¾ç½®å¥½ä¸€çº§ã€äºŒçº§ã€æ­£æ–‡çš„ç¼–å·/æ®µè½/å­—ä½“ç­‰æ ·å¼ã€‚å¹¶è¿›è¡Œæ–‡æ¡£ç¼–è¾‘åŒºåŸŸé™åˆ¶ã€‚æ§åˆ¶å¡«æŠ¥äººåªèƒ½æŒ‰ç…§é¢„è®¾çš„æ ¼å¼è¿›è¡Œç¼–è¾‘ã€‚</li><li>å®šæœŸè§¦å‘å‘¨æŠ¥å¡«æŠ¥æµç¨‹ã€‚å„æ€»éƒ¨ä¸Šä¼ æŒ‰ç…§moduleæ–‡ä»¶æ•´ç†çš„å‘¨æŠ¥æ–‡ä»¶ï¼Œå„èŒèƒ½éƒ¨é—¨åœ¨æµç¨‹ä¸­å¢åŠ æ˜ç»†è¡Œå¡«å†™éƒ¨é—¨å‘¨æŠ¥ã€‚</li><li>é€šè¿‡pythonè¯»å–/ä¸‹è½½ä¸Šè¿°æ¶‰åŠåˆ°çš„è¡¨å†…å®¹/é™„ä»¶æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§å‘¨æŠ¥æ ¼å¼è¦æ±‚ç”Ÿæˆwordï¼Œç”Ÿæˆåé‚®ä»¶é€šçŸ¥ç»™å‘¨æŠ¥ä¸“å‘˜ã€‚</li></ol><h1 id="wordåˆæˆæºç "><a class="markdownIt-Anchor" href="#wordåˆæˆæºç "></a> wordåˆæˆæºç </h1><p>â€ƒâ€ƒæœ¬æ¬¡éœ€æ±‚æ˜¯åŸºäºpythonçš„docxåº“å®ç°çš„ã€‚å› å‘¨æŠ¥æ–‡ä»¶æ¶‰åŠçš„ç»†èŠ‚æ¯”è¾ƒå¤šï¼Œåœ¨æµ‹è¯•è¿‡ç¨‹ä¸­åŸºæœ¬æ˜¯åšåˆ°äº†å¯¹docxåº“çš„æ·±åº¦ä½¿ç”¨ã€‚å…¶ä¸­å¤§é‡é˜…è¯»å¹¶å‚è€ƒäº†ã€Š<a href="https://python-docx.readthedocs.io/en/latest/">docxå®˜æ–¹æ–‡æ¡£</a>ã€‹ï¼Œåœ¨ä¸ªåˆ«ç±»çš„å¤å†™è¿‡ç¨‹ä¸­ä¹Ÿå‚è€ƒäº†CSDNçš„ä¸€äº›åšä¸»çš„æ–‡ç« ã€‚å› ä¸ºå¯¹docxæ–‡ä»¶åº•å±‚ï¼ˆxmlï¼‰çš„ç†è§£ä¸æ˜¯å¾ˆå…¨é¢ï¼Œéƒ¨åˆ†éœ€æ±‚ä¹Ÿå€ŸåŠ©äº†ChatGPTçš„æ”¯æŒã€‚æœ‰æ•ˆåœ°æå‡äº†æœ¬æ¬¡éœ€æ±‚çš„å¼€å‘æ•ˆç‡ã€‚æºç æä¾›å¦‚ä¸‹ï¼š</p><h2 id="extract_content_from_docxé€’å½’è¯»å–wordå†…å®¹"><a class="markdownIt-Anchor" href="#extract_content_from_docxé€’å½’è¯»å–wordå†…å®¹"></a> extract_content_from_docx(é€’å½’è¯»å–wordå†…å®¹)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    ä¸‹é¢æ˜¯é€šè¿‡é€’å½’æ–¹å¼è¯»å–æ®µè½æˆ–è¡¨æ ¼</span><br><span class="hljs-string">    å…¶ä¸­æ®µè½å¤„ç†æ—¶è¯»å–wordæ–‡æ¡£çš„æ ·å¼ã€å­—ä½“ï¼Œç”¨äºåŒºåˆ†åç»­å¤„ç†ã€‚</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> docx<br><span class="hljs-keyword">from</span> docx.enum.style <span class="hljs-keyword">import</span> WD_STYLE_TYPE<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_content_from_docx</span>(<span class="hljs-params">file_path</span>):<br>    doc = docx.Document(file_path)<br>    content = []  <span class="hljs-comment"># å­˜å‚¨æŒ‰é¡ºåºè·å–çš„å†…å®¹</span><br>    tableNum = <span class="hljs-number">0</span> <span class="hljs-comment"># è¦å¤„ç†çš„ç¬¬Xä¸ªè¡¨æ ¼</span><br><br>    <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> doc.element.body:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(element, docx.oxml.text.paragraph.CT_P):<br>            paragraph = docx.text.paragraph.Paragraph(element, doc)<br>            <span class="hljs-comment"># å¤„ç†æ®µè½å†…å®¹</span><br>            style_name = <span class="hljs-literal">None</span><br>            font_name = <span class="hljs-literal">None</span><br>            <span class="hljs-keyword">if</span> paragraph.style.name.startswith(<span class="hljs-string">&#x27;Normal&#x27;</span>):<br>                style_name = <span class="hljs-string">&#x27;Normal&#x27;</span><br>                font_name = paragraph.style.font.name<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">for</span> style <span class="hljs-keyword">in</span> doc.styles:<br>                    <span class="hljs-keyword">if</span> style.<span class="hljs-built_in">type</span> == WD_STYLE_TYPE.PARAGRAPH <span class="hljs-keyword">and</span> \<br>                            paragraph.style.base_style == style.base_style <span class="hljs-keyword">and</span> \<br>                            paragraph.style.font == style.font <span class="hljs-keyword">and</span> \<br>                            paragraph.style.paragraph_format == style.paragraph_format:<br>                        style_name = style.name<br>                        font_name = style.font.name<br>                        <span class="hljs-keyword">break</span><br><br>            <span class="hljs-keyword">if</span> font_name == <span class="hljs-string">&#x27;å½©è™¹å°æ ‡å®‹&#x27;</span>:<br>                <span class="hljs-keyword">pass</span><br>            <span class="hljs-keyword">elif</span> font_name == <span class="hljs-string">&#x27;å½©è™¹é»‘ä½“&#x27;</span> <span class="hljs-keyword">or</span> style_name == <span class="hljs-string">&#x27;Heading 1&#x27;</span>:<br>                content.append((<span class="hljs-string">&#x27;paragraph&#x27;</span>, <span class="hljs-string">&#x27;L1&#x27;</span>,paragraph.text))<br>            <span class="hljs-keyword">elif</span> font_name == <span class="hljs-string">&#x27;å½©è™¹æ¥·ä½“&#x27;</span> <span class="hljs-keyword">or</span> style_name == <span class="hljs-string">&#x27;Heading 2&#x27;</span>:<br>                content.append((<span class="hljs-string">&#x27;paragraph&#x27;</span>, <span class="hljs-string">&#x27;L2&#x27;</span>,paragraph.text))<br>            <span class="hljs-keyword">elif</span> font_name == <span class="hljs-string">&#x27;å½©è™¹ç²—ä»¿å®‹&#x27;</span> <span class="hljs-keyword">or</span> style_name == <span class="hljs-string">&#x27;Normal&#x27;</span>:<br>                content.append((<span class="hljs-string">&#x27;paragraph&#x27;</span>, <span class="hljs-string">&#x27;L0&#x27;</span>,paragraph.text))<br>    <br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(element, docx.oxml.table.CT_Tbl):<br><br>            table_content = []<br>            table = doc.tables[tableNum]<br>            tableNum += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table.rows:<br>                row_content = []<br>                <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row.cells:<br>                    cell_text = cell.text.strip()<br>                    <span class="hljs-keyword">if</span> cell_text:<br>                        row_content.append(cell_text)<br>                <span class="hljs-keyword">if</span> row_content:<br>                    table_content.append(row_content)<br>            <span class="hljs-keyword">if</span> table_content:<br>                content.append((<span class="hljs-string">&#x27;table&#x27;</span>,<span class="hljs-string">&#x27;null&#x27;</span>, table_content))<br>    <span class="hljs-keyword">return</span> content<br><br><br></code></pre></td></tr></table></figure><h2 id="add_float_pictureæ·»åŠ æµ®äºæ–‡å­—ä¸Šæ–¹çš„å›¾ç‰‡"><a class="markdownIt-Anchor" href="#add_float_pictureæ·»åŠ æµ®äºæ–‡å­—ä¸Šæ–¹çš„å›¾ç‰‡"></a> add_float_picture(æ·»åŠ æµ®äºæ–‡å­—ä¸Šæ–¹çš„å›¾ç‰‡)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-comment"># filename: add_float_picture.py</span><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Implement floating image based on python-docx.</span><br><span class="hljs-string">- Text wrapping style: BEHIND TEXT &lt;wp:anchor behindDoc=&quot;1&quot;&gt;</span><br><span class="hljs-string">- Picture position: top-left corner of PAGE `&lt;wp:positionH relativeFrom=&quot;page&quot;&gt;`.</span><br><span class="hljs-string">Create a docx sample (Layout | Positions | More Layout Options) and explore the</span><br><span class="hljs-string">source xml (Open as a zip | word | document.xml) to implement other text wrapping</span><br><span class="hljs-string">styles and position modes per `CT_Anchor._anchor_xml()`.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">from</span> docx.oxml <span class="hljs-keyword">import</span> parse_xml, register_element_cls<br><span class="hljs-keyword">from</span> docx.oxml.ns <span class="hljs-keyword">import</span> nsdecls<br><span class="hljs-keyword">from</span> docx.oxml.shape <span class="hljs-keyword">import</span> CT_Picture<br><span class="hljs-keyword">from</span> docx.oxml.xmlchemy <span class="hljs-keyword">import</span> BaseOxmlElement, OneAndOnlyOne<br><br><br><span class="hljs-comment"># refer to docx.oxml.shape.CT_Inline</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CT_Anchor</span>(<span class="hljs-title class_ inherited__">BaseOxmlElement</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ``&lt;w:anchor&gt;`` element, container for a floating image.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    extent = OneAndOnlyOne(<span class="hljs-string">&#x27;wp:extent&#x27;</span>)<br>    docPr = OneAndOnlyOne(<span class="hljs-string">&#x27;wp:docPr&#x27;</span>)<br>    graphic = OneAndOnlyOne(<span class="hljs-string">&#x27;a:graphic&#x27;</span>)<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">new</span>(<span class="hljs-params">cls, cx, cy, shape_id, pic, pos_x, pos_y</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Return a new ``&lt;wp:anchor&gt;`` element populated with the values passed</span><br><span class="hljs-string">        as parameters.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        anchor = parse_xml(cls._anchor_xml(pos_x, pos_y))<br>        anchor.extent.cx = cx<br>        anchor.extent.cy = cy<br>        anchor.docPr.<span class="hljs-built_in">id</span> = shape_id<br>        anchor.docPr.name = <span class="hljs-string">&#x27;Picture %d&#x27;</span> % shape_id<br>        anchor.graphic.graphicData.uri = (<br>            <span class="hljs-string">&#x27;http://schemas.openxmlformats.org/drawingml/2006/picture&#x27;</span><br>        )<br>        anchor.graphic.graphicData._insert_pic(pic)<br>        <span class="hljs-keyword">return</span> anchor<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">new_pic_anchor</span>(<span class="hljs-params">cls, shape_id, rId, filename, cx, cy, pos_x, pos_y</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Return a new `wp:anchor` element containing the `pic:pic` element</span><br><span class="hljs-string">        specified by the argument values.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        pic_id = <span class="hljs-number">0</span>  <span class="hljs-comment"># Word doesn&#x27;t seem to use this, but does not omit it</span><br>        pic = CT_Picture.new(pic_id, filename, rId, cx, cy)<br>        anchor = cls.new(cx, cy, shape_id, pic, pos_x, pos_y)<br>        anchor.graphic.graphicData._insert_pic(pic)<br>        <span class="hljs-keyword">return</span> anchor<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_anchor_xml</span>(<span class="hljs-params">cls, pos_x, pos_y</span>):<br>        <span class="hljs-keyword">return</span> (<br>                <span class="hljs-string">&#x27;&lt;wp:anchor distT=&quot;0&quot; distB=&quot;0&quot; distL=&quot;0&quot; distR=&quot;0&quot; simplePos=&quot;0&quot; relativeHeight=&quot;0&quot; \n&#x27;</span><br>                <span class="hljs-comment"># &#x27;           behindDoc=&quot;1&quot; locked=&quot;0&quot; layoutInCell=&quot;1&quot; allowOverlap=&quot;1&quot; \n&#x27;</span><br>                <span class="hljs-string">&#x27;           behindDoc=&quot;0&quot; locked=&quot;0&quot; layoutInCell=&quot;1&quot; allowOverlap=&quot;1&quot; \n&#x27;</span><br>                <span class="hljs-string">&#x27;           %s&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;wp:simplePos x=&quot;0&quot; y=&quot;0&quot;/&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;wp:positionH relativeFrom=&quot;page&quot;&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;    &lt;wp:posOffset&gt;%d&lt;/wp:posOffset&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;/wp:positionH&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;wp:positionV relativeFrom=&quot;page&quot;&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;    &lt;wp:posOffset&gt;%d&lt;/wp:posOffset&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;/wp:positionV&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;wp:extent cx=&quot;914400&quot; cy=&quot;914400&quot;/&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;wp:wrapNone/&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;wp:docPr id=&quot;37&quot; name=&quot;ç›´æ¥è¿æ¥ç¬¦ 5&quot;/&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;wp:cNvGraphicFramePr&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;    &lt;a:graphicFrameLocks noChangeAspect=&quot;1&quot;/&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;/wp:cNvGraphicFramePr&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;a:graphic&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;    &lt;a:graphicData uri=&quot;URI not set&quot;/&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;  &lt;/a:graphic&gt;\n&#x27;</span><br>                <span class="hljs-string">&#x27;&lt;/wp:anchor&gt;&#x27;</span> % (nsdecls(<span class="hljs-string">&#x27;wp&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;pic&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>), <span class="hljs-built_in">int</span>(pos_x), <span class="hljs-built_in">int</span>(pos_y))<br>        )<br><br><br><span class="hljs-comment"># refer to docx.parts.story.BaseStoryPart.new_pic_inline</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">new_pic_anchor</span>(<span class="hljs-params">part, image_descriptor, width, height, pos_x, pos_y</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Return a newly-created `w:anchor` element.</span><br><span class="hljs-string">    The element contains the image specified by *image_descriptor* and is scaled</span><br><span class="hljs-string">    based on the values of *width* and *height*.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    rId, image = part.get_or_add_image(image_descriptor)<br>    cx, cy = image.scaled_dimensions(width, height)<br>    shape_id, filename = part.next_id, image.filename<br>    <span class="hljs-keyword">return</span> CT_Anchor.new_pic_anchor(shape_id, rId, filename, cx, cy, pos_x, pos_y)<br><br><br><span class="hljs-comment"># refer to docx.text.run.add_picture</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_float_picture</span>(<span class="hljs-params">p, image_path_or_stream, width=<span class="hljs-literal">None</span>, height=<span class="hljs-literal">None</span>, pos_x=<span class="hljs-number">0</span>, pos_y=<span class="hljs-number">0</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Add float picture at fixed position `pos_x` and `pos_y` to the top-left point of page.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    run = p.add_run()<br>    anchor = new_pic_anchor(run.part, image_path_or_stream, width, height, pos_x, pos_y)<br>    run._r.add_drawing(anchor)<br><br><br><span class="hljs-comment"># refer to docx.oxml.__init__.py</span><br>register_element_cls(<span class="hljs-string">&#x27;wp:anchor&#x27;</span>, CT_Anchor)<br><br></code></pre></td></tr></table></figure><h2 id="mssqlæ•°æ®åº“æ“ä½œ"><a class="markdownIt-Anchor" href="#mssqlæ•°æ®åº“æ“ä½œ"></a> mssqlï¼ˆæ•°æ®åº“æ“ä½œï¼‰</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pymssql<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">connectMSsql</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è¿æ¥æ•°æ®åº“</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;host&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;port&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;username&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;password&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;database_name&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;ç¼ºå°‘å‚æ•°&#x27;</span>)<br>        host = params.get(<span class="hljs-string">&#x27;host&#x27;</span>)<br>        port = params.get(<span class="hljs-string">&#x27;port&#x27;</span>)  <span class="hljs-comment"># ç«¯å£è¿™é‡Œé»˜è®¤æ˜¯1433</span><br>        <span class="hljs-keyword">try</span>:<br>            port = <span class="hljs-built_in">int</span>(port)<br>        <span class="hljs-keyword">except</span> Exception:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ç«¯å£ä¿¡æ¯é”™è¯¯&quot;</span><br>        username = params.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>        password = params.get(<span class="hljs-string">&#x27;password&#x27;</span>)<br>        database_name = params.get(<span class="hljs-string">&#x27;database_name&#x27;</span>)<br>        encoding = params.get(<span class="hljs-string">&#x27;encoding&#x27;</span>)<br>        conn = pymssql.connect(host=host,port=port, user=username, password=password, database=database_name,charset=encoding)<br>        <span class="hljs-keyword">return</span> conn<br>    <span class="hljs-keyword">except</span> pymssql._pymssql.OperationalError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ•°æ®åº“è¿æ¥è¶…æ—¶&quot;</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">raise</span> e<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">executeSQL</span>(<span class="hljs-params">conn,sql</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    æ‰§è¡ŒSQLè¯­å¥,select ,update,insert</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        cursor = conn.cursor()<br>        <span class="hljs-keyword">if</span> sql.startswith(<span class="hljs-string">&quot;select&quot;</span>) <span class="hljs-keyword">or</span> sql.startswith(<span class="hljs-string">&quot;SELECT&quot;</span>):<br>            cursor.execute(sql)<br>            result = cursor.fetchall()<br>            <span class="hljs-keyword">return</span> result<br>        <span class="hljs-keyword">elif</span> sql.startswith(<span class="hljs-string">&quot;update&quot;</span>) <span class="hljs-keyword">or</span> sql.startswith(<span class="hljs-string">&quot;UPDATE&quot;</span>):<br>            cursor.execute(sql)<br>            conn.commit()<br>            <span class="hljs-keyword">return</span> &#123;&#125;<br>        <span class="hljs-keyword">elif</span> sql.startswith(<span class="hljs-string">&quot;insert&quot;</span>) <span class="hljs-keyword">or</span> sql.startswith(<span class="hljs-string">&quot;INSERT&quot;</span>):<br>            cursor.execute(sql)<br>            conn.commit()<br>            <span class="hljs-keyword">return</span> &#123;&#125;<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> &#123;&#125;<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">raise</span> e<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">closeConn</span>(<span class="hljs-params">conn</span>):<br>    conn.close()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure><h2 id="mainæ–‡ä»¶"><a class="markdownIt-Anchor" href="#mainæ–‡ä»¶"></a> mainæ–‡ä»¶</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> docx <span class="hljs-keyword">import</span> Document<br><span class="hljs-keyword">from</span> docx.oxml.ns <span class="hljs-keyword">import</span> qn<br><span class="hljs-keyword">from</span> docx.shared <span class="hljs-keyword">import</span> Pt,Cm,RGBColor<br><span class="hljs-keyword">from</span> docx.enum.text <span class="hljs-keyword">import</span> WD_ALIGN_PARAGRAPH,WD_PARAGRAPH_ALIGNMENT<br><span class="hljs-keyword">from</span> docx.enum.table <span class="hljs-keyword">import</span> WD_ALIGN_VERTICAL<br><span class="hljs-keyword">from</span> docx.enum.text <span class="hljs-keyword">import</span> WD_UNDERLINE<br><span class="hljs-keyword">from</span> docx <span class="hljs-keyword">import</span> shared<br><span class="hljs-keyword">from</span> docx.enum.section <span class="hljs-keyword">import</span> WD_ORIENT<br><span class="hljs-keyword">from</span> docx.enum.text <span class="hljs-keyword">import</span> WD_TAB_ALIGNMENT <br><span class="hljs-keyword">from</span> add_float_picture <span class="hljs-keyword">import</span> add_float_picture<br><span class="hljs-keyword">from</span> extract_content_from_docx <span class="hljs-keyword">import</span> extract_content_from_docx<br><span class="hljs-keyword">from</span> docx.enum.style <span class="hljs-keyword">import</span> WD_STYLE_TYPE<br><span class="hljs-keyword">from</span> docx.oxml <span class="hljs-keyword">import</span> OxmlElement<br><span class="hljs-keyword">from</span> docx.oxml <span class="hljs-keyword">import</span> parse_xml<br><span class="hljs-keyword">from</span> docx.oxml.ns <span class="hljs-keyword">import</span> nsdecls<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> mssql <span class="hljs-keyword">import</span> closeConn, connectMSsql, executeSQL<br><span class="hljs-keyword">from</span> loguru <span class="hljs-keyword">import</span> logger<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># åˆ›å»ºæ—¥å¿—å¯¹è±¡</span><br>FileLog = <span class="hljs-string">&#x27;log&#123;&#125;.log&#x27;</span>.<span class="hljs-built_in">format</span>(datetime.date.today())<br>logger.add(FileLog,rotation=<span class="hljs-string">&quot;500MB&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>, enqueue=<span class="hljs-literal">True</span>)<br><br><span class="hljs-comment"># é¦–é¡µ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">P0Content</span>(<span class="hljs-params">num,date</span>):<br>    content1 = document.add_paragraph(<span class="hljs-string">&#x27;\n\n\n\n\n\n\n\n\n\n\n&#x27;</span>)<br>    content1Run = content1.add_run(<span class="hljs-string">&#x27;å…¬ å¸ ç» è¥ æƒ… å†µ å‘¨ æŠ¥\n&#x27;</span>)<br>    content1Run.font.name = <span class="hljs-string">&#x27;å½©è™¹å°æ ‡å®‹&#x27;</span><br>    content1Run._element.rPr.rFonts.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;w:eastAsia&#x27;</span>),<span class="hljs-string">&#x27;å½©è™¹å°æ ‡å®‹&#x27;</span>)<br>    content1Run.font.size = Pt(<span class="hljs-number">22</span>)<br>    content1Run.bold = <span class="hljs-literal">True</span><br>    content1.paragraph_format.alignment = WD_ALIGN_PARAGRAPH.CENTER<br>    add_float_picture(content1,<span class="hljs-string">&#x27;D:/workspace/weeklyNewspaper/img/P1_logo.png&#x27;</span>,height=shared.Cm(<span class="hljs-number">2.3</span>),pos_x=shared.Cm(<span class="hljs-number">3.17</span>),pos_y=shared.Cm(<span class="hljs-number">4.5</span>))<br>    add_float_picture(content1,<span class="hljs-string">&#x27;D:/workspace/weeklyNewspaper/img/P1_banner1.png&#x27;</span>,height=shared.Cm(<span class="hljs-number">6.11</span>),pos_x=shared.Cm(-<span class="hljs-number">3.23</span>),pos_y=shared.Cm(<span class="hljs-number">8</span>))<br>    numPara = document.add_paragraph(<span class="hljs-string">&#x27;ç¬¬&#123;&#125;æœŸï¼ˆ&#123;&#125;ï¼‰&#x27;</span>.<span class="hljs-built_in">format</span>(num,date))<br>    numPara.paragraph_format.alignment = WD_ALIGN_PARAGRAPH.CENTER<br><br><span class="hljs-comment"># ä¸€çº§æ ‡é¢˜</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">L1</span>(<span class="hljs-params">content</span>):<br>    head1 = document.add_heading(<span class="hljs-string">&#x27;&#x27;</span>, level = <span class="hljs-number">1</span>)<br>    head1.add_run(content)<br><span class="hljs-comment"># äºŒçº§æ ‡é¢˜</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">L2</span>(<span class="hljs-params">content</span>):<br>    head2 =document.add_heading(<span class="hljs-string">&#x27;&#x27;</span>,level = <span class="hljs-number">2</span>)<br>    head2.add_run(content)<br><span class="hljs-comment"># æ­£æ–‡</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">L0</span>(<span class="hljs-params">content</span>):<br>    <span class="hljs-comment"># å»é™¤æ®µè½ä¸­å•ç‹¬çš„ç©ºç™½è¡Œ</span><br>    lines = content.split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    new_lines = [line <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines <span class="hljs-keyword">if</span> line.strip()!=<span class="hljs-string">&#x27;&#x27;</span>]<br>    <span class="hljs-comment"># æ·»åŠ æ®µè½</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> new_lines:<br>        par = document.add_paragraph(i)<br>        par.paragraph_format.first_line_indent = Pt(<span class="hljs-number">28</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_table_boarder</span>(<span class="hljs-params">table,**kwargs</span>):<br>    borders = OxmlElement(<span class="hljs-string">&#x27;w:tblBorders&#x27;</span>)<br>    <span class="hljs-keyword">for</span> tag <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;bottom&#x27;</span>,<span class="hljs-string">&#x27;top&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>,<span class="hljs-string">&#x27;right&#x27;</span>,<span class="hljs-string">&#x27;insideV&#x27;</span>,<span class="hljs-string">&#x27;insideH&#x27;</span>):<br>        edge_data = kwargs.get(tag)<br>        <span class="hljs-keyword">if</span> edge_data:<br>            any_border = OxmlElement(<span class="hljs-string">f&#x27;w:<span class="hljs-subst">&#123;tag&#125;</span>&#x27;</span>)<br>            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;sz&#x27;</span>,<span class="hljs-string">&#x27;val&#x27;</span>,<span class="hljs-string">&#x27;color&#x27;</span>,<span class="hljs-string">&#x27;space&#x27;</span>,<span class="hljs-string">&#x27;shadow&#x27;</span>]:<br>                <span class="hljs-keyword">if</span> key <span class="hljs-keyword">in</span> edge_data:<br>                    any_border.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">f&#x27;w:<span class="hljs-subst">&#123;key&#125;</span>&#x27;</span>),<span class="hljs-built_in">str</span>(edge_data[key]))<br>            borders.append(any_border)<br>            table._tbl.tblPr.append(borders)<br><br><br><span class="hljs-comment"># æ’å…¥è¡¨æ ¼</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">insertTable</span>(<span class="hljs-params">row,col</span>):<br>    table = document.add_table(row,col)<br>    set_table_boarder(table,<br>    top = &#123;<span class="hljs-string">&#x27;sz&#x27;</span>:<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;val&#x27;</span>:<span class="hljs-string">&#x27;single&#x27;</span>,<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#000000&#x27;</span>&#125;,<br>    bottom = &#123;<span class="hljs-string">&#x27;sz&#x27;</span>:<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;val&#x27;</span>:<span class="hljs-string">&#x27;single&#x27;</span>,<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#000000&#x27;</span>&#125;,<br>    left = &#123;<span class="hljs-string">&#x27;sz&#x27;</span>:<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;val&#x27;</span>:<span class="hljs-string">&#x27;single&#x27;</span>,<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#000000&#x27;</span>&#125;,<br>    right = &#123;<span class="hljs-string">&#x27;sz&#x27;</span>:<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;val&#x27;</span>:<span class="hljs-string">&#x27;single&#x27;</span>,<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#000000&#x27;</span>&#125;,<br>    insideV = &#123;<span class="hljs-string">&#x27;sz&#x27;</span>:<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;val&#x27;</span>:<span class="hljs-string">&#x27;single&#x27;</span>,<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#000000&#x27;</span>&#125;,<br>    insideH = &#123;<span class="hljs-string">&#x27;sz&#x27;</span>:<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;val&#x27;</span>:<span class="hljs-string">&#x27;single&#x27;</span>,<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#000000&#x27;</span>&#125;)<br>    <span class="hljs-keyword">return</span> table<br><span class="hljs-comment"># é¡µç è§„åˆ™</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">AddFooterNumber</span>(<span class="hljs-params">run</span>):<br>    fldChar1 = OxmlElement(<span class="hljs-string">&#x27;w:fldChar&#x27;</span>)  <span class="hljs-comment"># creates a new element</span><br>    fldChar1.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;w:fldCharType&#x27;</span>), <span class="hljs-string">&#x27;begin&#x27;</span>)  <span class="hljs-comment"># sets attribute on element</span><br>    instrText = OxmlElement(<span class="hljs-string">&#x27;w:instrText&#x27;</span>)<br>    instrText.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;xml:space&#x27;</span>), <span class="hljs-string">&#x27;preserve&#x27;</span>)  <span class="hljs-comment"># sets attribute on element</span><br>    instrText.text = <span class="hljs-string">&#x27;Page&#x27;</span><br>    fldChar2 = OxmlElement(<span class="hljs-string">&#x27;w:fldChar&#x27;</span>)<br>    fldChar2.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;w:fldCharType&#x27;</span>), <span class="hljs-string">&#x27;separate&#x27;</span>)<br>    t = OxmlElement(<span class="hljs-string">&#x27;w:t&#x27;</span>)<br>    t.text = <span class="hljs-string">&quot;Seq&quot;</span><br>    fldChar2.append(t)<br>    fldChar4 = OxmlElement(<span class="hljs-string">&#x27;w:fldChar&#x27;</span>)<br>    fldChar4.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;w:fldCharType&#x27;</span>), <span class="hljs-string">&#x27;end&#x27;</span>)<br>    r_element = run._r<br>    r_element.append(fldChar1)<br>    r_element.append(instrText)<br>    r_element.append(fldChar2)<br>    r_element.append(fldChar4)<br><span class="hljs-comment"># æ’å…¥é¡µç å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">InsertPageNumber</span>(<span class="hljs-params">footer</span>):<br><span class="hljs-comment">#   footer = Doc.sections[1].footer # è·å–ç¬¬ä¸€ä¸ªèŠ‚çš„é¡µè„š</span><br>    footer.is_linked_to_previous = <span class="hljs-literal">True</span>  <span class="hljs-comment">#ç¼–å·ç»­å‰ä¸€èŠ‚</span><br>    paragraph = footer.paragraphs[<span class="hljs-number">0</span>] <span class="hljs-comment"># è·å–é¡µè„šçš„ç¬¬ä¸€ä¸ªæ®µè½</span><br>    paragraph.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER<span class="hljs-comment">#é¡µè„šå±…ä¸­å¯¹é½</span><br>    run_footer=paragraph.add_run() <span class="hljs-comment"># æ·»åŠ é¡µè„šå†…å®¹</span><br>    AddFooterNumber(run_footer)<br>    font = run_footer.font<br>    font.name = <span class="hljs-string">&#x27;Times New Roman&#x27;</span><span class="hljs-comment">#æ–°ç½—é©¬å­—ä½“</span><br>    font.size = Pt(<span class="hljs-number">10</span>) <span class="hljs-comment">#10å·å­—ä½“</span><br>    font.bold = <span class="hljs-literal">True</span> <span class="hljs-comment">#åŠ ç²—</span><br><br><span class="hljs-comment"># è®¾ç½®é¦–é¡µé¡µçœ‰ã€é¡µè„šã€é¡µè¾¹è·</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">headerParagraphs0</span>(<span class="hljs-params">hNum,hDate</span>):<br>    <span class="hljs-comment"># è®¾ç½®é¡µè¾¹è·</span><br>    document.sections[<span class="hljs-number">0</span>].top_margin = Cm(<span class="hljs-number">2.54</span>)<br>    document.sections[<span class="hljs-number">0</span>].bottom_margin = Cm(<span class="hljs-number">2.54</span>)<br>    document.sections[<span class="hljs-number">0</span>].left_margin = Cm(<span class="hljs-number">3.17</span>)<br>    document.sections[<span class="hljs-number">0</span>].rigth_margin = Cm(<span class="hljs-number">3</span>)<br>    <span class="hljs-comment"># è®¾ç½®ç¬¬ä¸€èŠ‚é¡µè„š</span><br>    run0 = document.sections[<span class="hljs-number">0</span>].footer.paragraphs[<span class="hljs-number">0</span>]<br>    run0Style = run0.add_run(<span class="hljs-string">&#x27;æ³¨ï¼šèµ„äº§å¤„ç½®æ€»éƒ¨çš„å‘¨æŠ¥ç›¸å…³å†…å®¹ç”±èµ„äº§å¤„ç½®æ€»éƒ¨å¦è¡Œæ¯å‘¨æŠ¥é€ã€‚&#x27;</span>)<br>    run0Style.font.name = <span class="hljs-string">&#x27;å½©è™¹ç²—ä»¿å®‹&#x27;</span><br>    run0Style._element.rPr.rFonts.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;w:eastAsia&#x27;</span>),<span class="hljs-string">&#x27;å½©è™¹ç²—ä»¿å®‹&#x27;</span>)<br>    run0Style.font.size = Pt(<span class="hljs-number">10.5</span>)<br><br><span class="hljs-comment"># å¤„ç†ç¬¬äºŒèŠ‚é¡µçœ‰é¡µè„š</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">headerParagraphs1</span>(<span class="hljs-params">hNum,hDate</span>):<br>    document.add_section() <span class="hljs-comment"># æ·»åŠ ç¬¬2èŠ‚</span><br>    <span class="hljs-comment"># è®¾ç½®é¡µè¾¹è·</span><br>    document.sections[<span class="hljs-number">1</span>].top_margin = Cm(<span class="hljs-number">2.54</span>)<br>    document.sections[<span class="hljs-number">1</span>].bottom_margin = Cm(<span class="hljs-number">2.54</span>)<br>    document.sections[<span class="hljs-number">1</span>].left_margin = Cm(<span class="hljs-number">3.17</span>)<br>    document.sections[<span class="hljs-number">1</span>].right_margin = Cm(<span class="hljs-number">3</span>)<br>    <span class="hljs-comment"># è®¾ç½®ç¬¬äºŒèŠ‚é¡µçœ‰</span><br>    document.sections[<span class="hljs-number">1</span>].header.is_linked_to_previous = <span class="hljs-literal">False</span><br>    run1 = document.sections[<span class="hljs-number">1</span>].header.paragraphs[<span class="hljs-number">0</span>]<br>    run1Style = run1.add_run(<span class="hljs-string">&#x27;å…¬å¸ç»è¥æƒ…å†µå‘¨æŠ¥[ç¬¬&#123;&#125;æœŸï¼ˆ&#123;&#125;ï¼‰]&#x27;</span>.<span class="hljs-built_in">format</span>(hNum,hDate))<br>    run1Style.font.name = <span class="hljs-string">&#x27;å½©è™¹ç²—ä»¿å®‹&#x27;</span><br>    run1Style._element.rPr.rFonts.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;w:eastAsia&#x27;</span>),<span class="hljs-string">&#x27;å½©è™¹ç²—ä»¿å®‹&#x27;</span>)<br>    run1Style.font.size = Pt(<span class="hljs-number">10.5</span>)<br>    <span class="hljs-comment"># run1Style.add_picture(r&#x27;yemei_logo.png&#x27;,height=shared.Cm(0.82) ,width=shared.Cm(12.19) ) # é¡µçœ‰logo</span><br>    add_float_picture(run1,<span class="hljs-string">&#x27;D:/workspace/weeklyNewspaper/img/yemei_logo.png&#x27;</span>,height=shared.Cm(<span class="hljs-number">0.8</span>),pos_x=shared.Cm(<span class="hljs-number">15.19</span>),pos_y=shared.Cm(<span class="hljs-number">0.95</span>))<br>    run1.paragraph_format.alignment = WD_ALIGN_PARAGRAPH.CENTER<br>    <span class="hljs-comment"># è®¾ç½®ç¬¬äºŒèŠ‚é¡µè„š</span><br>    document.sections[<span class="hljs-number">1</span>].footer.is_linked_to_previous = <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># InsertPageNumber(document.sections[1].footer)</span><br><br><span class="hljs-comment"># å¤„ç†ç¬¬ä¸‰èŠ‚é¡µçœ‰é¡µè„š</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">headerParagraphs2</span>(<span class="hljs-params">hNum,hDate</span>):<br>    document.add_section() <span class="hljs-comment"># æ·»åŠ ç¬¬3èŠ‚</span><br>    document.sections[<span class="hljs-number">2</span>].top_margin = Cm(<span class="hljs-number">3.17</span>)<br>    document.sections[<span class="hljs-number">2</span>].bottom_margin = Cm(<span class="hljs-number">3</span>)<br>    document.sections[<span class="hljs-number">2</span>].left_margin = Cm(<span class="hljs-number">2.54</span>)<br>    document.sections[<span class="hljs-number">2</span>].right_margin = Cm(<span class="hljs-number">2.54</span>)<br>    <span class="hljs-comment"># è®¾ç½®ç¬¬ä¸‰èŠ‚é¡µçœ‰</span><br>    document.sections[<span class="hljs-number">2</span>].header.is_linked_to_previous = <span class="hljs-literal">False</span><br>    run2 = document.sections[<span class="hljs-number">2</span>].header.paragraphs[<span class="hljs-number">0</span>]<br>    run2Style = run2.add_run(<span class="hljs-string">&#x27;\tå…¬å¸ç»è¥æƒ…å†µå‘¨æŠ¥[ç¬¬&#123;&#125;æœŸï¼ˆ&#123;&#125;ï¼‰]\t&#x27;</span>.<span class="hljs-built_in">format</span>(hNum,hDate))<br>    run2Style.font.name = <span class="hljs-string">&#x27;å½©è™¹ç²—ä»¿å®‹&#x27;</span><br>    run2Style._element.rPr.rFonts.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;w:eastAsia&#x27;</span>),<span class="hljs-string">&#x27;å½©è™¹ç²—ä»¿å®‹&#x27;</span>)<br>    run2Style.font.size = Pt(<span class="hljs-number">10.5</span>)<br>    <span class="hljs-comment"># run2Style.add_picture(r&#x27;yemei_logo.png&#x27;,height=shared.Cm(0.82)  ) # é¡µçœ‰logo</span><br>    add_float_picture(run2,<span class="hljs-string">&#x27;D:/workspace/weeklyNewspaper/img/yemei_logo.png&#x27;</span>,height=shared.Cm(<span class="hljs-number">0.8</span>),pos_x=shared.Cm(<span class="hljs-number">20</span>),pos_y=shared.Cm(<span class="hljs-number">0.95</span>))<br>    run2.paragraph_format.alignment = WD_ALIGN_PARAGRAPH.CENTER<br>    <span class="hljs-comment"># run2.runs[0].underline = WD_UNDERLINE.DOUBLE</span><br>    <span class="hljs-comment"># è®¾ç½®ç¬¬ä¸‰èŠ‚é¡µè„š</span><br>    document.sections[<span class="hljs-number">2</span>].footer.is_linked_to_previous = <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># InsertPageNumber(document.sections[2].footer)</span><br><br><span class="hljs-comment"># è®¾ç½®é¡µé¢æ–¹å‘ä¸ºæ¨ªå‘</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PaperOrientation</span>(<span class="hljs-params">num</span>):<br>    section = document.sections[num-<span class="hljs-number">1</span>]<br>    new_width,new_height = section.page_height,section.page_width<br>    section.orientation = WD_ORIENT.LANDSCAPE<br>    section.page_width = new_width<br>    section.page_height = new_height<br><br><span class="hljs-comment"># è®¾ç½®è¡¨æ ¼é¦–è¡Œé‡å¤æ˜¾ç¤º</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Table_Line_Repeat</span>(<span class="hljs-params">doc,firstcell</span>):<br>    <span class="hljs-comment"># é€šè¿‡éå†ä¿®æ”¹æ‰€æœ‰çš„è¡¨æ ¼</span><br>    <span class="hljs-keyword">for</span> table <span class="hljs-keyword">in</span> doc.tables:<br>        <span class="hljs-comment"># é€‰æ‹©è¦é¦–è¡Œé‡å¤çš„è¡¨æ ¼</span><br>        <span class="hljs-keyword">if</span> table.cell(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>).text.strip() == firstcell:<br>            <span class="hljs-comment"># æ‰¾åˆ°è¯¥è¡¨æ ¼çš„ç¬¬ä¸€è¡Œï¼Œå°†å…¶å±æ€§è®¾ä¸ºå¯é‡å¤å‡ºç°åœ¨æ¯é¡µé¡¶ç«¯</span><br>            row = table.rows[<span class="hljs-number">0</span>]<br>            tr = row._element<br>            trPr = tr.get_or_add_trPr()<br>            tblHeader = OxmlElement(<span class="hljs-string">&#x27;w:tblHeader&#x27;</span>)<br>            tblHeader.<span class="hljs-built_in">set</span>(qn(<span class="hljs-string">&#x27;w:val&#x27;</span>), <span class="hljs-string">&quot;true&quot;</span>)<br>            trPr.append(tblHeader)<br>    <span class="hljs-keyword">return</span> doc<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    logger.info(<span class="hljs-string">&#x27;***å¼€å§‹å¤„ç†wordæ–‡æ¡£***&#x27;</span>)<br>    <span class="hljs-comment"># è¿æ¥æ•°æ®åº“ï¼Œè·å–éƒ¨é—¨å‘¨æŠ¥ä¿¡æ¯ã€æœŸå·ã€å‘¨æŠ¥æ—¶é—´</span><br>    sqlConnectParams = &#123;<span class="hljs-string">&quot;database_name&quot;</span>: <span class="hljs-string">&quot;****&quot;</span>, <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;****&quot;</span>, <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;****&quot;</span>, <span class="hljs-string">&quot;host&quot;</span>: <span class="hljs-string">&quot;****&quot;</span>, <span class="hljs-string">&quot;port&quot;</span>: <span class="hljs-string">&quot;****&quot;</span>, <span class="hljs-string">&quot;encoding&quot;</span>: <span class="hljs-string">&quot;cp936&quot;</span>&#125;<br>    deptSqlQuery =  <span class="hljs-string">&quot;select (case when c.xsmc is null then d.departmentmark else c.xsmc end) ,e.gzsxmc,e.bzjzqk,e.xzgzap from formtable_main_246 a left join workflow_requestbase b on a.requestid=b.requestid left join uf_comweeklyorder c on c.bm=a.ngbm left join HrmDepartment d on d.id=a.ngbm left join formtable_main_246_dt1 e on e.mainid=a.id where b.currentnodetype=3 and c.bm is not null and b.createdate&gt;=CONVERT ( CHAR ( 10 ), getdate()-5, 120 ) order by c.scsx,e.id&quot;</span> <span class="hljs-comment"># å½“å‰æ—¥æœŸ-5</span><br>    numSqlQuery = <span class="hljs-string">&quot;select top 1 num,replace(createdate,&#x27;-&#x27;,&#x27;&#x27;) from uf_comweeklyset where isnull(flag,1)!=0 order by num &quot;</span><br>    conn = connectMSsql(sqlConnectParams)<br>    logger.info(<span class="hljs-string">&#x27;***å·²è¿æ¥æ•°æ®åº“***&#x27;</span>)<br>    lista = executeSQL(conn,deptSqlQuery)<br>    numdetail =executeSQL(conn,numSqlQuery)<br>    logger.info(<span class="hljs-string">&#x27;***å·²è·å–èŒèƒ½éƒ¨é—¨å‘¨æŠ¥æ¸…å•***&#x27;</span>)<br>    <span class="hljs-comment">#ç¬¬å‡ æœŸ</span><br>    num = numdetail[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    <span class="hljs-comment"># å‘¨æŠ¥æ—¶é—´ æ ¼å¼yyyymmdd</span><br>    date = numdetail[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]<br>    logger.info(<span class="hljs-string">&#x27;***å·²è·å–æ­¤æ¬¡å‘¨æŠ¥æœŸå·åŠç”Ÿæˆæ—¥æœŸ***&#x27;</span>)<br>    <span class="hljs-comment"># å£°æ˜å¾…å¤„ç†æ–‡ä»¶å¤¹</span><br>    path = <span class="hljs-string">&#x27;D:/aidownload/gongsizhoubao/&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(datetime.datetime.today().date())<br>    <span class="hljs-comment"># è°ƒç”¨wordæ¨¡æ¿</span><br>    document = Document(<span class="hljs-string">&#x27;D:/workspace/weeklyNewspaper/module.docx&#x27;</span>) <br>    logger.info(<span class="hljs-string">&#x27;***wordæ¨¡æ¿è°ƒç”¨å®Œæˆ***&#x27;</span>)<br>    <span class="hljs-comment"># è®¾ç½®ç¬¬ä¸€èŠ‚ï¼ˆé¦–é¡µï¼‰é¡µçœ‰ã€é¡µè„šã€é¡µè¾¹è·</span><br>    headerParagraphs0(num,date) <span class="hljs-comment"># é¡µçœ‰é¡µè„š</span><br>    <span class="hljs-comment">#ç”Ÿæˆé¦–é¡µå†…å®¹</span><br>    P0Content(num,date) <br>    logger.info(<span class="hljs-string">&#x27;***ç¬¬ä¸€èŠ‚å¤„ç†å®Œæˆ***&#x27;</span>)<br>    <span class="hljs-comment"># ç¬¬äºŒèŠ‚é¡µçœ‰é¡µè„š</span><br>    headerParagraphs1(num,date)<br>    <span class="hljs-comment"># ç¬¬äºŒèŠ‚å†…å®¹ï¼Œéå†æ–‡ä»¶å¤¹ä¸‹çš„å¾…åˆå¹¶wordæ–‡æ¡£ï¼Œé€’å½’æå–æ®µè½å’Œè¡¨æ ¼ï¼Œå¹¶æ ¹æ®æ®µè½æ ·å¼ã€è¡¨æ ¼å†…å®¹ç”Ÿæˆæœ€ç»ˆçš„åˆå¹¶æ–‡æ¡£ã€‚</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> os.listdir(path):<br>        logger.info(<span class="hljs-string">&#x27;***å¼€å§‹å¤„ç†ï¼š&#123;&#125;***&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>        document_content = extract_content_from_docx(path+<span class="hljs-string">&#x27;/&#x27;</span>+i)<br>        <span class="hljs-keyword">for</span> category,level, data <span class="hljs-keyword">in</span> document_content:<br>            <span class="hljs-keyword">if</span> category == <span class="hljs-string">&#x27;paragraph&#x27;</span>:<br>                <span class="hljs-keyword">if</span> level == <span class="hljs-string">&#x27;L0&#x27;</span>:<br>                    L0(data)<br>                <span class="hljs-keyword">elif</span> level == <span class="hljs-string">&#x27;L1&#x27;</span>:<br>                    L1(data)<br>                <span class="hljs-keyword">elif</span> level == <span class="hljs-string">&#x27;L2&#x27;</span>:<br>                    L2(data)<br>            <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&#x27;table&#x27;</span>:<br>                table = insertTable(<span class="hljs-built_in">len</span>(data),<span class="hljs-built_in">len</span>(data[<span class="hljs-number">0</span>]))<br>                <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(data)):<br>                    <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(data[row])):<br>                        run = table.cell(row,cell).paragraphs[<span class="hljs-number">0</span>].add_run(data[row][cell])<br>                        run.font.size = Pt(<span class="hljs-number">12</span>) <span class="hljs-comment"># å­—ä½“å¤§å°ä¸ºï¼šå°å››</span><br>                        <span class="hljs-comment"># é¦–è¡Œå±…ä¸­</span><br>                        <span class="hljs-keyword">if</span> row == <span class="hljs-number">0</span> :<br>                            run.bold = <span class="hljs-literal">True</span> <span class="hljs-comment"># é¦–è¡ŒåŠ ç²—</span><br>                            table.cell(row,cell).paragraphs[<span class="hljs-number">0</span>].alignment = WD_PARAGRAPH_ALIGNMENT.CENTER<br>                        <span class="hljs-keyword">else</span>:<br>                            table.cell(row,cell).paragraphs[<span class="hljs-number">0</span>].alignment = WD_PARAGRAPH_ALIGNMENT.LEFT<br>                            table.cell(row,cell).vertical_alignment = WD_ALIGN_VERTICAL.CENTER<br>    logger.info(<span class="hljs-string">&#x27;***ç¬¬äºŒèŠ‚å¤„ç†å®Œæˆ***&#x27;</span>)<br>    <span class="hljs-comment"># ç¬¬ä¸‰èŠ‚é¡µçœ‰ã€é¡µè„šã€é¡µé¢æ–¹å‘</span><br>    headerParagraphs2(num,date)<br>    PaperOrientation(<span class="hljs-number">3</span>)<br>    <span class="hljs-comment"># ç¬¬ä¸‰èŠ‚å†…å®¹</span><br>    L1(<span class="hljs-string">&#x27;èŒèƒ½éƒ¨é—¨&#x27;</span>)<br>    table = insertTable(<span class="hljs-built_in">len</span>(lista)+<span class="hljs-number">1</span>,<span class="hljs-number">4</span>)<br>    <span class="hljs-comment"># å¤„ç†æŸ¥è¯¢å‡ºçš„listä¿¡æ¯ï¼Œå»é™¤&lt;br&gt;ï¼Œæ·»åŠ è¡¨å¤´</span><br>    listb = [[<span class="hljs-string">&#x27;å¡«æŠ¥éƒ¨é—¨&#x27;</span>,<span class="hljs-string">&#x27;å·¥ä½œäº‹é¡¹åç§°&#x27;</span>,<span class="hljs-string">&#x27;æœ¬å‘¨è¿›å±•æƒ…å†µ&#x27;</span>,<span class="hljs-string">&#x27;ä¸‹å‘¨å·¥ä½œå®‰æ’&#x27;</span>]]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lista:<br>        listc = []<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i :<br>            b = j.replace(<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>,<span class="hljs-string">&#x27;\n&#x27;</span>)<br>            listc.append(b)<br>        listb.append(listc)<br>    <span class="hljs-comment"># æ ¹æ®æå–çš„list,åˆ¤æ–­ç¬¬ä¸€åˆ—æ˜¯å¦æœ‰éœ€è¦åˆå¹¶çš„å•å…ƒæ ¼ï¼Œè‹¥æœ‰ï¼Œåˆ™åˆå¹¶ï¼Œä¸”å°†é‡å¤å€¼çš„å•å…ƒæ ¼èµ‹ä¸ºç©º</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(listb)-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(listb)):<br>            <span class="hljs-keyword">if</span> listb[i][<span class="hljs-number">0</span>] == listb[j][<span class="hljs-number">0</span>]:<br>                listb[j][<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;&#x27;</span><br>                table.cell(i,<span class="hljs-number">0</span>).merge(table.cell(j,<span class="hljs-number">0</span>))<br>    <span class="hljs-comment"># åˆ—å®½è®¾ç½®</span><br>    <span class="hljs-keyword">for</span> rowa <span class="hljs-keyword">in</span> table.rows:<br>        rowa.cells[<span class="hljs-number">0</span>].width = Cm(<span class="hljs-number">2.55</span>)<br>        rowa.cells[<span class="hljs-number">1</span>].width = Cm(<span class="hljs-number">3</span>)<br>        rowa.cells[<span class="hljs-number">2</span>].width = Cm(<span class="hljs-number">9.94</span>)<br>        rowa.cells[<span class="hljs-number">3</span>].width = Cm(<span class="hljs-number">9.71</span>)<br>    <span class="hljs-comment"># listå†…å®¹å¡«å……åŠæ ·å¼è°ƒæ•´</span><br>    <span class="hljs-keyword">for</span> i,row <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(table.rows):<br>        <span class="hljs-keyword">for</span> j,cell <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(row.cells):<br>            <span class="hljs-keyword">if</span> listb[i][j] != <span class="hljs-string">&#x27;&#x27;</span>:<br>                <span class="hljs-comment"># å¥å°¾ä¸æ¶‰åŠåˆ†å·ã€å¥å·ã€å†’å·ï¼Œå¢åŠ å¥å·</span><br>                <span class="hljs-keyword">if</span> i!=<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> j&gt;<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> listb[i][j][-<span class="hljs-number">1</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;;&#x27;</span>,<span class="hljs-string">&#x27;ã€‚&#x27;</span>,<span class="hljs-string">&#x27;ï¼š&#x27;</span>]:<br>                    listb[i][j] = listb[i][j]+<span class="hljs-string">&#x27;ã€‚&#x27;</span><br>                <span class="hljs-comment"># \nå‰ä¸æ¶‰åŠåˆ†å·ã€å¥å·ã€å†’å·ï¼Œå¢åŠ å¥å·</span><br>                listb[i][j] = re.sub(<span class="hljs-string">r&#x27;(?&lt;![ï¼›ã€‚ï¼š])\n&#x27;</span>,<span class="hljs-string">&#x27;ã€‚\n&#x27;</span>,listb[i][j])<br>                <span class="hljs-comment"># å¥é¦–é¦–å­—æ¯æ˜¯æ•°å­—ï¼Œä¸”ç¬¬äºŒä¸ªå­—ç¬¦ä¸æ˜¯æ•°å­—æ—¶ï¼Œæ•°å­—åå¢åŠ ç¬¦å·ï¼š.</span><br>                listb[i][j] = re.sub(<span class="hljs-string">r&#x27;\n(\d)(?!\d)&#x27;</span>,<span class="hljs-string">r&#x27;\n\1.&#x27;</span>,listb[i][j])<br>                <span class="hljs-comment"># å¥é¦–é¦–å­—æ¯æ˜¯æ•°å­—ï¼Œå¢åŠ ç¬¦å·â€œ.â€ä¹‹ååˆ é™¤æ‰åé¢çš„ç©ºæ ¼ã€å¥å·ã€å†’å·å’Œç‚¹</span><br>                listb[i][j] = re.sub(<span class="hljs-string">r&#x27;(?&lt;=\n(\d\.))[ ï¼Œã€‚ã€.]&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,listb[i][j])<br>                table.cell(i,j).text = listb[i][j] <span class="hljs-comment"># å‘¨æŠ¥å†…å®¹å¡«å……</span><br>            <span class="hljs-keyword">try</span> :<br>                cell.paragraphs[<span class="hljs-number">0</span>].runs[<span class="hljs-number">0</span>].font.size = Pt(<span class="hljs-number">11</span>)<br>            <span class="hljs-keyword">except</span> IndexError <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">pass</span><br>            <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>                cell.paragraphs[<span class="hljs-number">0</span>].runs[<span class="hljs-number">0</span>].bold = <span class="hljs-literal">True</span><br>                cell.paragraphs[<span class="hljs-number">0</span>].alignment = WD_PARAGRAPH_ALIGNMENT.CENTER <span class="hljs-comment"># æ°´å¹³å±…ä¸­</span><br>            <span class="hljs-keyword">else</span> :<br>                cell.paragraphs[<span class="hljs-number">0</span>].alignment = WD_PARAGRAPH_ALIGNMENT.LEFT <span class="hljs-comment">#æ°´å¹³é å·¦</span><br>                cell.vertical_alignment = WD_ALIGN_VERTICAL.CENTER<br>    <br>    InsertPageNumber(document.sections[<span class="hljs-number">2</span>].footer)<br>    <span class="hljs-comment"># ç¬¬ä¸‰èŠ‚è¡¨æ ¼é¦–è¡Œé‡å¤æ˜¾ç¤º</span><br>    Table_Line_Repeat(document,<span class="hljs-string">&quot;å¡«æŠ¥éƒ¨é—¨&quot;</span>)<br>    document.save(<span class="hljs-string">&#x27;&#123;&#125;/å…¬å¸å‘¨æŠ¥&#123;&#125;.docx&#x27;</span>.<span class="hljs-built_in">format</span>(path,datetime.datetime.today().date()))<br>    logger.info(<span class="hljs-string">&#x27;***ç¬¬ä¸‰èŠ‚å¤„ç†å®Œæˆ***&#x27;</span>)<br>    <span class="hljs-comment"># å¤„ç†ç»“æŸï¼Œæ›´æ–°ç”ŸæˆçŠ¶æ€ï¼Œå…³é—­æ•°æ®åº“è¿æ¥</span><br>    numSqlUpdate = <span class="hljs-string">&quot;update uf_comweeklyset set flag=0,ts=&#123;&#125; where num=&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(date,num)<br>    executeSQL(conn,numSqlUpdate)<br>    closeConn(conn)<br>    logger.info(<span class="hljs-string">&#x27;***å¤„ç†ç»“æŸï¼Œæ›´æ–°å¤„ç†çŠ¶æ€***&#x27;</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>docx</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>docx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UiAuto|æ³›å¾®Ecologyç³»ç»Ÿé™„ä»¶ä¸‹è½½æ’ä»¶</title>
    <link href="/2023/06/21/UiAuto_ecologyFileDownload/"/>
    <url>/2023/06/21/UiAuto_ecologyFileDownload/</url>
    
    <content type="html"><![CDATA[<p>â€ƒâ€ƒåœ¨ã€Š<a href="https://hncd1024.github.io/2023/06/02/UiAuto_ecologyFileUpload/">UiAuto|æ³›å¾®Ecologyç³»ç»Ÿé™„ä»¶ä¸Šä¼ æ’ä»¶</a>ã€‹ä¸­æˆ‘æ›¾å†™è¿‡ä¸Šä¼ é™„ä»¶åˆ°å…¬å¸å†…ç½‘é—¨æˆ·ç³»ç»Ÿï¼ˆæ³›å¾®Ecologyï¼‰çš„æ’ä»¶ã€‚æ­¤æ¬¡åœ¨å¤„ç†å¦ä¸€ä¸ªéœ€æ±‚çš„æ—¶å€™éœ€è¦ä»ç³»ç»Ÿä¸­ä¸‹è½½é™„ä»¶åˆ°æœ¬åœ°ï¼Œå½“ç„¶å¯¹äºæ•°å­—å‘˜å·¥çš„åœºæ™¯å¼€å‘ï¼Œæˆ‘è¿˜æ˜¯æœŸæœ›å°½å¯èƒ½çš„ä¸é€šè¿‡RPAå®ç°ï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ä¸ªæ’ä»¶ï¼Œé€šè¿‡è°ƒç”¨ç³»ç»Ÿæ¥å£çš„æ–¹å¼å®ç°æ–‡ä»¶çš„ä¸‹è½½ã€‚æ’ä»¶æºç å¦‚ä¸‹ï¼š</p><h1 id="packagejson"><a class="markdownIt-Anchor" href="#packagejson"></a> package.json</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjtEcologyFileDownload&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjfwfiledownload&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ³›å¾®ecology9ç³»ç»Ÿæ¥å£å¯¹æ¥åŠŸèƒ½&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chendi&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;python&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Official&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;index.py&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;uiauto_config&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;attribution_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file_operation&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;attribution_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶å¤„ç†&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;operations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ecology&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ecology&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;downloadToEcology&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é™„ä»¶ä¸‹è½½&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;downloadToEcology&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Convention&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;urlip&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ³›å¾®ç³»ç»ŸIP&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pcip&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æœ¬æœºIP&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;userName&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç™»é™†ç”¨æˆ·&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pwd&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç™»é™†å¯†ç &quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;password&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;docid&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶ID&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filename&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é™„ä»¶åï¼ˆå«åç¼€ï¼‰&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶è·¯å¾„&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;options&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;select_type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;openDirectory&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶ä¸‹è½½ç»“æœ&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br><br></code></pre></td></tr></table></figure><h1 id="indexpy"><a class="markdownIt-Anchor" href="#indexpy"></a> <a href="http://index.py">index.py</a></h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding:utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@description: ä»æ³›å¾®Ecology9ç³»ç»Ÿä¸­ä¸‹è½½é™„ä»¶</span><br><span class="hljs-string">@Time    :    2023-06-20</span><br><span class="hljs-string">@Author  :    CHENDI</span><br><span class="hljs-string">@Version :    1.0.0</span><br><span class="hljs-string">@Contact ï¼š   henanchendi@163.com</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> suds.client <span class="hljs-keyword">import</span> Client<br><span class="hljs-keyword">from</span> suds.xsd.doctor <span class="hljs-keyword">import</span> ImportDoctor, Import<br><br><br><span class="hljs-comment"># æ ¹æ®å…³é”®å­—æ£€ç´¢wordå†…å®¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">downloadToEcology</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-comment"># è·å–å‚æ•°</span><br>    urlip = params.get(<span class="hljs-string">&#x27;urlip&#x27;</span>)<br>    pcip = params.get(<span class="hljs-string">&#x27;pcip&#x27;</span>)<br>    userName = params.get(<span class="hljs-string">&#x27;userName&#x27;</span>)<br>    pwd = params.get(<span class="hljs-string">&#x27;pwd&#x27;</span>)<br>    filename = params.get(<span class="hljs-string">&#x27;filename&#x27;</span>)<br>    path = params.get(<span class="hljs-string">&#x27;path&#x27;</span>)<br>    docid = params.get(<span class="hljs-string">&#x27;docid&#x27;</span>)<br><br>    <span class="hljs-comment"># è®¿é—®æ¥å£ï¼Œè·å–session</span><br>    imp = Import(<span class="hljs-string">&#x27;http://localhost/services/DocService&#x27;</span>)<br>    doctor = ImportDoctor(imp)<br>    url = <span class="hljs-string">&#x27;http://&#123;&#125;/services/DocService?wsdl&#x27;</span>.<span class="hljs-built_in">format</span>(urlip)<br>    client = Client(url,doctor=doctor)<br>    <span class="hljs-comment"># è·å–session</span><br>    result = client.service.login(userName,pwd,<span class="hljs-number">0</span>,pcip)<br><br>    <span class="hljs-comment"># è·å–æ–‡ä»¶ä¿¡æ¯</span><br>    ArrayOfDocAttachment = client.factory.create(<span class="hljs-string">&#x27;ns2:ArrayOfDocAttachment&#x27;</span>)<br>    docinfo = client.factory.create(<span class="hljs-string">&#x27;ns2:DocInfo&#x27;</span>)<br>    DocAttach = client.factory.create(<span class="hljs-string">&#x27;ns2:DocAttachment&#x27;</span>)<br>    getdoc = client.service.getDoc(docid,result)<br>    docinfo = getdoc<br>    ArrayOfDocAttachment = docinfo.attachments.DocAttachment<br>    DocAttach=ArrayOfDocAttachment[<span class="hljs-number">0</span>]<br>    content = base64.b64decode(DocAttach.filecontent)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path+<span class="hljs-string">&#x27;\\&#x27;</span>+filename,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(content)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">pass</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>UiAuto</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>UiAuto</tag>
      
      <tag>suds</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|PDFè½¬å›¾åƒ</title>
    <link href="/2023/06/09/Python_pdf2image/"/>
    <url>/2023/06/09/Python_pdf2image/</url>
    
    <content type="html"><![CDATA[<p>â€ƒâ€ƒåœ¨å‰é¢é€šè¿‡ç™¾åº¦æ–‡å­—è¯†åˆ«å®ç°äº†å›¾ç‰‡çš„æ–‡å­—æå–ã€‚ä½†åœ¨æµ‹è¯•ä¸­å‘ç°æˆ‘ä»¬å®é™…ä¸­æ–‡ä»¶å¤§å¤šæ˜¯PDFçš„æ‰«æä»¶ã€‚æ‰€ä»¥éœ€è¦å…ˆæŠŠPDFè½¬ä¸ºå›¾ç‰‡ï¼Œä¹‹åè¿›è¡Œéå†è°ƒç”¨ç™¾åº¦æ–‡å­—è¯†åˆ«æ¥å£å³å¯ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯pdf2imageåº“å®ç°PDFè½¬å›¾ç‰‡ã€‚ã€‚</p><h1 id="pdfè½¬å›¾ç‰‡æºç "><a class="markdownIt-Anchor" href="#pdfè½¬å›¾ç‰‡æºç "></a> PDFè½¬å›¾ç‰‡æºç </h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># PDFè½¬å›¾ç‰‡</span><br><span class="hljs-keyword">from</span> pdf2image <span class="hljs-keyword">import</span> convert_from_path<br>pdf_file = <span class="hljs-string">r&#x27;C:\Users\admin\Documents\workspace\xxx.pdf&#x27;</span><br>output_dir = <span class="hljs-string">r&#x27;C:\Users\admin\Documents\workspace\xx&#x27;</span><br><br><span class="hljs-comment"># images = convert_from_path(pdf_file)</span><br>images = convert_from_path(pdf_file,poppler_path=<span class="hljs-string">r&#x27;C:\Users\admin\Documents\workspace\otherapi\poppler-0.68.0\bin&#x27;</span>)<br><span class="hljs-keyword">for</span> i ,img <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(images):<br>    img.save(output_dir+<span class="hljs-string">f&#x27;page_<span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>.png&#x27;</span>,<span class="hljs-string">&#x27;PNG&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="æŠ¥é”™é—®é¢˜ä¿®å¤"><a class="markdownIt-Anchor" href="#æŠ¥é”™é—®é¢˜ä¿®å¤"></a> æŠ¥é”™é—®é¢˜ä¿®å¤</h1><p>åœ¨æ‰§è¡Œæ—¶æŠ¥é”™äº†ï¼ŒæŠ¥é”™ä¿¡æ¯ï¼š</p><blockquote><p>pdf2image.exceptions.PDFInfoNotInstalledError: Unable to get page count. Is poppler installed and in PATH?</p></blockquote><p>ç™¾åº¦ä¹‹åçŸ¥é“æ˜¯ndkç‰ˆæœ¬ä¸å¯¹å¯¼è‡´çš„ï¼Œå®‰è£…python-popplerå³å¯è§£å†³ã€‚<br />è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li>è®¿é—® <a href="https://blog.alivate.com.au/poppler-windows/">https://blog.alivate.com.au/poppler-windows/</a> ä¸‹è½½å‹ç¼©åŒ…ã€‚</li><li>è§£å‹åå°†binè·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ã€‚</li><li>åœ¨ convert_from_path()è°ƒç”¨æ—¶å¢åŠ poppler_pathå‚æ•°ï¼ˆå¦‚ä¸Šè¿°ä»£ç ï¼‰ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>pdf2image</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>pdf2image</tag>
      
      <tag>PDF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|é€šè¿‡ç™¾åº¦OCRå®ç°å›¾ç‰‡æ–‡å­—è¯†åˆ«</title>
    <link href="/2023/06/09/Python_baidu_aip/"/>
    <url>/2023/06/09/Python_baidu_aip/</url>
    
    <content type="html"><![CDATA[<p>â€ƒâ€ƒæ˜¨å¤©éœ€è¦æµ‹è¯•OCRçš„æ–‡å­—è¯†åˆ«åŠŸèƒ½ï¼Œéœ€è¦ä»æä¾›çš„å›¾ç‰‡æˆ–PDFæ‰«æä»¶ä¸­æå–å‡ºæ–‡æœ¬ä¿¡æ¯ã€‚æœ¬æ¥æˆ‘æƒ³ä½¿ç”¨pythonçš„å¼€æºåº“ï¼ˆå¦‚pytesseractã€OCRopusã€OpenCVä¹‹ç±»çš„åº“ï¼‰ï¼Œè€ƒè™‘åˆ°å…¬å¸æ•°å­—å‘˜å·¥çš„ä½¿ç”¨åœºæ™¯ï¼Œæœªæ¥å›¾åƒè¯†åˆ«ä¼šå¯¹è¯†åˆ«ç‡æœ‰è¾ƒé«˜çš„è¦æ±‚ï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„OCRæ¥å£æœ€ä¸ºç¨³å¦¥ã€‚<br />â€ƒâ€ƒå¤§æ¦‚çœ‹äº†ç™¾åº¦çš„AIå¼€æ”¾å¹³å°ï¼Œåœ¨æ–‡å­—è¯†åˆ«éƒ¨åˆ†å¯¹ä¸ªäººç”¨æˆ·å¼€æ”¾äº†æ¯æœˆçš„è°ƒç”¨é¢åº¦ï¼Œå°±é¡ºä¾¿æ³¨å†Œä½“éªŒäº†ä¸‹ã€‚æ•´ä½“è¯†åˆ«æ•ˆç‡ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯å¾ˆé«˜çš„ã€‚</p><h1 id="æµ‹è¯•æ­¥éª¤"><a class="markdownIt-Anchor" href="#æµ‹è¯•æ­¥éª¤"></a> æµ‹è¯•æ­¥éª¤</h1><ol><li>ç™»å½•ç™¾åº¦AIå¼€æ”¾å¹³å°ï¼Œå¼€é€šæ–‡å­—è¯†åˆ«æœåŠ¡ã€‚</li><li>åœ¨æ§åˆ¶å°åˆ›å»ºåº”ç”¨ï¼Œè·å–åˆ°AppIDã€API Keyã€Secret Keyã€‚</li><li>å‚ç…§ç™¾åº¦æä¾›çš„æŠ€æœ¯æ–‡æ¡£è¿›è¡Œè”è°ƒæµ‹è¯•ã€‚</li></ol><h1 id="æºç "><a class="markdownIt-Anchor" href="#æºç "></a> æºç </h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> aip <span class="hljs-keyword">import</span> AipOcr<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> pdf2image <span class="hljs-keyword">import</span> convert_from_path<br><br><span class="hljs-comment"># ç™¾åº¦AIè°ƒç”¨æ¥å£</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">apiMessage</span>(<span class="hljs-params">app_id,app_key,secret_key</span>):<br>    APP_ID = app_id<br>    API_KEY = app_key<br>    SECRET_KEY = secret_key<br>    client = AipOcr(APP_ID, API_KEY, SECRET_KEY)<br>    <span class="hljs-keyword">return</span> client<br><br><span class="hljs-comment"># å›¾ç‰‡è¯†åˆ«</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">imgOcr</span>(<span class="hljs-params">client,filename</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> fp:  <span class="hljs-comment"># è¦ç”¨äºŒè¿›åˆ¶è¯»æ–¹å¼æ‰“å¼€</span><br>        image = fp.read()<br>    dic_result = client.basicGeneral(image)<br>    res = dic_result[<span class="hljs-string">&#x27;words_result&#x27;</span>]<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-comment"># ä¿å­˜è¯†åˆ«å†…å®¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">imgContent</span>(<span class="hljs-params">res,resultpath</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;&#123;&#125;\\result.txt&#x27;</span>.<span class="hljs-built_in">format</span>(resultpath),<span class="hljs-string">&#x27;a&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:<br>            f.write(i[<span class="hljs-string">&#x27;words&#x27;</span>])<br><br><span class="hljs-comment"># PDFè½¬å›¾ç‰‡</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdfToimg</span>(<span class="hljs-params">pdfFile,outputPath</span>):<br>    images = convert_from_path(pdfFile,poppler_path=<span class="hljs-string">r&#x27;C:\Users\admin\Documents\workspace\otherapi\poppler-0.68.0\bin&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i ,img <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(images):<br>        img.save(outputPath+<span class="hljs-string">f&#x27;\\page_<span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>.png&#x27;</span>,<span class="hljs-string">&#x27;PNG&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># APP_IDï¼ŒAPI_KEYï¼ŒSECRET_KEYçš„å€¼åœ¨åˆ›å»ºå®Œåº”ç”¨åå¯ä»¥è·å–åˆ°</span><br>    APP_ID = <span class="hljs-string">&#x27;xx&#x27;</span><br>    API_KEY = <span class="hljs-string">&#x27;xx&#x27;</span><br>    SECRET_KEY = <span class="hljs-string">&#x27;x&#x27;</span><br>    <br>    <span class="hljs-comment"># # å›¾ç‰‡å¤„ç†</span><br>    <span class="hljs-comment"># filename = r&#x27;C:\Users\a.jpg&#x27;</span><br>    <span class="hljs-comment"># resultpath = r&#x27;C:\Users&#x27;</span><br>    <span class="hljs-comment"># client = apiMessage(APP_ID,API_KEY,SECRET_KEY)</span><br>    <span class="hljs-comment"># content = imgOcr(client,filename)</span><br>    <span class="hljs-comment"># imgContent(content,resultpath)</span><br><br>    <span class="hljs-comment"># PDFå¤„ç†</span><br>    pdfFile = <span class="hljs-string">r&#x27;C:\Users\A.pdf&#x27;</span><br>    outputPath = <span class="hljs-string">r&#x27;C:\Users&#x27;</span><br>    <span class="hljs-comment"># pdfToimg(pdfFile,outputPath)</span><br>    listDir = os.listdir(outputPath)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> listDir:<br>        filenamei = <span class="hljs-string">&#x27;&#123;&#125;\\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(outputPath,i)<br>        client = apiMessage(APP_ID,API_KEY,SECRET_KEY)<br>        content = imgOcr(client,filenamei)<br>        imgContent(content,outputPath)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;å®Œæˆ&#123;&#125;çš„å¤„ç†&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>aip</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>aip</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UiAuto|æ³›å¾®Ecologyç³»ç»Ÿé™„ä»¶ä¸Šä¼ æ’ä»¶</title>
    <link href="/2023/06/02/UiAuto_ecologyFileUpload/"/>
    <url>/2023/06/02/UiAuto_ecologyFileUpload/</url>
    
    <content type="html"><![CDATA[<p>â€ƒâ€ƒæ­¤æ¬¡åœºæ™¯éœ€æ±‚æ˜¯ä¸Šä¼ æ–‡ä»¶åˆ°å…¬å¸å†…ç½‘é—¨æˆ·ç³»ç»Ÿï¼ˆæ³›å¾®Ecologyï¼‰ï¼Œé€šè¿‡UIAUTOçš„é”®ç›˜é¼ æ ‡åŠŸèƒ½æ¨¡æ‹Ÿç™»å½•åå†ä¸Šä¼ è™½ç„¶ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä½†ä¸é«˜çº§ï¼Œä¹Ÿä¸é«˜æ•ˆï¼Œè€Œä¸”æ‰§è¡Œæ—¶å¯¹æœåŠ¡å™¨ç•Œé¢ä¹Ÿæœ‰ä¸€å®šè¦æ±‚ã€‚è¿™é‡Œæˆ‘é€šè¿‡è°ƒç”¨æ³›å¾®Ecologyçš„æ¥å£ä»åå°å®ç°äº†æ–‡ä»¶çš„ä¸Šä¼ ï¼Œæµ‹è¯•æ•ˆæœååˆ†ç¨³å®šã€‚æ’ä»¶æºç å¦‚ä¸‹ï¼š</p><h1 id="packagejson"><a class="markdownIt-Anchor" href="#packagejson"></a> package.json</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjtEcologyFileUpload&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjfwfileupload&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ³›å¾®ecology9ç³»ç»Ÿæ¥å£å¯¹æ¥åŠŸèƒ½&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chendi&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;python&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Official&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;index.py&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;uiauto_config&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;attribution_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file_operation&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;attribution_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶å¤„ç†&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;operations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ecology&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ecology&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;uploadToEcology&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é™„ä»¶ä¸Šä¼ &quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;uploadToEcology&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Convention&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;urlip&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ³›å¾®ç³»ç»ŸIP&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pcip&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æœ¬æœºIP&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;userName&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç™»é™†ç”¨æˆ·&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pwd&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç™»é™†å¯†ç &quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;password&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;typeid&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç›®å½•ID&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;inputNumber&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filename&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é™„ä»¶åï¼ˆå«åç¼€ï¼‰&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filetitle&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é™„ä»¶æ ‡é¢˜&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶è·¯å¾„&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;options&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;select_type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;openDirectory&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶ä¸Šä¼ ç»“æœ&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><h1 id="indexpy"><a class="markdownIt-Anchor" href="#indexpy"></a> <a href="http://index.py">index.py</a></h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding:utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@description: ä¸Šä¼ é™„ä»¶è‡³æ³›å¾®Ecology9ç³»ç»Ÿä¸­</span><br><span class="hljs-string">@Time    :    2023-06-02</span><br><span class="hljs-string">@Author  :    CHENDI</span><br><span class="hljs-string">@Version :    1.0.0</span><br><span class="hljs-string">@Contact ï¼š   henanchendi@163.com</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> suds.client <span class="hljs-keyword">import</span> Client<br><span class="hljs-keyword">from</span> suds.xsd.doctor <span class="hljs-keyword">import</span> ImportDoctor, Import<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># æ ¹æ®å…³é”®å­—æ£€ç´¢wordå†…å®¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uploadToEcology</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-comment"># è·å–å‚æ•°</span><br>    urlip = params.get(<span class="hljs-string">&#x27;urlip&#x27;</span>)<br>    pcip = params.get(<span class="hljs-string">&#x27;pcip&#x27;</span>)<br>    userName = params.get(<span class="hljs-string">&#x27;userName&#x27;</span>)<br>    pwd = params.get(<span class="hljs-string">&#x27;pwd&#x27;</span>)<br>    filename = params.get(<span class="hljs-string">&#x27;filename&#x27;</span>)<br>    filetitle = params.get(<span class="hljs-string">&#x27;filetitle&#x27;</span>)<br>    path = params.get(<span class="hljs-string">&#x27;path&#x27;</span>)<br>    typeid = params.get(<span class="hljs-string">&#x27;typeid&#x27;</span>)<br><br>    <span class="hljs-comment"># è®¿é—®æ¥å£ï¼Œè·å–session</span><br>    imp = Import(<span class="hljs-string">&#x27;http://localhost/services/DocService&#x27;</span>)<br>    doctor = ImportDoctor(imp)<br>    url = <span class="hljs-string">&#x27;http://&#123;&#125;/services/DocService?wsdl&#x27;</span>.<span class="hljs-built_in">format</span>(urlip)<br>    client = Client(url,doctor=doctor)<br>    <span class="hljs-comment"># è·å–session</span><br>    result = client.service.login(userName,pwd,<span class="hljs-number">0</span>,pcip)<br><br>    <span class="hljs-comment"># å°è£…</span><br>    <span class="hljs-comment"># DocAttachmentä¿¡æ¯</span><br>    ArrayOfDocAttachment = client.factory.create(<span class="hljs-string">&#x27;ns2:ArrayOfDocAttachment&#x27;</span>)<br>    docinfo = client.factory.create(<span class="hljs-string">&#x27;ns2:DocInfo&#x27;</span>)<br>    DocAttach = client.factory.create(<span class="hljs-string">&#x27;ns2:DocAttachment&#x27;</span>)<br>    DocAttach.filename = filename<span class="hljs-comment">#æ–‡ä»¶åç§°</span><br>    base64_data =base64.b64encode(<span class="hljs-built_in">open</span>(os.path.join(path,filename),<span class="hljs-string">&#x27;rb&#x27;</span>).read())<br>    DocAttach.filecontent=base64_data.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    DocAttach.docImageFileId = <span class="hljs-number">1</span><br>    DocAttach.docid = <span class="hljs-built_in">int</span>(time.time())<br>    ArrayOfDocAttachment.DocAttachment.append(DocAttach) <br>    docinfo.docSubject = filetitle <span class="hljs-comment">#å‘æ–‡æ ‡é¢˜&#x27;æµ‹è¯•æ ‡é¢˜8&#x27;</span><br>    docinfo.attachments = ArrayOfDocAttachment<br>    docinfo.docType=<span class="hljs-number">1</span><br>    docinfo.doccreatedate = datetime.date.today()<br>    docinfo.doccreatetime = <span class="hljs-string">&#x27;17:00:00&#x27;</span><br>    docinfo.seccategory = typeid<br>    docinfo.maincategory = typeid<br>    docinfo.seccategory = typeid<br>    docinfo.subcategory = typeid<br>    client.service.createDoc(docinfo,result)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>UiAuto</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>UiAuto</tag>
      
      <tag>suds</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UiAuto|Wordæ’ä»¶</title>
    <link href="/2023/06/02/UiAuto_word/"/>
    <url>/2023/06/02/UiAuto_word/</url>
    
    <content type="html"><![CDATA[<p>å…³äºwordçš„æ’ä»¶å…¶å®æœ‰å¾ˆå¤šç§ä½¿ç”¨éœ€æ±‚ï¼Œè¯¥ç¯‡åšæ–‡åç»­ä¼šæ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µå†æ›´æ–°ã€‚<br />æœ¬æ¬¡æ˜¯éœ€è¦å¯¹ä¸€ç¯‡wordçš„å†…å®¹è¿›è¡Œæ£€ç´¢ï¼Œåˆ¤æ–­æ˜¯å¦æ¶‰åŠæŸä¸ªå­—ç¬¦ä¸²ï¼Œä»£ç æ¯”è¾ƒç®€å•ï¼Œæ’ä»¶æºç å¦‚ä¸‹ï¼š</p><h1 id="packagejson"><a class="markdownIt-Anchor" href="#packagejson"></a> package.json</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjtWord&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjtword&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;wordæ–‡æ¡£å†…å®¹æŸ¥è¯¢ï¼Œæ£€ç´¢æ˜¯å¦å­˜åœ¨æŸå…³é”®å­—ç¬¦ä¸²&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chendi&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;python&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Official&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;index.py&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;uiauto_config&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;attribution_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file_operation&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;attribution_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶å¤„ç†&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;operations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;word&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;WORD&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;searchWord&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;wordå†…å®¹åˆ¤æ–­&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;searchWord&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Convention&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filePath&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶è·¯å¾„&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;options&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;select_type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;openDirectory&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;fileName&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶åï¼ˆxxx.docxï¼‰&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ£€ç´¢å†…å®¹&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶å¤„ç†ç»“æœ&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;isExist&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h1 id="indexpy"><a class="markdownIt-Anchor" href="#indexpy"></a> <a href="http://index.py">index.py</a></h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding:utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@description: åŸºäºdocx,å¤„ç†wordæ–‡æ¡£</span><br><span class="hljs-string">@Time    :    2023-06-02</span><br><span class="hljs-string">@Author  :    CHENDI</span><br><span class="hljs-string">@Version :    1.0.0</span><br><span class="hljs-string">@Contact ï¼š   henanchendi@163.com</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">from</span> docx <span class="hljs-keyword">import</span> Document<br><br><span class="hljs-comment"># æ ¹æ®å…³é”®å­—æ£€ç´¢wordå†…å®¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">searchWord</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-comment"># è·å–å‚æ•°</span><br>    filePath = params.get(<span class="hljs-string">&#x27;filePath&#x27;</span>)<br>    fileName = params.get(<span class="hljs-string">&#x27;fileName&#x27;</span>)<br>    keyword = params.get(<span class="hljs-string">&#x27;keyword&#x27;</span>)<br><br>    path = <span class="hljs-string">&#x27;&#123;&#125;\\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filePath,fileName)<br>    isExist = <span class="hljs-literal">False</span><br>    doc = Document(path)<br>    <span class="hljs-keyword">for</span> paragraph <span class="hljs-keyword">in</span> doc.paragraphs:<br>        <span class="hljs-keyword">if</span> keyword <span class="hljs-keyword">in</span> paragraph.text:<br>            isExist = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> isExist<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">pass</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>UiAuto</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>docx</tag>
      
      <tag>UiAuto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UiAuto|Emailæ’ä»¶</title>
    <link href="/2023/06/01/UiAuto_mail/"/>
    <url>/2023/06/01/UiAuto_mail/</url>
    
    <content type="html"><![CDATA[<p>é€šè¿‡pythonè¿›è¡Œé‚®ä»¶å‘é€ä¹‹å‰å†™è¿‡å¾ˆå¤šï¼Œä½†å¦‚æœè¦æŸ¥è¯¢ç›®æ ‡é‚®ä»¶å‘¢ï¼Ÿ<br />é€šè¿‡RPAæ¨¡æ‹Ÿäººå·¥ç™»å½•é‚®ä»¶ï¼Œç„¶åéå†å‡ºç›®æ ‡é‚®ä»¶ï¼Ÿè¿™ç§æ–¹æ³•çœ‹ä¼¼å¯ä»¥ï¼Œä½†ä¸é«˜æ•ˆã€‚<br />è¿™é‡Œé€šè¿‡pythonçš„imboxåº“å®ç°é‚®ä»¶çš„éå†å’ŒæŸ¥è¯¢ï¼Œé€»è¾‘æ¯”è¾ƒç®€å•ï¼Œæ’ä»¶æºç å¦‚ä¸‹ï¼š</p><h1 id="packagejson"><a class="markdownIt-Anchor" href="#packagejson"></a> package.json</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjtEmail&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjtmail&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å…¬å¸é‚®ä»¶å¤„ç†æ’ä»¶ï¼Œé‚®ä»¶æ£€ç´¢ã€é™„ä»¶ä¸‹è½½&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chendi&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;python&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Official&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;index.py&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;uiauto_config&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;attribution_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;software_automation&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;attribution_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;è½¯ä»¶è‡ªåŠ¨åŒ–&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;operations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mail_operation&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ä»¶&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjtEmail&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ä»¶é™„ä»¶ä¸‹è½½&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;connectEmail&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Convention&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mailUrl&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ç®±åœ°å€&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mail.xxx.cn&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;account&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ç®±è´¦å·&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;password&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ç®±å¯†ç &quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;password&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;port&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;IMAPç«¯å£&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;143&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;queryDate&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ£€ç´¢æ—¥æœŸ(yyy-mm-dd)&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;queryType&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ£€ç´¢ç±»å‹&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;select&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;subject&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;options&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;multiple&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-attr">&quot;choices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                    <span class="hljs-punctuation">&#123;</span><br>                      <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;subject&quot;</span><span class="hljs-punctuation">,</span><br>                      <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ä»¶ä¸»é¢˜&quot;</span><br>                    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                    <span class="hljs-punctuation">&#123;</span><br>                      <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sentFrom&quot;</span><span class="hljs-punctuation">,</span><br>                      <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å‘ä»¶äºº&quot;</span><br>                    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                    <span class="hljs-punctuation">&#123;</span><br>                      <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;body&quot;</span><span class="hljs-punctuation">,</span><br>                      <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ä»¶å†…å®¹&quot;</span><br>                    <span class="hljs-punctuation">&#125;</span><br>                  <span class="hljs-punctuation">]</span><br>                <span class="hljs-punctuation">&#125;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ£€ç´¢æ–‡å­—&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filePath&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ä¿å­˜è·¯å¾„&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;options&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;select_type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;openDirectory&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¯é€‰å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;unrequired_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;fileName&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é™„ä»¶åç§°(å¸¦åç¼€)&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ä»¶å¤„ç†ç»“æœ&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mail_operation&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ä»¶&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zjtEmailSendFile&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ä»¶å‘é€&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sendMail&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Convention&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mailUrl&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ç®±åœ°å€&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mail.xxx.cn&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;account&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ç®±è´¦å·&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;password&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ç®±å¯†ç &quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;password&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;to&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ¥æ”¶äºº(åˆ†å·åˆ†å‰²)&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;subject&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ä¸»é¢˜&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;contents&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å†…å®¹&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tinymce&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¯é€‰å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;unrequired_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filePath&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é™„ä»¶è·¯å¾„&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;options&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;select_type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;openDirectory&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;fileName&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é™„ä»¶åç§°(å¸¦åç¼€)&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é‚®ä»¶å¤„ç†ç»“æœ&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><h1 id="indexpy"><a class="markdownIt-Anchor" href="#indexpy"></a> <a href="http://index.py">index.py</a></h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding:utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@description: åŸºäºimboxï¼Œé€šè¿‡imapåè®®éå†é‚®ä»¶ï¼Œä¸‹è½½æ‰€éœ€é‚®ä»¶çš„é™„ä»¶ã€‚</span><br><span class="hljs-string">@Time    :    2023-06-02</span><br><span class="hljs-string">@Author  :    CHENDI</span><br><span class="hljs-string">@Version :    1.0.0</span><br><span class="hljs-string">@Contact ï¼š   henanchendi@163.com</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">from</span> imbox <span class="hljs-keyword">import</span> Imbox<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> smtplib<br><span class="hljs-keyword">from</span> email.mime.text <span class="hljs-keyword">import</span> MIMEText<br><span class="hljs-keyword">from</span> email.mime.multipart <span class="hljs-keyword">import</span> MIMEMultipart<br><span class="hljs-keyword">from</span> email.header <span class="hljs-keyword">import</span> Header<br><span class="hljs-keyword">from</span> email.utils <span class="hljs-keyword">import</span> formataddr,parseaddr<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    åŸºäºimap,éå†é‚®ä»¶ï¼Œä¸‹è½½æ‰€éœ€é‚®ä»¶çš„é™„ä»¶ã€‚</span><br><span class="hljs-string">    by chendi 20230601</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">connectEmail</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-comment"># è·å–å‚æ•°</span><br>    mailUrl = params.get(<span class="hljs-string">&#x27;mailUrl&#x27;</span>)<br>    account = params.get(<span class="hljs-string">&#x27;account&#x27;</span>)<br>    password = params.get(<span class="hljs-string">&#x27;password&#x27;</span>)<br>    port = params.get(<span class="hljs-string">&#x27;port&#x27;</span>)<br>    queryDate = params.get(<span class="hljs-string">&#x27;queryDate&#x27;</span>)<br>    queryType = params.get(<span class="hljs-string">&#x27;queryType&#x27;</span>)<br>    keyword = params.get(<span class="hljs-string">&#x27;keyword&#x27;</span>)<br>    filePath = params.get(<span class="hljs-string">&#x27;filePath&#x27;</span>)<br>    fileName = params.get(<span class="hljs-string">&#x27;fileName&#x27;</span>)<br>    queryDate = queryDate.replace(<span class="hljs-string">&#x27;-0&#x27;</span>,<span class="hljs-string">&#x27;-&#x27;</span>)<br>    querydate = queryDate.split(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    <br>    <span class="hljs-keyword">with</span> Imbox(mailUrl,port=port,username=account,password=password,ssl=<span class="hljs-literal">False</span>) <span class="hljs-keyword">as</span> imbox:<br>        all_inbox_message = imbox.messages(date__on=datetime.date(<span class="hljs-built_in">int</span>(querydate[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(querydate[<span class="hljs-number">1</span>]),<span class="hljs-built_in">int</span>(querydate[<span class="hljs-number">2</span>])))<br>        <span class="hljs-keyword">for</span> uid,message <span class="hljs-keyword">in</span> all_inbox_message:<br>            <span class="hljs-comment"># æŒ‰ç…§å‘ä»¶ä¸»é¢˜éå†ä¸‹è½½</span><br>            <span class="hljs-keyword">if</span> queryType == <span class="hljs-string">&#x27;subject&#x27;</span> <span class="hljs-keyword">and</span> keyword <span class="hljs-keyword">in</span> message.subject:<br>                <span class="hljs-keyword">for</span> attachment <span class="hljs-keyword">in</span> message.attachments:<br>                    <span class="hljs-keyword">if</span> fileName == <span class="hljs-string">&#x27;&#x27;</span>:<br>                        file_name =<span class="hljs-string">&#x27;&#123;&#125;\\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filePath,attachment[<span class="hljs-string">&#x27;filename&#x27;</span>])<br>                    <span class="hljs-keyword">else</span> :<br>                        file_name= <span class="hljs-string">&#x27;&#123;&#125;\\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filePath,fileName)<br>                    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_name,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                        f.write(attachment[<span class="hljs-string">&#x27;content&#x27;</span>].getvalue())<br>                        f.close()<br>            <span class="hljs-comment"># æŒ‰ç…§é‚®ä»¶å†…å®¹éå†ä¸‹è½½</span><br>            bodyall = <span class="hljs-string">&#x27;&#x27;</span><br>            bodyall = bodyall.join(message.body[<span class="hljs-string">&#x27;plain&#x27;</span>]).join(message.body[<span class="hljs-string">&#x27;html&#x27;</span>])<br>            <span class="hljs-keyword">if</span> queryType == <span class="hljs-string">&#x27;body&#x27;</span> <span class="hljs-keyword">and</span> keyword <span class="hljs-keyword">in</span> bodyall :<br>                <span class="hljs-keyword">for</span> attachment <span class="hljs-keyword">in</span> message.attachments:<br>                    <span class="hljs-keyword">if</span> fileName == <span class="hljs-string">&#x27;&#x27;</span>:<br>                        file_name =<span class="hljs-string">&#x27;&#123;&#125;\\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filePath,attachment[<span class="hljs-string">&#x27;filename&#x27;</span>])<br>                    <span class="hljs-keyword">else</span> :<br>                        file_name= <span class="hljs-string">&#x27;&#123;&#125;\\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filePath,fileName)<br>                    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_name,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                        f.write(attachment[<span class="hljs-string">&#x27;content&#x27;</span>].getvalue())<br>                        f.close()<br>            <span class="hljs-comment"># æŒ‰ç…§å‘ä»¶äººéå†ä¸‹è½½</span><br>            <span class="hljs-keyword">if</span> queryType == <span class="hljs-string">&#x27;sentFrom&#x27;</span> <span class="hljs-keyword">and</span> keyword <span class="hljs-keyword">in</span> message.sent_from[<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;email&#x27;</span>]:<br>                <span class="hljs-keyword">for</span> attachment <span class="hljs-keyword">in</span> message.attachments:<br>                    <span class="hljs-keyword">if</span> fileName == <span class="hljs-string">&#x27;&#x27;</span>:<br>                        file_name =<span class="hljs-string">&#x27;&#123;&#125;\\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filePath,attachment[<span class="hljs-string">&#x27;filename&#x27;</span>])<br>                    <span class="hljs-keyword">else</span> :<br>                        file_name= <span class="hljs-string">&#x27;&#123;&#125;\\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filePath,fileName)<br>                    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_name,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                        f.write(attachment[<span class="hljs-string">&#x27;content&#x27;</span>].getvalue())<br>                        f.close()<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    é‚®ä»¶å‘é€ï¼ˆæ”¯æŒæ”¶ä»¶äººä¸ºå¤šäººï¼Œæ”¯æŒé™„ä»¶å‘é€ï¼‰</span><br><span class="hljs-string">    smtplibä¸å¥½ç”¨ï¼Œè¦ç¾åŒ–å‘ä»¶äººå’Œæ”¶ä»¶äººä¿¡æ¯æ‰å¯ä»¥ï¼Œå¦åˆ™é‚®ä»¶å±•ç¤ºä¼šæœ‰é—®é¢˜ã€‚</span><br><span class="hljs-string">    ä»¥åç”¨yagmailç¬¬ä¸‰æ–¹åº“ã€‚</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># è‡ªå®šä¹‰å‘ä»¶äººå’Œæ”¶ä»¶äºº</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_format_addr</span>(<span class="hljs-params">s</span>):<br>    addr = parseaddr(s)<br>    <span class="hljs-keyword">return</span> formataddr(addr)<br><span class="hljs-comment"># å‘é€é‚®ä»¶</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sendMail</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-comment"># è·å–å‚æ•°</span><br>    mailUrl = params.get(<span class="hljs-string">&#x27;mailUrl&#x27;</span>)<br>    account = params.get(<span class="hljs-string">&#x27;account&#x27;</span>)<br>    password = params.get(<span class="hljs-string">&#x27;password&#x27;</span>)<br>    subject = params.get(<span class="hljs-string">&#x27;subject&#x27;</span>)<br>    contents = params.get(<span class="hljs-string">&#x27;contents&#x27;</span>)<br>    to = params.get(<span class="hljs-string">&#x27;to&#x27;</span>)<br>    filePath = params.get(<span class="hljs-string">&#x27;filePath&#x27;</span>)<br>    fileName = params.get(<span class="hljs-string">&#x27;fileName&#x27;</span>)<br>    file = filePath+<span class="hljs-string">&#x27;\\&#x27;</span>+fileName<br>    toaddr = to.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br><br>    smtp = smtplib.SMTP()<br>    smtp.connect(mailUrl, port=<span class="hljs-number">25</span>)<br>    smtp.login(user=account, password=password)<br>    message = MIMEMultipart()<br>    message[<span class="hljs-string">&#x27;From&#x27;</span>] = formataddr([account,account])<br>    message[<span class="hljs-string">&#x27;Subject&#x27;</span>] = Header(subject, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-comment"># è‡ªå®šä¹‰æ”¶ä»¶äººï¼Œå¦åˆ™å¯¹æ–¹é‚®ç®±ä¼šä¸æ˜¾ç¤ºæ”¶ä»¶äººä¿¡æ¯</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> toaddr:<br>        message[<span class="hljs-string">&#x27;To&#x27;</span>] = _format_addr(item)<br><br>    message.attach(MIMEText(contents, <span class="hljs-string">&#x27;html&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(filePath)&gt;<span class="hljs-number">0</span> :<br>        att = MIMEText(<span class="hljs-built_in">open</span>(file,<span class="hljs-string">&#x27;rb&#x27;</span>).read(),<span class="hljs-string">&#x27;base64&#x27;</span>,<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        att[<span class="hljs-string">&#x27;Content-Type&#x27;</span>] = <span class="hljs-string">&#x27;application/octet-stream&#x27;</span><br>        <span class="hljs-comment"># att[&quot;Content-Disposition&quot;] = &#x27;attachment; filename=&#123;&#125;&#x27;.format(fileName)</span><br>        att.add_header(<span class="hljs-string">&#x27;Content-Disposition&#x27;</span>,<span class="hljs-string">&#x27;attachment&#x27;</span>,filename=Header(fileName,<span class="hljs-string">&#x27;utf-8&#x27;</span>).encode())<br>        message.attach(att)<br>    smtp.sendmail(from_addr=account, to_addrs=toaddr, msg=message.as_string())<br>    smtp.quit()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">pass</span><br><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>UiAuto</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>UiAuto</tag>
      
      <tag>imbox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UiAuto|SQLServeræ’ä»¶</title>
    <link href="/2023/05/30/UiAuto_SQLServer/"/>
    <url>/2023/05/30/UiAuto_SQLServer/</url>
    
    <content type="html"><![CDATA[<p>ä»æ•°å­—å‘˜å·¥çš„è§’åº¦æ¥çœ‹ï¼Œå¯ä»¥è¿æ¥å„ç±»æ•°æ®åº“åº”è¯¥æ˜¯æœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚æœ‰äº›å¤±æœ›çš„æ˜¯æ‹¿åˆ°çš„UiAutoæ ‡å‡†äº§å“æ²¡æœ‰å°è£…SQLServerçš„åŠŸèƒ½ï¼Œè¿™é‡Œè‡ªå·±ç®€å•å†™ä¸€ä¸ªï¼Œå…ˆæ»¡è¶³ç®€å•çš„æŸ¥è¯¢ã€æ›´æ–°ã€‚åç»­ä¼šæ ¹æ®ä½¿ç”¨æƒ…å†µåŠæ—¶æ›´æ–°ã€‚æ’ä»¶æºç å¦‚ä¸‹ï¼š</p><h1 id="packagejson"><a class="markdownIt-Anchor" href="#packagejson"></a> package.json</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MSSQL&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MSSQL&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sqlserveræ•°æ®åº“æ’ä»¶ï¼Œå¯é€šè¿‡è¯¥æ’ä»¶æ‰§è¡Œä¸€ç³»åˆ—çš„æ•°æ®åº“ç›¸å…³æ“ä½œ&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.2&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chendi&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;python&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Official&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;index.py&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;uiauto_config&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;attribution_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;database&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;attribution_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ•°æ®åº“&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;operations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mssql_database&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;SqlServer&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;connectMSsql&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;è¿æ¥æ•°æ®åº“&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;connectMSsql&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Convention&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;database_name&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ•°æ®åº“å&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;username&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç”¨æˆ·å&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;password&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¯†ç &quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;password&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;host&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æœåŠ¡å™¨&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;port&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç«¯å£&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1433&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;encoding&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å­—ç¬¦ç¼–ç &quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cp936&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ•°æ®åº“è¿æ¥å¯¹è±¡&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MSSQL&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mssql_database&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MSSQL&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;executeSQL&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ‰§è¡ŒSQL&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;executeSQL&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Convention&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;connect_message&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ•°æ®åº“å¯¹è±¡&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;$&#123;mssql&#125;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sql&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;SQLè¯­å¥&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;code&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;SELECT * FROM &quot;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;SQLæ‰§è¡Œè¿”å›å€¼&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;execute_result&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;mssql_database&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MSSQL&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;closeConnect&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å…³é—­æ•°æ®åº“&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;closeConnect&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Convention&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>          <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;connect_message&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ•°æ®åº“å¯¹è±¡&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;$&#123;mssql&#125;&quot;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å…³é—­ç»“æœï¼ŒTrue or False&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br><br></code></pre></td></tr></table></figure><h1 id="indexpy"><a class="markdownIt-Anchor" href="#indexpy"></a> <a href="http://index.py">index.py</a></h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- encoding:utf-8 -*-</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">@description: åŸºäºpymssqlè¿›è¡ŒSQLServeræ•°æ®åº“çš„å¯¹æ¥</span><br><span class="hljs-string">@Time    :    2023-05-29</span><br><span class="hljs-string">@Author  :    CHENDI</span><br><span class="hljs-string">@Version :    1.0.0</span><br><span class="hljs-string">@Contact ï¼š   henanchendi@163.com</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> pymssql<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">connectMSsql</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è¿æ¥æ•°æ®åº“</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;host&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;port&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;username&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;password&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;database_name&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> params:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;ç¼ºå°‘å‚æ•°&#x27;</span>)<br>        host = params.get(<span class="hljs-string">&#x27;host&#x27;</span>)<br>        port = params.get(<span class="hljs-string">&#x27;port&#x27;</span>, <span class="hljs-number">1433</span>)  <br>        <span class="hljs-keyword">try</span>:<br>            port = <span class="hljs-built_in">int</span>(port)<br>        <span class="hljs-keyword">except</span> Exception:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ç«¯å£ä¿¡æ¯é”™è¯¯&quot;</span><br>        username = params.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>        password = params.get(<span class="hljs-string">&#x27;password&#x27;</span>)<br>        database_name = params.get(<span class="hljs-string">&#x27;database_name&#x27;</span>)<br>        encoding = params.get(<span class="hljs-string">&#x27;encoding&#x27;</span>)<br>        conn = pymssql.connect(host=host,port=port, user=username, password=password, database=database_name,charset=encoding)<br>        <span class="hljs-keyword">return</span> conn<br>    <span class="hljs-keyword">except</span> pymssql._pymssql.OperationalError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ•°æ®åº“è¿æ¥è¶…æ—¶&quot;</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">raise</span> e<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">executeSQL</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    æ‰§è¡ŒSQLè¯­å¥,å…ˆå®ç°select ,update,insert</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    conn = params.get(<span class="hljs-string">&#x27;connect_message&#x27;</span>)<br>    sql = params.get(<span class="hljs-string">&#x27;sql&#x27;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        cursor = conn.cursor()<br>        <span class="hljs-keyword">if</span> sql.startswith(<span class="hljs-string">&quot;select&quot;</span>) <span class="hljs-keyword">or</span> sql.startswith(<span class="hljs-string">&quot;SELECT&quot;</span>):<br>            cursor.execute(sql)<br>            result = cursor.fetchall()<br>            <span class="hljs-keyword">return</span> result<br>        <span class="hljs-keyword">elif</span> sql.startswith(<span class="hljs-string">&quot;update&quot;</span>) <span class="hljs-keyword">or</span> sql.startswith(<span class="hljs-string">&quot;UPDATE&quot;</span>):<br>            cursor.execute(sql)<br>            conn.commit()<br>            <span class="hljs-keyword">return</span> &#123;&#125;<br>        <span class="hljs-keyword">elif</span> sql.startswith(<span class="hljs-string">&quot;insert&quot;</span>) <span class="hljs-keyword">or</span> sql.startswith(<span class="hljs-string">&quot;INSERT&quot;</span>):<br>            cursor.execute(sql)<br>            conn.commit()<br>            <span class="hljs-keyword">return</span> &#123;&#125;<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> &#123;&#125;<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">raise</span> e<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">closeConnect</span>(<span class="hljs-params">params</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å…³é—­æ•°æ®åº“</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        conn = params.get(<span class="hljs-string">&#x27;connect_message&#x27;</span>)<br>        conn.close()<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">except</span> IndexError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;è¯·æ£€æŸ¥ï¼š<span class="hljs-subst">&#123;e.__str__()&#125;</span>&quot;</span><br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>UiAuto</category>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>UiAuto</tag>
      
      <tag>pymssql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UiAuto|å¼€å‘è§„èŒƒ</title>
    <link href="/2023/05/27/UiAutoDevelopedStandard/"/>
    <url>/2023/05/27/UiAutoDevelopedStandard/</url>
    
    <content type="html"><![CDATA[<p>â€ƒâ€ƒæœ€è¿‘å…¬å¸åœ¨åšæ•°å­—å‘˜å·¥çš„å¼€å‘ï¼Œåœ¨å‰é¢çš„åšæ–‡ä¸­å¤§æ¦‚èƒ½çœ‹å‡ºæˆ‘å¯¹PYTHONè„šæœ¬ã€KETTLEã€RPA(UIPATHã€Power Automat)éƒ½åšè¿‡ä¸€äº›è‡ªåŠ¨åŠå…¬çš„å°è¯•ã€‚æœ€ç»ˆæˆ‘ä»¬å…¬å¸é€‰æ‹©äº†UIAUTOæ¥ä½œä¸ºåŸºç¡€å¹³å°ï¼Œç©¶å…¶åŸå› ï¼Œæ˜¯å®ƒå¯¹PYTHONçš„äºŒå¼€æœ‰å¾ˆå¤§çš„å…¼å®¹åº¦ï¼Œæå…¶çµæ´»ï¼é€ è½®å­çš„è¿‡ç¨‹ä½•å°ä¸æ˜¯ä¸€ç§å¿«ä¹å‘¢ï¼Ÿ<br />â€ƒâ€ƒç™¾åº¦ç™¾ç§‘æœç´¢RPAç»™å‡ºçš„è§£é‡Šæ˜¯â€œæœºå™¨äººæµç¨‹è‡ªåŠ¨åŒ–ï¼ˆRobotic process automation,ç®€ç§°RPAï¼‰æ˜¯ä»¥è½¯ä»¶æœºå™¨äººåŠäººå·¥æ™ºèƒ½ï¼ˆAIï¼‰ä¸ºåŸºç¡€çš„ä¸šåŠ¡è¿‡ç¨‹è‡ªåŠ¨åŒ–æŠ€æœ¯â€ã€‚ä½†æˆ‘å§‹ç»ˆè®¤ä¸ºRPAæ˜¯åœ¨çº¿åŠå…¬å‘æ™ºèƒ½åŠå…¬è¿‡æ¸¡çš„äº§ç‰©ï¼Œæ—©æœŸçš„RPAä¾èµ–çš„æ˜¯å±å¹•å’Œé”®é¼ çš„é…åˆï¼Œé¡¶å¤šåŠ ä¸Šå¼€æºçš„OCRè¯†åˆ«ï¼Œå¾ˆå¤šè½¯ä»¶/å‚å•†å°±å¯¹å¤–å®£ç§°æ˜¯æ™ºèƒ½æœºå™¨äººäº†ã€‚PYTHONçš„ç«é€Ÿå‘å±•æ‰æ˜¯RPAæŠ€æœ¯æˆç†Ÿçš„åŸå› ï¼ŒPYTHONå„ç§å¥‡å¦™çš„åº“æ‰è®©RPAæœ‰äº†æ›´å¤šå‘å±•çš„æœºä¼šã€‚UIAUTOä¸å…¶è¯´æ˜¯RPAå·¥å…·ï¼Œæ›´ä¸å¦‚è¯´æ˜¯ä¸€ä¸ªåŸºç¡€å¹³å°ï¼Œæœ‰åŸºç¡€çš„å›¾å½¢ç•Œé¢ã€ç›¸å¯¹æ˜“ç”¨çš„ç®¡ç†ç•Œé¢ã€è¿˜æœ‰çµæ´»çš„äºŒå¼€æ–¹æ¡ˆã€‚å®ƒæä¾›æ ‡å‡†çš„å¼€å‘è§„èŒƒï¼Œå¼€å‘äººå‘˜å¯ä»¥å°†å†™å¥½çš„JSã€PYTHONåŠŸèƒ½å°è£…ä¸ºæ’ä»¶ï¼Œå®ç°ç›¸å…³å¸¸è§çš„è°ƒç”¨ã€‚è¿™ç§å°†è®¾è®¡æƒäº¤ç»™ç»ˆç«¯å¼€å‘äººå‘˜çš„æ–¹æ¡ˆåœ¨å®è·µä¸Šæ˜¯å¾ˆå·§å¦™çš„ï¼Œç»ˆç«¯å¼€å‘å¯ä»¥ä»»æ€§é­”æ”¹ï¼Œå®ç°å„ç±»åœºæ™¯éœ€æ±‚ã€‚<br />â€ƒâ€ƒå¼€å‘è§„èŒƒè®°å½•å¦‚ä¸‹ï¼Œä¾¿äºåç»­ç¿»é˜…ï¼š</p><h1 id="æ’ä»¶ç›®å½•ç»“æ„æ’ä»¶ç›®å½•ç»“æ„"><a class="markdownIt-Anchor" href="#æ’ä»¶ç›®å½•ç»“æ„æ’ä»¶ç›®å½•ç»“æ„"></a> æ’ä»¶ç›®å½•ç»“æ„æ’ä»¶ç›®å½•ç»“æ„</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">demo<br>â””â”€ <span class="hljs-number">1.0</span>.<span class="hljs-number">0</span> <span class="hljs-regexp">//</span>æ’ä»¶ç‰ˆæœ¬ï¼Œä¸package.jsonæè¿°éœ€ä¸€è‡´<br>â”œâ”€ index.js <span class="hljs-regexp">//</span>jsé€»è¾‘å…¥å£æ–‡ä»¶ï¼Œå‘½åå¿…é¡»ä¸ºindex<br>â”œâ”€ index.py <span class="hljs-regexp">//</span>pythoné€»è¾‘å…¥å£æ–‡ä»¶ï¼Œå‘½åå¿…é¡»ä¸ºindex<br>â”œâ”€ node_modules <span class="hljs-regexp">//</span>nodejsä¾èµ–åº“<br>â”œâ”€ requirements.txt <span class="hljs-regexp">//</span>pythonä¾èµ–åº“<br>â”œâ”€ package-lock.json<br>â”œâ”€ package.json<br>â”œâ”€ packages<br>â””â”€ util.js <span class="hljs-regexp">//</span>è‡ªå®šä¹‰é€»è¾‘æ–‡ä»¶<br></code></pre></td></tr></table></figure><h1 id="æ’ä»¶å¼€å‘æ’ä»¶å¼€å‘"><a class="markdownIt-Anchor" href="#æ’ä»¶å¼€å‘æ’ä»¶å¼€å‘"></a> æ’ä»¶å¼€å‘æ’ä»¶å¼€å‘</h1><p>æ’ä»¶ç”±æè¿°æ–‡ä»¶åŠå…¥å£ç¨‹åºç»„æˆï¼Œå…¥å£ç¨‹åºä¸»è¦æ˜¯æš´éœ²æ’ä»¶æ¯ä¸ªæ“ä½œçš„æ‰§è¡Œæ–¹æ³•ï¼ˆåŸºäºJavaè¯­è¨€å¼€å‘çš„æ’ä»¶çš„å…¥å£ç¨‹åºæ˜¯ç¼–è¯‘æ‰“åŒ…çš„jaråŒ…æ–‡ä»¶ï¼‰ã€‚</p><h2 id="æ’ä»¶ä¾èµ–æ’ä»¶ä¾èµ–"><a class="markdownIt-Anchor" href="#æ’ä»¶ä¾èµ–æ’ä»¶ä¾èµ–"></a> æ’ä»¶ä¾èµ–æ’ä»¶ä¾èµ–</h2><p>å¯¹äºåŸºäºPythonè¯­è¨€å¼€å‘çš„æ’ä»¶ï¼Œé€šè¿‡æ·»åŠ requirements.txtæ–‡ä»¶æ¥é…ç½®ä¾èµ–åº“ã€‚<br />å¯¹äºåŸºäºNodeJSè¯­è¨€å¼€å‘çš„æ’ä»¶æ˜¯åœ¨package.jsonæ–‡ä»¶å†…çš„dependencieså±æ€§é…ç½®ä¾èµ–åº“ã€‚<br />å¯¹äºåŸºäºJavaè¯­è¨€å¼€å‘çš„æ’ä»¶æ˜¯åœ¨ç¼–è¯‘jaråŒ…æ—¶å°±éœ€è¦æŠŠä¾èµ–åº“ä¸€èµ·æ‰“åŒ…ã€‚</p><h2 id="æè¿°æ–‡ä»¶ç»“æ„æè¿°æ–‡ä»¶ç»“æ„"><a class="markdownIt-Anchor" href="#æè¿°æ–‡ä»¶ç»“æ„æè¿°æ–‡ä»¶ç»“æ„"></a> æè¿°æ–‡ä»¶ç»“æ„æè¿°æ–‡ä»¶ç»“æ„</h2><div class="note note-info">            <p>æè¿°æ–‡ä»¶å†…å®¹ä¸ºæ ‡å‡†JSONæ ¼å¼,ä»¥ä¸‹æ³¨é‡Šä¸ºæ–¹ä¾¿ç†è§£å˜é‡æ„ä¹‰</p>          </div><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hello-world&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hello-world&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// project name,</span><br><span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;say hello from UiAuto!&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;UiAuto&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;nodejs&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;MIT&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;lodash&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4.17.11&quot;</span> <span class="hljs-comment">// depandencies of the plugin</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;uiauto_config&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;attribution_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;software_automation&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//first level category</span><br><span class="hljs-attr">&quot;attribution_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;è½¯ä»¶è‡ªåŠ¨åŒ–&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//first level category name</span><br><span class="hljs-attr">&quot;operations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;category_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;plugin-template&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// class of the operation, sort the opterations according to this param</span><br><span class="hljs-attr">&quot;category_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ¨¡æ¿æ’ä»¶&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// name of the class, if we don&#x27;t have the category_id above yet, this name will be shown on front - end &quot;operation_id&quot;: &quot;plugin-one&quot;,</span><br><span class="hljs-attr">&quot;operation_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ’ä»¶ä¸€&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sayHello&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// if this opteration is executed, function named &quot;sayHello&quot; in &quot;./index.js&quot; (&quot;./index.py&quot; in python) will be activated &quot;type&quot;: &quot;Convention&quot;, // we have these types yet =&gt; [Start, Condition, Convention, Circulation, Script, End]. Only Condition and Convention can be defined </span><br><span class="hljs-attr">&quot;input&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// label of this input group</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;required_params&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;addressee&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// id of this input</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç”¨æˆ·å&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// label of this input</span><br><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// type of this input, you can read the detail of various types below</span><br><span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// is the value required</span><br><span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;uiauto_group&quot;</span> <span class="hljs-comment">// the default value</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ–‡ä»¶&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¯é€‰å±æ€§&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;unrequired_params&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;drink&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;é¥®å“&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;select&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tea&quot;</span> <span class="hljs-comment">// default value ã€Œé»˜è®¤å€¼ã€</span><br><span class="hljs-attr">&quot;options&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;multiple&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// required option, could the user make multiple choices or not</span><br><span class="hljs-attr">&quot;choices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;juice&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æœæ±&quot;</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;coffee&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å’–å•¡&quot;</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tea&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;èŒ¶&quot;</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span> <span class="hljs-comment">// enumerate groups of value and label</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;output&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;is_allow_global_use&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;è¿”å›æ‰§è¡Œç»“æœï¼Œtrue æˆ–è€… false&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="å±æ€§ç±»å‹æ€»è§ˆå±æ€§ç±»å‹æ€»è§ˆ"><a class="markdownIt-Anchor" href="#å±æ€§ç±»å‹æ€»è§ˆå±æ€§ç±»å‹æ€»è§ˆ"></a> å±æ€§ç±»å‹æ€»è§ˆå±æ€§ç±»å‹æ€»è§ˆ</h2><h3 id="text-æ™®é€šæ–‡æœ¬ç±»å‹æ™®é€šæ–‡æœ¬ç±»å‹"><a class="markdownIt-Anchor" href="#text-æ™®é€šæ–‡æœ¬ç±»å‹æ™®é€šæ–‡æœ¬ç±»å‹"></a> text æ™®é€šæ–‡æœ¬ç±»å‹æ™®é€šæ–‡æœ¬ç±»å‹</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;text&quot;</span>,<br>    <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;default value&quot;</span><span class="hljs-regexp">//</span> é»˜è®¤å€¼<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">result:</span> &lt;<span class="hljs-type">String</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="password-å¯†ç æ–‡æœ¬ç±»å‹å¯†ç æ–‡æœ¬ç±»å‹"><a class="markdownIt-Anchor" href="#password-å¯†ç æ–‡æœ¬ç±»å‹å¯†ç æ–‡æœ¬ç±»å‹"></a> password å¯†ç æ–‡æœ¬ç±»å‹å¯†ç æ–‡æœ¬ç±»å‹</h3><p>*å¯†ç æ–‡æœ¬ç±»å‹çš„å‰ç«¯å±•ç¤ºå½¢å¼æ˜¯ â€œÂ·Â·Â·â€</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;password&quot;</span>,<br>    <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;default value&quot;</span><span class="hljs-regexp">//</span> é»˜è®¤å€¼<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">result:</span> &lt;<span class="hljs-type">String</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="string-æ–‡æœ¬å±•ç¤ºç±»å‹æ–‡æœ¬å±•ç¤ºç±»å‹"><a class="markdownIt-Anchor" href="#string-æ–‡æœ¬å±•ç¤ºç±»å‹æ–‡æœ¬å±•ç¤ºç±»å‹"></a> string æ–‡æœ¬å±•ç¤ºç±»å‹æ–‡æœ¬å±•ç¤ºç±»å‹</h3><p>è¯¥ç±»å‹ä¸‹çš„æ–‡æœ¬åªåšå±•ç¤ºç”¨é€”ï¼Œä¸å…è®¸ç¼–è¾‘</p><figure class="highlight smalltalk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs smalltalk">&#123;<br>    <span class="hljs-comment">&quot;type&quot;</span>: <span class="hljs-comment">&quot;string&quot;</span>,<br>    <span class="hljs-comment">&quot;value&quot;</span>: <span class="hljs-comment">&quot;value which can not be edited&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable"><span class="hljs-class">result</span></span>: <span class="hljs-variable"><span class="hljs-literal">null</span></span><br></code></pre></td></tr></table></figure><h3 id="file-æ–‡ä»¶ç±»å‹æ–‡ä»¶ç±»å‹"><a class="markdownIt-Anchor" href="#file-æ–‡ä»¶ç±»å‹æ–‡ä»¶ç±»å‹"></a> file æ–‡ä»¶ç±»å‹æ–‡ä»¶ç±»å‹</h3><p>è¯¥ç±»å‹ç›®å‰ä»…æ”¯æŒé€‰æ‹©ä¸€ä¸ªæ–‡ä»¶</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;file&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">result:</span> &lt;<span class="hljs-type">String</span> &lt;filePath&gt;&gt;<br></code></pre></td></tr></table></figure><h3 id="color-é¢œè‰²ç±»å‹é¢œè‰²ç±»å‹"><a class="markdownIt-Anchor" href="#color-é¢œè‰²ç±»å‹é¢œè‰²ç±»å‹"></a> color é¢œè‰²ç±»å‹é¢œè‰²ç±»å‹</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;color&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">result:</span> &lt;<span class="hljs-type">String</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="checkbox-å¤šé€‰ç±»å‹å¤šé€‰ç±»å‹"><a class="markdownIt-Anchor" href="#checkbox-å¤šé€‰ç±»å‹å¤šé€‰ç±»å‹"></a> checkbox å¤šé€‰ç±»å‹å¤šé€‰ç±»å‹</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;checkbox&quot;</span>,<br>    <span class="hljs-string">&quot;value&quot;</span>: [],<span class="hljs-regexp">//</span> default value ã€Œé»˜è®¤å€¼ã€<br>    <span class="hljs-string">&quot;options&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;checked&quot;</span>: [] <span class="hljs-regexp">//</span> é»˜è®¤é€‰ä¸­<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">result</span>: &lt;<span class="hljs-keyword">Array</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="datetimerange-æ—¶é—´æ®µç±»å‹æ—¶é—´æ®µç±»å‹"><a class="markdownIt-Anchor" href="#datetimerange-æ—¶é—´æ®µç±»å‹æ—¶é—´æ®µç±»å‹"></a> dateTimeRange æ—¶é—´æ®µç±»å‹æ—¶é—´æ®µç±»å‹</h3><p><em>options.type</em> ä¸åŒï¼Œ <em>value</em> éœ€æ±‚ä¸åŒï¼Œä½†å€¼å¯è¢«å…¼å®¹ï¼Œè‹¥æ’ä»¶éœ€è¦ç²¾ç¡®åˆ°æ—¶é—´ï¼Œä½†é»˜è®¤å€¼æ²¡æœ‰ç²¾ç¡®åˆ°æ—¶é—´ï¼ˆä¸æ¨èï¼‰ï¼Œåˆ™ä¼šé»˜è®¤è®¾å®šä¸ºä¸–ç•Œåè°ƒæ—¶é—´<br /><em>(UTC)/</em> æ ¼æ—å°¼æ²»æ—¶é—´ <em>(GMT) 00:00:00</em> ï¼Œå³è‹¥åœ¨ä¸œå…«æ—¶åŒºï¼Œåˆ™é»˜è®¤å€¼ä¸º <em>08:00:00</em> ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;dateTimeRange&quot;</span>,<br>    <span class="hljs-string">&quot;value&quot;</span>: [<span class="hljs-string">&quot;2019-05-01 00:00:00&quot;</span>, <span class="hljs-string">&quot;2019-10-01 12:00:00&quot;</span>]<span class="hljs-regexp">//</span> default value ã€Œé»˜è®¤å€¼ã€<br>    <span class="hljs-string">&quot;options&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;daterange&quot;</span> <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;datetimerange&quot;</span> | <span class="hljs-string">&quot;daterange&quot;</span> | <span class="hljs-string">&quot;monthrange&quot;</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable"><span class="hljs-class">result</span></span>: &lt;<span class="hljs-function"><span class="hljs-title">Array</span>(<span class="hljs-number">2</span>)&gt;</span><br></code></pre></td></tr></table></figure><h3 id="inputnumber-è®¡æ•°å™¨ç±»å‹è®¡æ•°å™¨ç±»å‹"><a class="markdownIt-Anchor" href="#inputnumber-è®¡æ•°å™¨ç±»å‹è®¡æ•°å™¨ç±»å‹"></a> inputNumber è®¡æ•°å™¨ç±»å‹è®¡æ•°å™¨ç±»å‹</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;inputNumber&quot;</span>,<br>    <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">10</span> <span class="hljs-regexp">//</span> é»˜è®¤å€¼<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-literal">result</span>: &lt;Number&gt;<br></code></pre></td></tr></table></figure><h3 id="conditions-æ¡ä»¶ç±»å‹æ¡ä»¶ç±»å‹"><a class="markdownIt-Anchor" href="#conditions-æ¡ä»¶ç±»å‹æ¡ä»¶ç±»å‹"></a> conditions æ¡ä»¶ç±»å‹æ¡ä»¶ç±»å‹</h3><p>è¯¥ç±»å‹çš„å€¼å‡ä¸ºä¸ç­‰å¼å­—ç¬¦ä¸²</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;conditions&quot;</span>,<br>    <span class="hljs-string">&quot;value&quot;</span>: [<span class="hljs-string">&quot;value1 &gt; 10&quot;</span>, <span class="hljs-string">&quot;value2 &lt; 50&quot;</span>] <span class="hljs-regexp">//</span> é»˜è®¤å€¼<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">result</span>: &lt;<span class="hljs-keyword">Array</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="select-ä¸‹æ‹‰åˆ—è¡¨ç±»å‹ä¸‹æ‹‰åˆ—è¡¨ç±»å‹"><a class="markdownIt-Anchor" href="#select-ä¸‹æ‹‰åˆ—è¡¨ç±»å‹ä¸‹æ‹‰åˆ—è¡¨ç±»å‹"></a> select ä¸‹æ‹‰åˆ—è¡¨ç±»å‹ä¸‹æ‹‰åˆ—è¡¨ç±»å‹</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br><span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;select&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;tea&quot;</span> <span class="hljs-regexp">//</span> default value ã€Œé»˜è®¤å€¼ã€<br><span class="hljs-string">&quot;options&quot;</span>: &#123;<br><span class="hljs-string">&quot;multiple&quot;</span>: true, <span class="hljs-regexp">//</span> required option, could the user make multiple choices or not<br><span class="hljs-string">&quot;choices&quot;</span>: [&#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;juice&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;æœæ±&quot;</span><br>&#125;, &#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;coffee&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;å’–å•¡&quot;</span><br>&#125;, &#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;tea&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;èŒ¶&quot;</span><br>&#125;] <span class="hljs-regexp">//</span> enumerate groups of value and label<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">!options.multiple: <span class="hljs-keyword">result</span>: &lt;String&gt;<br>options.multiple: <span class="hljs-keyword">result</span>: &lt;<span class="hljs-keyword">Array</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="slider-æ»‘å—ç±»å‹æ»‘å—ç±»å‹"><a class="markdownIt-Anchor" href="#slider-æ»‘å—ç±»å‹æ»‘å—ç±»å‹"></a> slider æ»‘å—ç±»å‹æ»‘å—ç±»å‹</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br><span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;slider&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">10</span> <span class="hljs-regexp">//</span> default value ã€Œé»˜è®¤å€¼ã€<br><span class="hljs-string">&quot;options&quot;</span>: &#123;<br><span class="hljs-string">&quot;step&quot;</span>: <span class="hljs-number">10</span>, <span class="hljs-regexp">//</span> unrequired option, default <span class="hljs-number">0</span><br><span class="hljs-string">&quot;max&quot;</span>: <span class="hljs-number">100</span>, <span class="hljs-regexp">//</span> maximum, default <span class="hljs-number">100</span><br><span class="hljs-string">&quot;min&quot;</span>: <span class="hljs-number">0</span> <span class="hljs-regexp">//</span> minimum, defalut <span class="hljs-number">0</span><br><span class="hljs-string">&quot;precision&quot;</span>: <span class="hljs-number">1</span> <span class="hljs-regexp">//</span> precision, defalut <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">result:</span> &lt;<span class="hljs-type">String</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="switch-å¼€å…³ç±»å‹å¼€å…³ç±»å‹"><a class="markdownIt-Anchor" href="#switch-å¼€å…³ç±»å‹å¼€å…³ç±»å‹"></a> switch å¼€å…³ç±»å‹å¼€å…³ç±»å‹</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;switch&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-comment">// default value ã€Œé»˜è®¤å€¼ã€</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">result</span>: <span class="hljs-operator">&lt;</span><span class="hljs-type">Boolean</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure><h3 id="json-json-ç±»å‹ç±»å‹"><a class="markdownIt-Anchor" href="#json-json-ç±»å‹ç±»å‹"></a> json JSON ç±»å‹ç±»å‹</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br><span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;json&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: &#123;<br><span class="hljs-string">&quot;demo_key&quot;</span>: <span class="hljs-string">&quot;demo_value&quot;</span><br>&#125; <span class="hljs-regexp">//</span> default value ã€Œé»˜è®¤å€¼ã€<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">result</span>: <span class="hljs-operator">&lt;</span><span class="hljs-type">Boolean</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure><h3 id="code-ç¼–è¾‘å™¨ç±»å‹ç¼–è¾‘å™¨ç±»å‹"><a class="markdownIt-Anchor" href="#code-ç¼–è¾‘å™¨ç±»å‹ç¼–è¾‘å™¨ç±»å‹"></a> code ç¼–è¾‘å™¨ç±»å‹ç¼–è¾‘å™¨ç±»å‹</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;code&quot;</span>,<br>    <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;print(&#x27;Hello World!&#x27;)&quot;</span><span class="hljs-regexp">//</span> default value ã€Œé»˜è®¤å€¼ã€<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">result</span>: <span class="hljs-operator">&lt;</span><span class="hljs-type">Boolean</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure><h3 id="screenshot-æˆªå±ç±»å‹æˆªå±ç±»å‹"><a class="markdownIt-Anchor" href="#screenshot-æˆªå±ç±»å‹æˆªå±ç±»å‹"></a> screenshot æˆªå±ç±»å‹æˆªå±ç±»å‹</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#123;<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;screenshot&quot;</span>,<br>    <span class="hljs-string">&quot;value: &quot;&quot; // image path</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">result:</span> &lt;<span class="hljs-type">String</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="uiselector-ui-é€‰æ‹©ç±»å‹é€‰æ‹©ç±»å‹"><a class="markdownIt-Anchor" href="#uiselector-ui-é€‰æ‹©ç±»å‹é€‰æ‹©ç±»å‹"></a> uiselector ui é€‰æ‹©ç±»å‹é€‰æ‹©ç±»å‹</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#123;<br><span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;uiselector&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: &#123;<br><span class="hljs-string">&quot;system&quot;</span>: &#123;<br><span class="hljs-string">&quot;DesktopSize&quot;</span>: <span class="hljs-string">&quot;1920, 960&quot;</span>,<br><span class="hljs-string">&quot;Radio&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;PointInScreen&quot;</span>: <span class="hljs-string">&quot;601, 287&quot;</span>,<br><span class="hljs-string">&quot;PointRelative_X&quot;</span>: <span class="hljs-number">0.31</span>,<br><span class="hljs-string">&quot;PointRelative_Y&quot;</span>: <span class="hljs-number">0</span>.<br>&#125;,<br><span class="hljs-string">&quot;wnd&quot;</span>: &#123;<br><span class="hljs-string">&quot;control_type&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;control_type_name&quot;</span>: <span class="hljs-literal">null</span>,<br><span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-literal">null</span>,<br><span class="hljs-string">&quot;class_name&quot;</span>: <span class="hljs-literal">null</span>,<br><span class="hljs-string">&quot;text&quot;</span>: <span class="hljs-literal">null</span>,<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-literal">null</span>,<br><span class="hljs-string">&quot;rect&quot;</span>: <span class="hljs-string">&quot;0,0,0,0&quot;</span>,<br><span class="hljs-string">&quot;relative_x&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;relative_y&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;main_window_property&quot;</span>: <span class="hljs-literal">null</span><br>&#125;,<br><span class="hljs-string">&quot;html&quot;</span>: &#123;<br><span class="hljs-string">&quot;element&quot;</span>: <span class="hljs-literal">null</span>,<br><span class="hljs-string">&quot;browser&quot;</span>: <span class="hljs-string">&quot;Chrome&quot;</span>,<br><span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br><span class="hljs-string">&quot;tag&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>,<br><span class="hljs-string">&quot;text&quot;</span>: <span class="hljs-string">&quot;åŸºé‡‘æ’è¡Œ&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-literal">null</span>,<br><span class="hljs-string">&quot;xpath&quot;</span>: <span class="hljs-string">&quot;//*[@id=&#x27;body&#x27;]/div/div[4]/div/div/div[1]/div[2]/ul/li[1]/a[3]&quot;</span>,<br><span class="hljs-string">&quot;full_xpath&quot;</span>: <span class="hljs-string">&quot;/html/body/div[2]/div/div[4]/div/div/div[1]/div[2]/ul/li[1]/a[3]&quot;</span>,<br><span class="hljs-string">&quot;frame&quot;</span>: <span class="hljs-literal">null</span>,<br><span class="hljs-string">&quot;left&quot;</span>: <span class="hljs-number">581</span>,<br><span class="hljs-string">&quot;top&quot;</span>: <span class="hljs-number">286</span>,<br><span class="hljs-string">&quot;width&quot;</span>: <span class="hljs-number">48</span>,<br><span class="hljs-string">&quot;height&quot;</span>: <span class="hljs-number">14</span><br>&#125;,<br><span class="hljs-string">&quot;element_screenshot&quot;</span>: <span class="hljs-string">&quot;data:image/png;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAgGBgcGBQgHBwcJCQg</span><br>KDBQNDAsLDBkSEw8UHRofHh0 <span class="hljs-string">&quot;</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable"><span class="hljs-class">result</span></span>: &lt;<span class="hljs-variable"><span class="hljs-class">Object</span></span>&gt;<br></code></pre></td></tr></table></figure><h2 id="å±æ€§ç±»å‹é€šç”¨é…ç½®é¡¹å±æ€§ç±»å‹é€šç”¨é…ç½®é¡¹"><a class="markdownIt-Anchor" href="#å±æ€§ç±»å‹é€šç”¨é…ç½®é¡¹å±æ€§ç±»å‹é€šç”¨é…ç½®é¡¹"></a> å±æ€§ç±»å‹é€šç”¨é…ç½®é¡¹å±æ€§ç±»å‹é€šç”¨é…ç½®é¡¹</h2><h3 id="å±æ€§è¾“å…¥æ¡†è”åŠ¨å±æ€§è¾“å…¥æ¡†è”åŠ¨"><a class="markdownIt-Anchor" href="#å±æ€§è¾“å…¥æ¡†è”åŠ¨å±æ€§è¾“å…¥æ¡†è”åŠ¨"></a> å±æ€§è¾“å…¥æ¡†è”åŠ¨å±æ€§è¾“å…¥æ¡†è”åŠ¨</h3><p>å¦‚æœä½ åœ¨ä½¿ç”¨UiAutoè¿›è¡Œå¼€å‘çš„æ—¶å€™ï¼Œéœ€è¦æ ¹æ®ä½¿ç”¨è€…çš„è¾“å…¥åŠ¨æ€æ¸²æŸ“/éšè—æŸäº›å±æ€§è¾“å…¥æ¡†æˆ–æƒ³å®ç°å…¶ä»–å¤æ‚çš„å…·æœ‰è”åŠ¨éœ€æ±‚çš„è¾“å…¥é…ç½®ï¼Œåˆ™å¯ä»¥é€šè¿‡å‚æ•° â€œshow_ifâ€ è¿›è¡Œé…ç½®ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs dart">&#123;<br><br>...<br><br><span class="hljs-string">&quot;uiauto_config&quot;</span>: &#123;<br><span class="hljs-string">&quot;operations&quot;</span>: [&#123;<br><br>...<br><br><span class="hljs-string">&quot;input&quot;</span>: [&#123;<br><span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;å¿…å¡«å±æ€§&quot;</span>,<br><span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;required_params&quot;</span>,<br><span class="hljs-string">&quot;properties&quot;</span>: [&#123;<br><span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;dishType&quot;</span>,<br><span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;èœå“ç±»å‹&quot;</span>,<br><span class="hljs-string">&quot;required&quot;</span>: <span class="hljs-keyword">true</span>,<br><span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;select&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;single&quot;</span> <span class="hljs-comment">// default value ã€Œé»˜è®¤å€¼ã€</span><br><span class="hljs-string">&quot;options&quot;</span>: &#123;<br><span class="hljs-string">&quot;multiple&quot;</span>: <span class="hljs-keyword">false</span>, <span class="hljs-comment">// required option, could the user make multiple choices or not</span><br><span class="hljs-string">&quot;choices&quot;</span>: [&#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;single&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;å•ç‚¹&quot;</span><br>&#125;, &#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;package&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;å¥—é¤&quot;</span><br>&#125;] <span class="hljs-comment">// enumerate groups of value and label</span><br>&#125;<br>&#125;, &#123;<br><span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;stapleFood&quot;</span>,<br><span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;ä¸»é£Ÿ&quot;</span>,<br><span class="hljs-string">&quot;required&quot;</span>: <span class="hljs-keyword">true</span>,<br><span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;select&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;friedRice&quot;</span> <span class="hljs-comment">// default value ã€Œé»˜è®¤å€¼ã€</span><br><span class="hljs-string">&quot;options&quot;</span>: &#123;<br><span class="hljs-string">&quot;multiple&quot;</span>: <span class="hljs-keyword">false</span>, <span class="hljs-comment">// required option, could the user make multiple choices or not</span><br><span class="hljs-string">&quot;choices&quot;</span>: [&#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;pasta&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;æ„å¤§åˆ©é¢&quot;</span><br>&#125;, &#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;friedRice&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;ç‚’é¥­&quot;</span><br>&#125;, &#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;steak&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;ç‰›æ’&quot;</span><br>&#125;] <span class="hljs-comment">// enumerate groups of value and label</span><br>&#125;<br>&#125;]<br>&#125;, &#123;<br><span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;å¯é€‰å±æ€§&quot;</span>,<br><span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;unrequired_params&quot;</span>,<br><span class="hljs-string">&quot;properties&quot;</span>: [&#123;<br><span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;drink&quot;</span>,<br><span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;é¥®å“&quot;</span>,<br><span class="hljs-string">&quot;show_if&quot;</span>: <span class="hljs-string">&quot;<span class="hljs-subst">$input</span>.required.dishType===&#x27;package&#x27;&quot;</span>,<br><span class="hljs-string">&quot;required&quot;</span>: <span class="hljs-keyword">false</span>,<br><span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;select&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;tea&quot;</span> <span class="hljs-comment">// default value ã€Œé»˜è®¤å€¼ã€</span><br><span class="hljs-string">&quot;options&quot;</span>: &#123;<br><span class="hljs-string">&quot;multiple&quot;</span>: <span class="hljs-keyword">false</span>, <span class="hljs-comment">// required option, could the user make multiple choices or not</span><br><span class="hljs-string">&quot;choices&quot;</span>: [&#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;juice&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;æœæ±&quot;</span><br><br><br>&#125;, &#123;<br><br><br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;coffee&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;å’–å•¡&quot;</span><br>&#125;, &#123;<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;tea&quot;</span>,<br><span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-string">&quot;èŒ¶&quot;</span><br>&#125;] <span class="hljs-comment">// enumerate groups of value and label</span><br>&#125;<br>&#125;]<br>&#125;],<br><span class="hljs-string">&quot;output&quot;</span>: &#123;<br><span class="hljs-string">&quot;is_allow_global_use&quot;</span>: <span class="hljs-keyword">true</span>,<br><span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;è¿”å›æ‰§è¡Œç»“æœï¼Œtrue æˆ–è€… false&quot;</span>,<br><span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>&#125;<br>&#125;]<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç åœ¨å¯é€‰å±æ€§é‡Œå¯¹â€œé¥®å“â€å±æ€§æ¡†é…ç½®äº† â€œshow_ifâ€: â€œ$input.required.dishType===â€˜packageâ€™â€ åˆ™æ§åˆ¶ä¸ºï¼šå½“æœ¬æ’ä»¶è¾“å…¥æ¡†idä¸º â€œrequiredâ€ï¼Œidä¸º â€œdishTypeâ€ çš„è¾“å…¥æ¡†å€¼ä¸º â€œpackageâ€ æ—¶ï¼Œæ˜¾ç¤ºè¯¥å±æ€§é…ç½®ã€‚<br />ç›®å‰ â€œshow_ifâ€ å¯é…ç½®javascriptè§„èŒƒä¸‹çš„è¡¨è¾¾å¼ï¼Œå…¶ä¸­$inputæ˜¯æŒ‡åœ¨æœ¬æ’ä»¶è¾“å…¥å±æ€§ä¸­æŸ¥æ‰¾ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>UiAuto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>UiAuto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|reportlabå®ç°pdfå†…å®¹å¡«å……</title>
    <link href="/2023/04/27/Python_reportlab/"/>
    <url>/2023/04/27/Python_reportlab/</url>
    
    <content type="html"><![CDATA[<p>è¿‘æœŸå› å·¥ä½œéœ€è¦è¦è¿›è¡ŒæŸä¸ªæ‰¿è¯ºä¹¦çš„ç­¾ç½²æ–‡ä»¶ç”Ÿæˆï¼Œéœ€è¦åœ¨å›ºå®šçš„PDFæ¨¡æ¿ä¸Šå¡«å……ä¸Šéƒ¨é—¨ã€å§“åã€æ—¥æœŸä¿¡æ¯ã€‚ä¹‹å‰ä½¿ç”¨è¿‡ç¦æ˜•PDFç¼–è¾‘å™¨ï¼Œä½“éªŒè¾ƒä¸ºä¸é”™ï¼Œä½†è¿™æ¬¡è¦ç”Ÿæˆçš„PDFæ•°é‡æœ‰300ä»½ï¼Œæ‰‹å·¥é€ä¸ªå¤„ç†è‡ªç„¶æ˜¯ä¸ä¾¿çš„ã€‚åœ¨ã€Š<a href="https://hncd1024.github.io/2022/09/05/Python_PDFCut/">Python|PyPDF2å®ç°PDFè‡ªåŠ¨æ‹†åˆ†</a>ã€‹ä¸­æ›¾å†™è¿‡åˆ©ç”¨ PyPDF2 å®ç°PDFæ–‡ä»¶çš„æ‹†åˆ†ï¼Œè¿™æ¬¡æˆ‘ä»¬ç”¨pythonçš„reportlabåº“å°è¯•ä¸‹PDFçš„ç”Ÿæˆã€‚</p><blockquote><p>PDF is the global standard for electronic documents. It supports high-quality printing yet is totally portable across platforms, thanks to the freely available Acrobat Reader. Any application which previously generated hard copy reports or driving a printer can benefit from making PDF documents instead; these can be archived, emailed, placed on the web, or printed out the old-fashioned way. However, the PDF file format is a complex indexed binary format which is impossible to type directly. The PDF format specification is more than 600 pages long and PDF files must provide precise byte offsets â€“ a single extra character placed anywhere in a valid PDF document can render it invalid. This makes it harder to generate than HTML.</p></blockquote><p>PDFæ–‡ä»¶æ ¼å¼æ˜¯ä¸€ç§å¤æ‚çš„ç´¢å¼•äºŒè¿›åˆ¶æ ¼å¼ï¼Œä¸å¯èƒ½ç›´æ¥è¾“å…¥ã€‚ reportlab çš„å¤„ç†é€»è¾‘æ˜¯ç”Ÿæˆä¸€ä¸ªç”»å¸ƒï¼Œé€šè¿‡ç¬›å¡å°”åæ ‡ç³»åœ¨ä½å›¾ä¸Šåˆ›å»ºå…·æœ‰çŸ¢é‡æ ¼å¼çš„æ–‡ä»¶å†…å®¹ï¼Œä¹‹åæ ¹æ®åŠ å·¥åçš„é¡µç åˆ›å»ºä¸€ä¸ªPDFã€‚</p><h2 id="æ€è·¯"><a class="markdownIt-Anchor" href="#æ€è·¯"></a> æ€è·¯</h2><p>å‡†å¤‡å¥½å¾…ç­¾ç½²çš„äººå‘˜æ¸…å•åŠPDFæ¨¡æ¿ï¼Œåˆ†æPDFæ¨¡æ¿ï¼ˆå¾…ç­¾ç½²é¡µç ï¼Œç­¾ç½²åŒºåŸŸï¼‰ï¼Œç”Ÿæˆç­¾ç½²å†…å®¹å¹¶åˆæˆç­¾ç½²é¡µï¼Œåˆæˆå®ŒæˆPDFå¹¶è¾“å‡ºã€‚</p><h3 id="æºç å¦‚ä¸‹"><a class="markdownIt-Anchor" href="#æºç å¦‚ä¸‹"></a> æºç å¦‚ä¸‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfWriter, PdfReader<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">from</span> reportlab.pdfgen <span class="hljs-keyword">import</span> canvas<br><span class="hljs-keyword">from</span> reportlab.lib.pagesizes <span class="hljs-keyword">import</span> letter<br><span class="hljs-keyword">from</span> reportlab.pdfbase.ttfonts <span class="hljs-keyword">import</span> TTFont<br><span class="hljs-keyword">from</span> reportlab.pdfbase <span class="hljs-keyword">import</span> pdfmetrics<br><br>pdfmetrics.registerFont(TTFont(<span class="hljs-string">&#x27;ä»¿å®‹&#x27;</span>, <span class="hljs-string">r&#x27;C:\Windows\Fonts\simfang.ttf&#x27;</span>))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PdfProcess</span>(<span class="hljs-params">pdfInPath,pdfInName,alterPageNumber,dept,username,yearv,monthv,daysv</span>):<br>    <span class="hljs-comment"># åˆ›å»ºPDFæµ</span><br>    packet = io.BytesIO()<br>    can = canvas.Canvas(packet, pagesize=letter)<br>    can.setFillColorRGB(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># å­—ä½“é»‘è‰²</span><br>    can.setFont(<span class="hljs-string">&quot;ä»¿å®‹&quot;</span>, <span class="hljs-number">16</span>)  <span class="hljs-comment"># å­—ä½“æ ·å¼</span><br>    can.drawString(<span class="hljs-number">328</span>, <span class="hljs-number">307</span>, dept)  <span class="hljs-comment"># å¡«å……éƒ¨é—¨</span><br>    can.drawString(<span class="hljs-number">343</span>, <span class="hljs-number">249</span>, username)  <span class="hljs-comment"># å§“å</span><br>    can.drawString(<span class="hljs-number">325</span>, <span class="hljs-number">192</span>, yearv)  <span class="hljs-comment"># å¹´</span><br>    can.drawString(<span class="hljs-number">380</span>, <span class="hljs-number">192</span>, monthv)  <span class="hljs-comment"># æœˆ</span><br>    can.drawString(<span class="hljs-number">420</span>, <span class="hljs-number">192</span>, daysv)  <span class="hljs-comment"># æ—¥</span><br>    can.save()<br> <br>    <span class="hljs-comment"># åˆæˆPDFé¡µé¢</span><br>    packet.seek(<span class="hljs-number">0</span>)<br>    new_pdf = PdfReader(packet)<br>    existing_pdf = PdfReader(<span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(pdfInPath,pdfInName), <span class="hljs-string">&#x27;rb&#x27;</span>))<br>    output = PdfWriter()<br>    page = existing_pdf.pages[alterPageNumber-<span class="hljs-number">1</span>]<br>    page.merge_page(new_pdf.pages[<span class="hljs-number">0</span>])<br><br>    <span class="hljs-comment"># åˆæˆæœ€ç»ˆPDF</span><br>    existing_numPages = <span class="hljs-built_in">len</span>(existing_pdf.pages)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,existing_numPages):<br>        <span class="hljs-keyword">if</span> i == alterPageNumber-<span class="hljs-number">1</span>:<br>            output.add_page(page)<br>        <span class="hljs-keyword">else</span>:<br>            output.add_page(existing_pdf.pages[i])<br>    <br>    <span class="hljs-comment"># è¾“å‡ºæœ€ç»ˆpdf</span><br>    outputStream = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:\Users\admin\Desktop\ç­¾ç½²æ–‡ä»¶ç”Ÿæˆ\&#123;&#125;-&#123;&#125;.pdf&#x27;</span>.<span class="hljs-built_in">format</span>(dept,username), <span class="hljs-string">&quot;wb&quot;</span>)<br>    output.write(outputStream)<br>    outputStream.close()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    pdfInPath = <span class="hljs-string">r&#x27;C:\Users\admin\Desktop\ç­¾ç½²æ–‡ä»¶ç”Ÿæˆ&#x27;</span><br>    pdfInName = <span class="hljs-string">&#x27;æ¨¡æ¿.pdf&#x27;</span><br>    alterPageNumber = <span class="hljs-number">5</span><br>    s = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:\Users\admin\Desktop\ç­¾ç½²æ–‡ä»¶ç”Ÿæˆ\ç­¾ç½²æ¸…å•.txt&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> s:<br>        line = line.split()<br>        dept = line[<span class="hljs-number">0</span>]<br>        username = line[<span class="hljs-number">1</span>]<br>        yearv = line[<span class="hljs-number">2</span>]<br>        monthv = line[<span class="hljs-number">3</span>]<br>        daysv = line[<span class="hljs-number">4</span>]<br>        PdfProcess(pdfInPath,pdfInName,alterPageNumber,dept,username,yearv,monthv,daysv)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;å·²å®Œæˆ&#123;&#125;-&#123;&#125;.pdfçš„ç”Ÿæˆ&#x27;</span>.<span class="hljs-built_in">format</span>(dept,username))<br>    <br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>reportlab çš„ä½“éªŒæ„Ÿè¿˜æ˜¯ä¸é”™çš„ï¼Œè¿™ç§é€šè¿‡ç¬›å¡å°”åæ ‡åˆæˆçš„PDFå¯ä»¥å¾ˆå‡†ç¡®çš„ä½¿å†…å®¹ç”Ÿæˆåˆ°è‡ªå·±æƒ³è¦çš„ä½ç½®ã€‚åæ¥å¤§è‡´ç¿»é˜…äº†å®˜æ–¹æ–‡åº“ï¼ˆ<a href="https://docs.reportlab.com/reportlab/userguide/ch1_intro/">reportlab pdfåº“</a>ï¼‰å‘ç°è¿™ä¸ªåº“åœ¨PDFåˆæˆä¸ŠçœŸçš„æ˜¯ç¥å™¨ï¼Œåœ¨æ–‡æœ¬ï¼ˆé¢œè‰²ã€æ ·å¼ï¼‰ã€å›¾åƒã€æ®µè½ã€è¡¨æ ¼ç­‰æ–¹é¢æ”¯æŒæ€§éƒ½æ¯”è¾ƒé«˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>Pdfè‡ªåŠ¨åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªåŠ¨åŒ–</tag>
      
      <tag>Python</tag>
      
      <tag>Pdf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|å®ç°æ‹›è¡Œå›å•è‡ªåŠ¨ä¸‹è½½</title>
    <link href="/2023/04/13/Python_CMBdownload/"/>
    <url>/2023/04/13/Python_CMBdownload/</url>
    
    <content type="html"><![CDATA[<p>å…³äºseleniumåº“çš„åº”ç”¨æˆ‘åœ¨ã€Š<a href="https://hncd1024.github.io/2022/08/26/Python%20selenium/">Python|seleniumå®ç°è‡ªåŠ¨ç‚¹èµæ”¶è—(è¿›é˜¶ç‰ˆ)</a>ã€‹ä¸­æœ‰å†™è¿‡ï¼Œå› ä¸ºseleniumå¯¹XPATHæœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œæ‰€ä»¥å¯¹è‡ªåŠ¨åŒ–è¿ç»´/çˆ¬è™«çš„åœºæ™¯æ”¯æŒæ¯”è¾ƒç¨³å®šã€‚<br />æ ¹æ®å·¥ä½œéœ€è¦ï¼Œæˆ‘éœ€è¦æ¯å¤©ä¸‹è½½æ‹›è¡Œçš„å›å•ï¼Œä»¥ä¾¿è¿›è¡Œåç»­å¤„ç†ï¼Œæ‰€ä»¥è¿™æ¬¡å°±ç”¨seleniumå®ç°æ‹›è¡Œå›å•çš„è‡ªåŠ¨ä¸‹è½½ã€‚</p><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>é€šè¿‡ä»£ç å…ˆéå†ä¸‹è½½è¿‡å»ä¸€å¹´çš„æ¸…å•ï¼Œä¹‹ååªéœ€è¦é€šè¿‡å®šæ—¶ä»»åŠ¡æ¯å¤©æ™šä¸Šæ‰§è¡Œä¸€æ¬¡è·å–å½“æ—¥æ¸…å•å³å¯ã€‚ä¸‹è½½å®ŒPDFä¹‹åï¼Œæ¯æœˆç»Ÿä¸€è¿›è¡Œä¸€æ¬¡PDFçš„å¤„ç†å³å¯ï¼ˆPDFçš„å¤„ç†å‚è§ï¼šã€Š<a href="https://hncd1024.github.io/2023/04/11/Python_PDFCutByBankacc/">Python|PDFå†…å®¹è¯†åˆ«å¹¶æŒ‰è§„åˆ™æ‹†åˆ†</a>ã€‹ï¼‰<br />å›å•ä¸‹è½½éƒ¨åˆ†å®æµ‹å‘ç°ï¼š</p><ul><li>æ‹›è¡Œç”ŸæˆPDFè¾ƒæ…¢ï¼Œå¤„ç†è¿‡ç¨‹éœ€è¦è¿›è¡Œè¾ƒé•¿æ—¶é—´çš„time.sleep()ã€‚</li><li>å› ä¸ºè´¦æˆ·è¾ƒå¤šï¼Œä¸€æ¬¡æ€§ç”Ÿæˆä¸€å®šåŒºé—´çš„å›å•å®¹æ˜“æŠ¥é”™ï¼Œåªèƒ½é€æ—¥ç”ŸæˆPDFã€‚</li><li>åœ¨å¤„ç†å†å²å›å•ä¸‹è½½æ—¶ï¼Œå› ä¸ºå›å•ä¸‹è½½ç•Œé¢çš„æ—¥æœŸåŒºé—´ä¸ä¾¿è¿›è¡ŒXPATHå®šä½ï¼ˆå…¶å®å¯ä»¥å®šä½çš„ï¼Œåœ¨åé¢çš„æ‹›è¡Œå¯¹è´¦å•ä¸‹è½½éƒ¨åˆ†å®ç°äº†è‡ªåŠ¨è¾“å…¥ğŸ‘»ğŸ‘»ğŸ‘»ï¼‰ï¼Œæ‰€ä»¥é€šè¿‡os.systemä¿®æ”¹è®¡ç®—æœºæ—¶é—´ï¼Œä»è€Œå®ç°å›å•ä¸‹è½½ç•Œé¢è‡ªåŠ¨å¡«å……ä¸ºç›®æ ‡æ—¶é—´ã€‚ä½†è¿™æ ·åˆæœ‰å‡ ä¸ªå°é—®é¢˜ï¼š<ul><li>ä¸‹è½½ä¸€æ¬¡å°±è¦é‡æ–°ç™»å½•ä¸€æ¬¡ï¼Œæ¯”è¾ƒç¹çã€‚</li><li>æµè§ˆå™¨å®¹æ˜“æç¤ºæ—¶é’Ÿé”™è¯¯ï¼Œä»è€Œæ‰“ä¸å¼€ç™»å½•é¡µï¼ˆå¶å‘é—®é¢˜ï¼Œå‡ºç°è¿‡å‡ æ¬¡ï¼‰ã€‚</li></ul></li></ul><h2 id="ä¸‹è½½æ‹›è¡Œå›å•ä»£ç "><a class="markdownIt-Anchor" href="#ä¸‹è½½æ‹›è¡Œå›å•ä»£ç "></a> ä¸‹è½½æ‹›è¡Œå›å•ä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    ä¸‹è½½æ‹›è¡Œå›å•ï¼ˆæŒ‰æœˆä¸‹è½½ï¼‰ï¼Œæ¯å¤©æ‰§è¡Œä¸€æ¬¡ï¼Œä¸‹è½½æ˜¨å¤©çš„å›å•ã€‚</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.edge.service <span class="hljs-keyword">import</span> Service<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> loguru <span class="hljs-keyword">import</span> logger<br><br><span class="hljs-comment"># æ—¥å¿—è®°å½•</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fileLog</span>():<br>    FileLog= <span class="hljs-string">&#x27;cmb.log&#x27;</span><br>    logger.add(FileLog,rotation=<span class="hljs-string">&#x27;500MB&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>,enqueue=<span class="hljs-literal">True</span>)<br><br><span class="hljs-comment"># æ‰§è¡Œä¸‹è½½</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">queryData2</span>():<br>    logger.info(<span class="hljs-string">&#x27;ç‚¹å‡»é“¶è¡Œå›æ‰§æ‰¹é‡å¯¼å‡º&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[text()=&quot;é“¶è¡Œå›æ‰§æ‰¹é‡å¯¼å‡º&quot;]&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">2</span>)<br>    <span class="hljs-comment"># driver.find_element(By.XPATH,r&#x27;//div[@class=&quot;ccspSInput el-input el-input--small noBorder&quot;]&#x27;).click() # æ‰“å¼€é¡¹ç›®ä¸‹æ‹‰èœå•</span><br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;yhhzDia&quot;]/div/div/div[2]/div/div[2]/div[2]/div/div/div/div/input&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">2</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;checkAllBox&quot;]/span[1]/label/span[1]&#x27;</span>).click() <span class="hljs-comment"># å…¨é€‰</span><br>    time.sleep(<span class="hljs-number">5</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;ç¡®å®š&quot;]&#x27;</span>).click() <span class="hljs-comment"># ç¡®å®š</span><br>    time.sleep(<span class="hljs-number">2</span>)<br>    logger.info(<span class="hljs-string">&#x27;å…¨é€‰æ‰€æœ‰é¡¹ç›®æˆåŠŸ&#x27;</span>)<br>    <span class="hljs-comment"># driver.find_element(By.XPATH,&#x27;//div[@class=&quot;yhhzDia&quot;]/div/div/div[2]/div/div[3]/div[2]/div/i[@class=&quot;el-input__icon el-range__icon el-icon-date&quot;]&#x27;).click() # ç‚¹å‡»æ—¥å†</span><br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;åˆ é™¤&quot;]&#x27;</span>).click() <span class="hljs-comment"># åˆ é™¤ä¸Šæ¬¡å·²æœ‰çš„</span><br>    time.sleep(<span class="hljs-number">2</span>)<br>    logger.info(<span class="hljs-string">&#x27;åˆ é™¤ä¸Šæ¬¡å·²ç”ŸæˆPDFæˆåŠŸ&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//button[@class=&quot;el-button btn-css el-button--default el-button--small&quot;]&#x27;</span>).click() <span class="hljs-comment"># ç”ŸæˆPDF</span><br>    time.sleep(<span class="hljs-number">120</span>)<br>    logger.info(<span class="hljs-string">&#x27;ç”ŸæˆPDFæˆåŠŸ&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;ä¸‹è½½&quot;]&#x27;</span>).click() <span class="hljs-comment"># ä¸‹è½½æ–°ç”Ÿæˆçš„</span><br>    time.sleep(<span class="hljs-number">10</span>)<br>    logger.info(<span class="hljs-string">&#x27;ä¸‹è½½æˆåŠŸ&#x27;</span>)<br><br><span class="hljs-comment"># ç™»å½•ç½‘é¡µ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    logger.info(<span class="hljs-string">&#x27;æ‰“å¼€ç½‘é¡µ&#x27;</span>)<br>    time.sleep(<span class="hljs-number">5</span>)<br>    driver.maximize_window()<br>    driver.get(<span class="hljs-string">r&#x27;https://custody.ebank.cmbchina.com/ccsp/Web/index.html#/login/entrance&#x27;</span>)<br>    time.sleep(<span class="hljs-number">5</span>)<br>    logger.info(<span class="hljs-string">&#x27;UKeyç™»å½•&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//i[text()=&quot;UKeyç™»å½•&quot;]&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">2</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;pw_ukey&quot;]/div/div&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">1</span>)<br>    pwd = driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;pw_ukey&quot;]/div/div&#x27;</span>)<br>    pwd.send_keys(<span class="hljs-string">&#x27;***&#x27;</span>) <span class="hljs-comment"># password</span><br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;bottom_btn ready&quot;]/span&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">20</span>)<br>    logger.info(<span class="hljs-string">&#x27;ç½‘é¡µç™»å½•æˆåŠŸ&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;å›å•æ‰“å°&quot;][1]&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">1</span>)<br>    logger.info(<span class="hljs-string">&#x27;è¿›å…¥å›å•æ‰“å°&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    fileLog()<br>    logger.info(<span class="hljs-string">&#x27;***********æ‹›è¡Œå›å•ä¸‹è½½å¼€å§‹*************&#x27;</span>)<br>    s = Service(<span class="hljs-string">r&#x27;F:\\workspace\\msedgedriver.exe&#x27;</span>)<br><br>    <span class="hljs-comment"># æŒ‰ç…§å½“å‰æ—¥æœŸè·å–</span><br>    day = datetime.date.today()<br>    logger.info(<span class="hljs-string">&#x27;-------å¼€å§‹å¤„ç†&#123;&#125;æ—¥-------&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(day)))<br>    driver = webdriver.Edge(service=s)<br>    login()<br>    queryData2()<br>    driver.quit()<br>    logger.info(<span class="hljs-string">&#x27;-------&#123;&#125;æ—¥å¤„ç†å®Œæˆ-------&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(day)))<br><br>    <span class="hljs-comment"># # æŒ‰ç…§æ—¥æœŸåŒºé—´éå†ä¸‹è½½</span><br>    <span class="hljs-comment"># begin = datetime.date(2023,4,1)</span><br>    <span class="hljs-comment"># end = datetime.date(2023,4,12)</span><br>    <span class="hljs-comment"># for i in range((end-begin).days+1):</span><br>    <span class="hljs-comment">#     day = begin + datetime.timedelta(days=i)</span><br>    <span class="hljs-comment">#     logger.info(&#x27;-------å¼€å§‹å¤„ç†&#123;&#125;æ—¥-------&#x27;.format(str(day)))</span><br>    <span class="hljs-comment">#     os.system(&#x27;date &#123;&#125;&#x27;.format(str(day)))</span><br>    <span class="hljs-comment">#     logger.info(&#x27;ä¿®æ”¹ç³»ç»Ÿæ—¥æœŸæˆåŠŸ&#x27;)</span><br>    <span class="hljs-comment">#     time.sleep(8)</span><br>    <span class="hljs-comment">#     driver = webdriver.Edge(service=s)</span><br>    <span class="hljs-comment">#     login()</span><br>    <span class="hljs-comment">#     queryData2()</span><br>    <span class="hljs-comment">#     driver.quit()</span><br>    <span class="hljs-comment">#     logger.info(&#x27;-------&#123;&#125;æ—¥å¤„ç†å®Œæˆ-------&#x27;.format(str(day)))</span><br></code></pre></td></tr></table></figure><h2 id="ä¸‹è½½æ‹›è¡Œå¯¹è´¦å•ä»£ç "><a class="markdownIt-Anchor" href="#ä¸‹è½½æ‹›è¡Œå¯¹è´¦å•ä»£ç "></a> ä¸‹è½½æ‹›è¡Œå¯¹è´¦å•ä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    ä¸‹è½½æ‹›è¡Œå¯¹è´¦å•ï¼ˆæŒ‰æœˆä¸‹è½½ï¼‰ï¼Œæ¯æœˆæ‰§è¡Œä¸€æ¬¡ï¼Œä¸‹è½½ä¸Šä¸ªæœˆçš„å¯¹è´¦å•ã€‚</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.edge.service <span class="hljs-keyword">import</span> Service<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> loguru <span class="hljs-keyword">import</span> logger<br><br><span class="hljs-comment"># æ—¥å¿—è®°å½•</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fileLog</span>():<br>    FileLog= <span class="hljs-string">&#x27;cmb.log&#x27;</span><br>    logger.add(FileLog,rotation=<span class="hljs-string">&#x27;500MB&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>,enqueue=<span class="hljs-literal">True</span>)<br><br><span class="hljs-comment"># è·å–ä¸Šæœˆç¬¬ä¸€å¤©å’Œæœ€åä¸€å¤©</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getLastMonthStartAndEnd</span>():<br>    today = datetime.date.today()<br>    lastMonthEnd = datetime.date(today.year,today.month,<span class="hljs-number">1</span>)-datetime.timedelta(<span class="hljs-number">1</span>)<br>    lastMonthStart = datetime.date(lastMonthEnd.year,lastMonthEnd.month,<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> lastMonthStart,lastMonthEnd<br><br><span class="hljs-comment"># æ‰§è¡Œä¸‹è½½</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">queryData2</span>(<span class="hljs-params">bdate,edate</span>):<br>    logger.info(<span class="hljs-string">&#x27;ç‚¹å‡»å¯¹è´¦å•æ‰“å°&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[text()=&quot;å¯¹è´¦å•æ‰“å°&quot;]&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">2</span>)<br>    <span class="hljs-comment"># driver.find_element(By.XPATH,r&#x27;//div[@class=&quot;ccspSInput el-input el-input--small noBorder&quot;]&#x27;).click() # æ‰“å¼€é¡¹ç›®ä¸‹æ‹‰èœå•</span><br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;/html/body/div[1]/div/div[1]/div[2]/div[2]/div/div[8]/div/div[2]/div[1]/div[2]/div/div/div/div/div/input&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">2</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//*[@id=&quot;zxc&quot;]/div/div[2]/div/div[1]/div/span[1]/label/span[1]/span&#x27;</span>).click() <span class="hljs-comment"># å…¨é€‰</span><br>    time.sleep(<span class="hljs-number">5</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;ç¡®å®š&quot;]&#x27;</span>).click() <span class="hljs-comment"># ç¡®å®š</span><br>    time.sleep(<span class="hljs-number">2</span>)<br>    logger.info(<span class="hljs-string">&#x27;å…¨é€‰æ‰€æœ‰é¡¹ç›®æˆåŠŸ&#x27;</span>)<br>    time.sleep(<span class="hljs-number">2</span>)<br>    logger.info(<span class="hljs-string">&#x27;å¡«å†™å¼€å§‹æ—¥æœŸ&#x27;</span>)<br>    begindate = driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//*[@id=&quot;lyContentIn&quot;]/div/div[8]/div/div[2]/div[1]/div[4]/div/div/input[1]&#x27;</span>)<br>    begindate.send_keys(Keys.CONTROL,<span class="hljs-string">&#x27;a&#x27;</span>)<br>    begindate.send_keys(bdate)<br>    time.sleep(<span class="hljs-number">2</span>)<br>    logger.info(<span class="hljs-string">&#x27;å¡«å†™ç»“æŸæ—¥æœŸ&#x27;</span>)<br>    enddate = driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//*[@id=&quot;lyContentIn&quot;]/div/div[8]/div/div[2]/div[1]/div[4]/div/div/input[2]&#x27;</span>)<br>    enddate.send_keys(Keys.CONTROL,<span class="hljs-string">&#x27;a&#x27;</span>)<br>    enddate.send_keys(edate) <br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//*[@id=&quot;lyContentIn&quot;]/div/div[8]/div/div[1]/span&#x27;</span>).click()  <br>    time.sleep(<span class="hljs-number">2</span>)<br>    <span class="hljs-comment"># driver.find_element(By.XPATH,&#x27;//div[@class=&quot;yhhzDia&quot;]/div/div/div[2]/div/div[3]/div[2]/div/i[@class=&quot;el-input__icon el-range__icon el-icon-date&quot;]&#x27;).click() # ç‚¹å‡»æ—¥å†</span><br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//*[@id=&quot;lyContentIn&quot;]/div/div[8]/div/div[2]/div[3]/div[2]/div/div/div/div[2]/div[2]/span[2]&#x27;</span>).click() <span class="hljs-comment"># åˆ é™¤ä¸Šæ¬¡å·²æœ‰çš„</span><br>    time.sleep(<span class="hljs-number">2</span>)<br>    logger.info(<span class="hljs-string">&#x27;åˆ é™¤ä¸Šæ¬¡å·²ç”ŸæˆPDFæˆåŠŸ&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//*[@id=&quot;lyContentIn&quot;]/div/div[8]/div/div[2]/div[2]/button&#x27;</span>).click() <span class="hljs-comment"># ç”ŸæˆPDF</span><br>    time.sleep(<span class="hljs-number">300</span>)<br>    logger.info(<span class="hljs-string">&#x27;ç”ŸæˆPDFæˆåŠŸ&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//*[@id=&quot;lyContentIn&quot;]/div/div[8]/div/div[2]/div[3]/div[2]/div/div/div/div[2]/div[2]/span[1]&#x27;</span>).click() <span class="hljs-comment"># ä¸‹è½½æ–°ç”Ÿæˆçš„</span><br>    time.sleep(<span class="hljs-number">80</span>)<br>    logger.info(<span class="hljs-string">&#x27;ä¸‹è½½æˆåŠŸ&#x27;</span>)<br><br><span class="hljs-comment"># ç™»å½•ç½‘é¡µ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    logger.info(<span class="hljs-string">&#x27;æ‰“å¼€ç½‘é¡µ&#x27;</span>)<br>    time.sleep(<span class="hljs-number">5</span>)<br>    driver.maximize_window()<br>    driver.get(<span class="hljs-string">r&#x27;https://custody.ebank.cmbchina.com/ccsp/Web/index.html#/login/entrance&#x27;</span>)<br>    time.sleep(<span class="hljs-number">5</span>)<br>    logger.info(<span class="hljs-string">&#x27;UKeyç™»å½•&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//i[text()=&quot;UKeyç™»å½•&quot;]&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">2</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;pw_ukey&quot;]/div/div&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">1</span>)<br>    pwd = driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;pw_ukey&quot;]/div/div&#x27;</span>)<br>    pwd.send_keys(<span class="hljs-string">&#x27;******&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;bottom_btn ready&quot;]/span&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">20</span>)<br>    logger.info(<span class="hljs-string">&#x27;ç½‘é¡µç™»å½•æˆåŠŸ&#x27;</span>)<br>    driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;å›å•æ‰“å°&quot;][1]&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">1</span>)<br>    logger.info(<span class="hljs-string">&#x27;è¿›å…¥å›å•æ‰“å°&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    fileLog()<br>    logger.info(<span class="hljs-string">&#x27;***********æ‹›è¡Œå¯¹è´¦å•ä¸‹è½½å¼€å§‹*************&#x27;</span>)<br>    s = Service(<span class="hljs-string">r&#x27;F:\\workspace\\msedgedriver.exe&#x27;</span>)<br>    first,end = getLastMonthStartAndEnd()<br>    first = <span class="hljs-built_in">str</span>(first)<br>    end = <span class="hljs-built_in">str</span>(end)<br>    logger.info(<span class="hljs-string">&#x27;-------å¼€å§‹å¤„ç†&#123;&#125;æ‹›è¡Œå¯¹è´¦å•-------&#x27;</span>.<span class="hljs-built_in">format</span>(first+<span class="hljs-string">&#x27;è‡³&#x27;</span>+end))<br>    driver = webdriver.Edge(service=s)<br>    login()<br>    queryData2(first,end)<br>    driver.quit()<br>    logger.info(<span class="hljs-string">&#x27;-------&#123;&#125;æ‹›è¡Œå¯¹è´¦å•å¤„ç†å®Œæˆ-------&#x27;</span>.<span class="hljs-built_in">format</span>(first+<span class="hljs-string">&#x27;è‡³&#x27;</span>+end))<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>selenium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªåŠ¨åŒ–</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|PDFå†…å®¹è¯†åˆ«å¹¶æŒ‰è§„åˆ™æ‹†åˆ†</title>
    <link href="/2023/04/11/Python_PDFCutByBankacc/"/>
    <url>/2023/04/11/Python_PDFCutByBankacc/</url>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a class="markdownIt-Anchor" href="#èƒŒæ™¯"></a> èƒŒæ™¯</h2><p>ä»æ‹›è¡ŒæŒ‰æ—¥ä¸‹è½½çš„PDFå›å•ï¼Œæ•°é‡å¤§åˆ°å¯èƒ½æœ‰å‡ ç™¾é¡µï¼Œæ¯é¡µåªæœ‰è´¦å·/é‡‘é¢/æ‘˜è¦/ç±»å‹ç­‰å­—æ®µï¼Œä½†å´è¦æ±‚æŒ‰ç…§é¡¹ç›®åˆ†ç±»æå–å‡ºæ¥ã€‚ä½ ä¼šæ€ä¹ˆåšï¼Ÿ<br />æˆ‘æƒ³åˆ°çš„æ–¹æ¡ˆæ˜¯ï¼šé€é¡µè§£æPDFå†…å®¹ï¼Œæ ¹æ®ç±»å‹å–æ”¶æ¬¾/ä»˜æ¬¾é“¶è¡Œè´¦å· â†’ æ ¹æ®è´¦å·æŸ¥è¯¢åˆ°å¯¹åº”çš„é¡¹ç›® â†’ æ ¹æ®é¡¹ç›®åˆ›å»ºæ–‡ä»¶å¤¹ â†’ æŒ‰é“¶è¡Œè´¦æˆ·åˆ†ç±»æ‹†åˆ†PDFï¼Œå­˜å…¥å¯¹åº”çš„é¡¹ç›®æ–‡ä»¶å¤¹ã€‚å…·ä½“é€»è¾‘å¦‚ä¸‹ï¼š<br /><img src="https://postimg.cc/c6nsBjdm" alt="å¤„ç†é€»è¾‘" /><br />å¤„ç†åçš„æ–‡ä»¶å¤¹æ•ˆæœå¦‚ä¸‹ï¼š</p><ul><li>666-Aé¡¹ç›®<ul><li>20230101-666-Aé¡¹ç›®.pdf</li><li>20230102-666-Aé¡¹ç›®.pdf</li></ul></li><li>888-Bé¡¹ç›®<ul><li>20230101-888-Bé¡¹ç›®.pdf</li><li>20230106-888-Bé¡¹ç›®.pdf</li><li>20230108-888-Bé¡¹ç›®.pdf</li></ul></li></ul><h2 id="ä»£ç "><a class="markdownIt-Anchor" href="#ä»£ç "></a> ä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader, PdfWriter<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> sqlite3<br><span class="hljs-keyword">import</span> shutil<br><span class="hljs-keyword">from</span> loguru <span class="hljs-keyword">import</span> logger<br><span class="hljs-keyword">import</span> datetime<br><br><span class="hljs-comment"># æŸ¥è¯¢é¡¹ç›®ç¼–å·åŠç®€ç§°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">productQuery</span>(<span class="hljs-params">bank_acct</span>):<br>    logger.info(<span class="hljs-string">&#x27;----æŸ¥è¯¢é¡¹ç›®ç¼–å·åŠç®€ç§°ï¼š&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(bank_acct))<br>    productCode = <span class="hljs-string">&#x27;&#x27;</span><br>    productName = <span class="hljs-string">&#x27;&#x27;</span><br>    conn = sqlite3.connect(<span class="hljs-string">r&#x27;\\**********.db&#x27;</span>) <br>    c = conn.cursor()<br>    querySql = c.execute(<span class="hljs-string">&quot;select bank_acct,product_code,product_jc from trust_product_bank where bank_acct=?&quot;</span>,(bank_acct,))<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> querySql:<br>        productCode = row[<span class="hljs-number">1</span>]<br>        productName = row[<span class="hljs-number">2</span>]<br>    conn.close()<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(productCode) == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ä¿éšœåŸºé‡‘&#x27;</span><br>    <span class="hljs-keyword">else</span> :<br>        <span class="hljs-keyword">return</span> productCode+<span class="hljs-string">&#x27;-&#x27;</span>+productName<br><br><span class="hljs-comment"># æ‹†åˆ†pdf</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_split</span>(<span class="hljs-params">pdf_in,pdf_out,<span class="hljs-built_in">list</span></span>):<br>    output = PdfWriter()<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_in, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> in_pdf:<br>        pdf_file = PdfReader(in_pdf)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>:<br>            output.add_page(pdf_file.pages[i])<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_out, <span class="hljs-string">&#x27;ab&#x27;</span>) <span class="hljs-keyword">as</span> out_pdf:<br>            output.write(out_pdf)<br><br><span class="hljs-comment"># è·å–PDFæ¸…å•</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getPdfList</span>(<span class="hljs-params">filepath,filemonth</span>):<br>    dirlist = [] <span class="hljs-comment"># å¾…å¤„ç†pdfæ¸…å•</span><br>    <span class="hljs-keyword">try</span> :<br>        listDir = os.listdir(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth))<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æœªæ‰¾åˆ°å¯¹åº”çš„ç›®å½•&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> <span class="hljs-built_in">dir</span> <span class="hljs-keyword">in</span> listDir:<br>            <span class="hljs-keyword">if</span> os.path.splitext(<span class="hljs-built_in">dir</span>)[<span class="hljs-number">1</span>] == <span class="hljs-string">r&#x27;.pdf&#x27;</span>:<br>                dirlist.append(<span class="hljs-built_in">dir</span>)<br>        <span class="hljs-keyword">return</span> dirlist<br><br><span class="hljs-comment"># è·å–æ–‡ä»¶é¡µæ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_reader</span>(<span class="hljs-params">pdf_in</span>):<br>    pdf_file = PdfReader(pdf_in)<br>    pages = <span class="hljs-built_in">len</span>(pdf_file.pages)<br>    <span class="hljs-keyword">return</span> pages<br>    <br><span class="hljs-comment"># è·å–é¡µé¢å†…å®¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_content</span>(<span class="hljs-params">pdf_in,page</span>):<br>    pdf_page = PdfReader(pdf_in)<br>    page = pdf_page.pages[page]<br>    <span class="hljs-keyword">return</span> page.extract_text()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    filepath = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆæ‰€åœ¨æœˆä»½æ–‡ä»¶å¤¹çˆ¶ç›®å½•ï¼‰ï¼š&#x27;</span>)<br>    filemonth = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥å¤„ç†æœˆä»½ï¼ˆæ ¼å¼ï¼š202301ï¼‰ï¼š&#x27;</span>)<br>    <span class="hljs-comment"># åˆ›å»ºæ—¥å¿—å¯¹è±¡</span><br>    FileLog = <span class="hljs-string">&#x27;&#123;&#125;\Pdflog&#123;&#125;.log&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,datetime.date.today())<br>    logger.add(FileLog,rotation=<span class="hljs-string">&quot;500MB&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>, enqueue=<span class="hljs-literal">True</span>)<br>    pat10 = <span class="hljs-string">r&#x27;å­˜æ¬¾åˆ©æ¯æ”¶å…¥å›å•&#x27;</span> <span class="hljs-comment"># è·å–ä¸šåŠ¡ç±»å‹      (?&lt;=ä¸šåŠ¡ç±»å‹ï¼š)[\u4e00-\u9fa5]&#123;4&#125;</span><br>    pat11 = <span class="hljs-string">r&#x27;å…¥è´¦å›å•&#x27;</span> <span class="hljs-comment"># è·å–ä¸šåŠ¡ç±»å‹</span><br>    pat12 = <span class="hljs-string">r&#x27;å‡ºè´¦å›å•&#x27;</span><br>    pat13 = <span class="hljs-string">r&#x27;å®šæœŸæ”¶è´¹å›å•&#x27;</span><br>    pat14 = <span class="hljs-string">r&#x27;åè®®åˆ©ç‡åˆ©æ¯æ”¶å…¥å›å•&#x27;</span><br>    pat15 = <span class="hljs-string">r&#x27;å¯¹å…¬ä¸šåŠ¡æ”¶è´¹å›å•&#x27;</span><br>    pat2 = <span class="hljs-string">r&#x27;(?&lt;=æ”¶æ¬¾è´¦å·ï¼š)[0-9]&#123;1,30&#125;&#x27;</span> <span class="hljs-comment"># è·å–æ”¶æ¬¾è´¦å·  (?&lt;=æ”¶æ¬¾è´¦å·ï¼š).*?(?=æ”¶æ¬¾äºº)</span><br>    pat3 = <span class="hljs-string">r&#x27;(?&lt;=ä»˜æ¬¾è´¦å·ï¼š)[0-9]&#123;1,30&#125;&#x27;</span> <span class="hljs-comment"># è·å–ä»˜æ¬¾è´¦å·  (?&lt;=ä»˜æ¬¾è´¦å·ï¼š).*?(?=ä»˜æ¬¾äºº)</span><br>    pat4 = <span class="hljs-string">r&#x27;(?&lt;=æ‰£è´¹è´¦å·ï¼š)[0-9]&#123;1,30&#125;&#x27;</span><br>    pat5 = <span class="hljs-string">r&#x27;(?&lt;=å®¢æˆ·è´¦å·ï¼š)[0-9]&#123;1,30&#125;&#x27;</span><br>    logger.info(<span class="hljs-string">&#x27;----è·å–&#123;&#125;ä¸‹çš„pdfæ¸…å•&#x27;</span>.<span class="hljs-built_in">format</span>(filemonth))<br>    pdflist = getPdfList(filepath,filemonth)<br>    logger.info(<span class="hljs-string">&#x27;----è·å–pdfæ¸…å•:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(pdflist)))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> pdflist:<br>        logger.info(<span class="hljs-string">&#x27;----å¼€å§‹å¤„ç†æ–‡ä»¶:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>        ywlx = []<br>        skzh = []<br>        fkzh = []<br>        bankAll = []<br>        logger.info(<span class="hljs-string">&#x27;----è¯»å–æ–‡ä»¶å†…å®¹&#x27;</span>)<br>        filepage = pdf_reader(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth,i))<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,filepage):<br>            contents = pdf_content(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth,i),j).replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(contents) == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-comment"># ä¸šåŠ¡ç±»å‹ </span><br>            <span class="hljs-keyword">try</span> :<br>                re.findall(pat10,contents)[<span class="hljs-number">0</span>]<br>            <span class="hljs-keyword">except</span> IndexError:<br>                <span class="hljs-keyword">try</span> :<br>                    re.findall(pat11,contents)[<span class="hljs-number">0</span>]<br>                <span class="hljs-keyword">except</span> IndexError:<br>                    <span class="hljs-keyword">try</span> :<br>                        re.findall(pat12,contents)[<span class="hljs-number">0</span>]<br>                    <span class="hljs-keyword">except</span> IndexError:<br>                        <span class="hljs-keyword">try</span> :<br>                            re.findall(pat13,contents)[<span class="hljs-number">0</span>]<br>                        <span class="hljs-keyword">except</span> IndexError:<br>                            <span class="hljs-keyword">try</span> :<br>                                re.findall(pat14,contents)[<span class="hljs-number">0</span>]<br>                            <span class="hljs-keyword">except</span> IndexError:<br>                                ywlx.append(re.findall(pat15,contents)[<span class="hljs-number">0</span>])<br>                            <span class="hljs-keyword">else</span>:<br>                                ywlx.append(re.findall(pat14,contents)[<span class="hljs-number">0</span>])<br>                        <span class="hljs-keyword">else</span> :<br>                            ywlx.append(re.findall(pat13,contents)[<span class="hljs-number">0</span>])<br>                    <span class="hljs-keyword">else</span>:<br>                        ywlx.append(re.findall(pat12,contents)[<span class="hljs-number">0</span>])<br>                <span class="hljs-keyword">else</span>:<br>                    ywlx.append(re.findall(pat11,contents)[<span class="hljs-number">0</span>])<br>            <span class="hljs-keyword">else</span> :<br>                ywlx.append(re.findall(pat10,contents)[<span class="hljs-number">0</span>])<br>            <span class="hljs-comment"># è·å–æ”¶æ¬¾/ä»˜æ¬¾è´¦æˆ·</span><br>            <span class="hljs-keyword">if</span> ywlx[j] == pat11:<br>                bankAll.append(re.findall(pat2,contents)[<span class="hljs-number">0</span>])<br>            <span class="hljs-keyword">elif</span> ywlx[j] == pat10:<br>                bankAll.append(re.findall(pat2,contents)[<span class="hljs-number">0</span>])<br>            <span class="hljs-keyword">elif</span> ywlx[j] == pat12:<br>                bankAll.append(re.findall(pat3,contents)[<span class="hljs-number">0</span>])<br>            <span class="hljs-keyword">elif</span> ywlx[j] == pat13:<br>                bankAll.append(re.findall(pat4,contents)[<span class="hljs-number">0</span>])<br>            <span class="hljs-keyword">elif</span> ywlx[j] == pat14:<br>                bankAll.append(re.findall(pat2,contents)[<span class="hljs-number">0</span>])<br>            <span class="hljs-keyword">elif</span> ywlx[j] == pat15:<br>                bankAll.append(re.findall(pat5,contents)[<span class="hljs-number">0</span>])<br>        logger.info(<span class="hljs-string">&#x27;----å®Œæˆæ”¶ä»˜æ¬¾ç±»å‹ã€é“¶è¡Œè´¦å·æå–&#x27;</span>)<br>        logger.info(<span class="hljs-string">&#x27;----å»é‡é“¶è¡Œè´¦å·&#x27;</span>)<br>        bankDistinct = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(bankAll)) <span class="hljs-comment"># å»é‡é“¶è¡Œè´¦å·ï¼Œç­›é€‰æ–‡ä»¶æ€»æ•°é‡</span><br>        <span class="hljs-comment"># æŒ‰ç…§é“¶è¡Œè´¦å·åˆ†ç±»æå–PDFé¡µé¢</span><br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(bankDistinct)) :<br>            <span class="hljs-comment"># åˆ›å»ºæ–‡ä»¶å¤¹</span><br>            logger.info(<span class="hljs-string">&#x27;----æ ¹æ®é“¶è¡Œè´¦å·æŸ¥è¯¢é¡¹ç›®ï¼Œå¹¶æ£€æŸ¥å­æ–‡ä»¶å¤¹&#x27;</span>)<br>            productDirname = productQuery(bankDistinct[k])<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth,productDirname)):<br>                os.mkdir(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth,productDirname))<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\000åŸå§‹æ–‡ä»¶&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth)):<br>                os.mkdir(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\000åŸå§‹æ–‡ä»¶&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth))<br>            logger.info(<span class="hljs-string">&#x27;----æŒ‰é“¶è¡Œè´¦å·æå–pdfé¡µé¢&#x27;</span>)<br>            pages = [m <span class="hljs-keyword">for</span> m ,n <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(bankAll) <span class="hljs-keyword">if</span> n <span class="hljs-keyword">is</span> bankDistinct[k]]<br>            pdf_in = <span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth,i)<br>            pdf_out = <span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth,productDirname,<span class="hljs-string">&#x27;&#123;&#125;-&#123;&#125;.pdf&#x27;</span>.<span class="hljs-built_in">format</span>(i[-<span class="hljs-number">13</span>:-<span class="hljs-number">5</span>],productDirname))<br>            pdf_split(pdf_in,pdf_out,pages)<br>            logger.info(<span class="hljs-string">&#x27;----æ‹†åˆ†pdfå®Œæˆ&#x27;</span>)<br>        shutil.move(<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth,i),<span class="hljs-string">r&#x27;&#123;&#125;\&#123;&#125;\000åŸå§‹æ–‡ä»¶&#x27;</span>.<span class="hljs-built_in">format</span>(filepath,filemonth))<br>        logger.info(<span class="hljs-string">&#x27;----å°†å·²å¤„ç†pdfç§»è‡³å·²å¤„ç†æ–‡ä»¶å¤¹&#x27;</span>)<br>        logger.info(<span class="hljs-string">&#x27;----&#123;&#125;æ–‡ä»¶å¤„ç†å®Œæˆ&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>    logger.info(<span class="hljs-string">&#x27;----&#123;&#125;å¤„ç†ç»“æŸ&#x27;</span>.<span class="hljs-built_in">format</span>(filemonth))<br><br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>éªŒè¯æ•ˆæœæ¯”è¾ƒç¨³å®šï¼Œå®Œå…¨æ»¡è¶³ä½¿ç”¨éœ€è¦ã€‚å³ä¾¿å¯¹äºå¤§å‹PDFæ–‡ä»¶ï¼ˆ150Mä»¥ä¸Šï¼‰å¤„ç†è¾ƒæ…¢ï¼Œä½†è¿™ä¹ˆå¤§çš„æ–‡ä»¶ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥å¿«èµ·æ¥å§ğŸ¤£</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>PyPDF2</category>
      
      <category>shutil</category>
      
      <category>os</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>shutil</tag>
      
      <tag>PyPDF2</tag>
      
      <tag>os</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|å®ç°NBUè‡ªåŠ¨å·¡æ£€</title>
    <link href="/2023/04/09/Python_NBU5230/"/>
    <url>/2023/04/09/Python_NBU5230/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ã€Š<a href="https://hncd1024.github.io/2022/04/25/Kettle-%E8%87%AA%E5%8A%A9%E5%B7%A1%E6%A3%80/">Kettle|è‡ªåŠ©å·¡æ£€</a>ã€‹ä¸­ï¼Œæˆ‘æ›¾åˆ©ç”¨ETLå·¥å…·å®ç°äº†é™¤æ•°æ®åº“å¤‡ä»½æ£€æŸ¥ä¹‹å¤–çš„æ¯æ—¥å·¡æ£€å·¥ä½œï¼Œè¿™ä¸€ç¯‡èŠèŠNBUå¤‡ä»½å·¡æ£€è‡ªåŠ¨åŒ–ã€‚</p><h2 id="åˆ†æè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#åˆ†æè¿‡ç¨‹"></a> åˆ†æè¿‡ç¨‹</h2><p>å…¬å¸æ•°æ®åº“æ¶‰åŠOracleå’ŒSQL serverï¼Œå¯¹äºæ¯æ—¥æ•°æ®åº“å·¡æ£€æ¥è¯´ï¼ŒOracleæ•°æ®åº“éƒ½æ˜¯é€šè¿‡bplistè¯­å¥è¿›è¡ŒæŸ¥è¯¢ï¼ŒSQL serveråˆ™æ˜¯é€šè¿‡NetBackupå®¢æˆ·ç«¯è¿›è¡Œç‚¹å‡»æŸ¥è¯¢ã€‚<br />æœ€å¥½SQL serverä¹Ÿèƒ½é€šè¿‡è¯­å¥æŸ¥è¯¢ï¼Œè¿™æ ·æ•´ä¸ªæ–¹æ¡ˆå°±æ˜¾å¾—æ›´åˆç†ã€‚åæ¥åœ¨ç½‘ä¸Šçœ‹åˆ°è¿™ç¯‡æ–‡ç« ã€Š<a href="https://www.cnblogs.com/yihr/p/12974613.html">Netbackupå‘½ä»¤ä¹‹bplist</a>ã€‹ï¼Œç»ˆäºçŸ¥é“SQL serverä¹Ÿå¯ä»¥é€šè¿‡bplistè¯­å¥è¿›è¡Œå¤‡ä»½æŸ¥è¯¢ã€‚<br />å®ç°è¿‡ç¨‹å°±æ¯”è¾ƒé¡ºåˆ©äº†ï¼š</p><h3 id="è¯»å–å¾…å·¡æ£€æ•°æ®åº“æ¸…å•"><a class="markdownIt-Anchor" href="#è¯»å–å¾…å·¡æ£€æ•°æ®åº“æ¸…å•"></a> è¯»å–å¾…å·¡æ£€æ•°æ®åº“æ¸…å•</h3><p>é€šè¿‡sqliteæ•°æ®åº“ï¼Œè®°å½•æ•°æ®åº“å·¡æ£€æ¸…å•ä¿¡æ¯è¡¨ï¼Œæ¶‰åŠæ•°æ®åº“æœåŠ¡å™¨åã€æœåŠ¡å™¨IPã€æ•°æ®åº“ç±»å‹ã€æ•°æ®åº“ç”¨é€”ã€è´Ÿè´£äººé‚®ç®±ç­‰ä¿¡æ¯ã€‚</p><h3 id="é€ä¸€æŸ¥è¯¢æ•°æ®åº“å¤‡ä»½æƒ…å†µ"><a class="markdownIt-Anchor" href="#é€ä¸€æŸ¥è¯¢æ•°æ®åº“å¤‡ä»½æƒ…å†µ"></a> é€ä¸€æŸ¥è¯¢æ•°æ®åº“å¤‡ä»½æƒ…å†µ</h3><p>éå†æ•°æ®åº“å·¡æ£€æ¸…å•ï¼Œé€ä¸€è¿›è¡ŒbplistæŸ¥è¯¢ã€‚</p><ol><li>é€šè¿‡loguruè®°å½•æ¯ä¸€æ­¥æŸ¥è¯¢æ—¥å¿—ï¼Œå¹¶è®°å½•åˆ°logæ–‡ä»¶ä¸­ã€‚</li><li>åœ¨sqliteä¸­å»ºç«‹å·¡æ£€ä¿¡æ¯è¡¨ï¼Œå°†æŸ¥è¯¢ç»“æœæ’å…¥åˆ°è¡¨ä¸­ï¼Œåˆ©äºåç»­æŸ¥è¯¢åˆ†æä½¿ç”¨ã€‚</li><li>æ¯æ—¥è½®è¯¢ï¼ŒæŸ¥è¯¢åŒºé—´ä¸ºè½®è¯¢æ—¥çš„å‰ä¸€è‡ªç„¶æ—¥ã€‚</li></ol><h3 id="åˆ¤æ–­å¤‡ä»½æ˜¯å¦æ­£å¸¸"><a class="markdownIt-Anchor" href="#åˆ¤æ–­å¤‡ä»½æ˜¯å¦æ­£å¸¸"></a> åˆ¤æ–­å¤‡ä»½æ˜¯å¦æ­£å¸¸</h3><p>æ ¹æ®bplistæŸ¥è¯¢è¯­å¥è¿”å›çš„ç»“æœåˆ¤æ–­å¤‡ä»½æ˜¯ç”±æ­£å¸¸ã€‚æ ¹æ®åˆ†æï¼Œè‹¥è¿”å›ç»“æœåŒ…å«â€œ- -rw- - -â€åˆ™è¡¨æ˜å¤‡ä»½æ­£å¸¸ï¼Œè‹¥ç»“æœåŒ…å«â€œEXIT STATUSâ€ / null åˆ™è¡¨æ˜æŸ¥è¯¢åŒºé—´NBUæ— å¤‡ä»½ä¿¡æ¯ã€‚</p><h3 id="é‚®ä»¶é€šçŸ¥"><a class="markdownIt-Anchor" href="#é‚®ä»¶é€šçŸ¥"></a> é‚®ä»¶é€šçŸ¥</h3><p>å°†æŸ¥è¯¢ç»“æœé€šçŸ¥æ•°æ®åº“è´Ÿè´£äººï¼Œä¸ºæé«˜é˜…è¯»æ€§ï¼Œæ­£æ–‡é‡‡ç”¨htmlæ ¼å¼ã€‚</p><h3 id="å®šæ—¶æ‰§è¡Œ"><a class="markdownIt-Anchor" href="#å®šæ—¶æ‰§è¡Œ"></a> å®šæ—¶æ‰§è¡Œ</h3><p>å°†å†™å¥½çš„pythonè„šæœ¬æ·»åŠ åˆ°batæ–‡ä»¶ä¸­ï¼Œé€šè¿‡æœåŠ¡å™¨çš„è®¡åˆ’ä»»åŠ¡ç¨‹åºå®šæ—¶æ‰§è¡Œbatå³å¯ã€‚</p><h2 id="åŠŸèƒ½æºç "><a class="markdownIt-Anchor" href="#åŠŸèƒ½æºç "></a> åŠŸèƒ½æºç </h2><h3 id="ä»£ç éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#ä»£ç éƒ¨åˆ†"></a> ä»£ç éƒ¨åˆ†</h3><h4 id="oséƒ¨åˆ†"><a class="markdownIt-Anchor" href="#oséƒ¨åˆ†"></a> oséƒ¨åˆ†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os <br><span class="hljs-keyword">from</span> loguru <span class="hljs-keyword">import</span> logger<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> sqlite3<br><span class="hljs-keyword">import</span> resultEmail<br><br><span class="hljs-comment"># åˆ›å»ºæ—¥å¿—å¯¹è±¡</span><br>FileLog = <span class="hljs-string">&#x27;log&#123;&#125;.log&#x27;</span>.<span class="hljs-built_in">format</span>(datetime.date.today())<br>logger.add(FileLog,rotation=<span class="hljs-string">&quot;500MB&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>, enqueue=<span class="hljs-literal">True</span>)<br><br><span class="hljs-comment"># è·å–æ˜¨å¤©æ—¥æœŸ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getYesterday</span>():<br>    today = datetime.date.today()<br>    oneday = datetime.timedelta(days=<span class="hljs-number">1</span>)<br>    yesterday = today - oneday<br>    <span class="hljs-keyword">return</span> yesterday.strftime(<span class="hljs-string">r&#x27;%Y-%m-%d&#x27;</span>)<br><br><span class="hljs-comment"># æŸ¥è¯¢ç³»ç»Ÿæ¸…å•</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">QuerySystemInfo</span>(<span class="hljs-params">yesterday</span>):<br>    conn = sqlite3.connect(<span class="hljs-string">r&#x27;D:\sqlite\********&#x27;</span>) <span class="hljs-comment"># sqliteæ–‡ä»¶</span><br>    c = conn.cursor()<br>    <span class="hljs-comment"># æŸ¥è¯¢ç³»ç»Ÿæ¸…å•ï¼Œé€è¡Œè¿›è¡Œå¤‡ä»½æ£€æŸ¥</span><br>    querySql = c.execute(<span class="hljs-string">&quot;select * from bd_dbsysteminfo order by email&quot;</span>)<br>    logger.info(<span class="hljs-string">&#x27;#######å¾…å·¡æ£€æ•°æ®åº“æ¸…å•æŸ¥è¯¢å®Œæˆ#######&#x27;</span>)<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> querySql:<br>        systemnameList.append(row[<span class="hljs-number">1</span>])<br>        systemtypeList.append(row[<span class="hljs-number">3</span>])<br>    conn.close()<br><br><span class="hljs-comment"># æŸ¥è¯¢å¤‡ä»½æƒ…å†µ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CmdQuery</span>(<span class="hljs-params">systemname,systemtype,yesterday</span>):<br>    logger.info(<span class="hljs-string">&#x27;#######æ•°æ®åº“å¤‡ä»½å·¡æ£€#######&#x27;</span>)<br>    <span class="hljs-keyword">if</span> systemtype == <span class="hljs-string">&#x27;Oracle&#x27;</span>:<br>        Query = <span class="hljs-string">r&#x27;cd C:\Program Files\Veritas\NetBackup\bin\ &amp;&amp; bplist -C &#123;&#125; -S nbu5230 -s &#123;&#125; -e &#123;&#125; -t 4 -l -R /&#x27;</span>.<span class="hljs-built_in">format</span>(systemname,yesterday,yesterday)<br>    <span class="hljs-keyword">elif</span> systemtype == <span class="hljs-string">&#x27;SqlServer&#x27;</span>:<br>        Query = <span class="hljs-string">r&#x27;cd C:\Program Files\Veritas\NetBackup\bin\ &amp;&amp; bplist -C &#123;&#125; -S nbu5230 -s &#123;&#125; -e &#123;&#125; -t 15 -l -R /&#x27;</span>.<span class="hljs-built_in">format</span>(systemname,yesterday,yesterday)<br>    <span class="hljs-keyword">else</span> :<br>        logger.error(<span class="hljs-string">&#x27;+++++++æ•°æ®åº“&#123;&#125;,æ•°æ®åº“ç±»å‹&#123;&#125;æœ‰è¯¯+++++++&#x27;</span>.<span class="hljs-built_in">format</span>(systemname,systemtype))<br>    details = os.popen(Query).read()<br>    line = details.split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-comment"># cd C:\Program Files\Veritas\NetBackup\bin\&amp;&amp;bplist -C USERMIC-6E73OBR -S nbu5230 -s 2023-03-01 -e 2023-03-10 -t 4 -l -R /</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;EXIT STATUS 227&#x27;</span> <span class="hljs-keyword">in</span> details:<br>        logger.error(<span class="hljs-string">&#x27;+++++++æ•°æ®åº“&#123;&#125;,æ•°æ®åº“ç±»å‹&#123;&#125;åœ¨&#123;&#125;æœªæŸ¥åˆ°å¤‡ä»½æ–‡ä»¶+++++++&#x27;</span>.<span class="hljs-built_in">format</span>(systemname,systemtype,yesterday))<br>        InsertDatabase(systemname,yesterday,details,<span class="hljs-string">&#x27;æ— å¤‡ä»½&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> (<span class="hljs-string">&#x27;-rw---&#x27;</span> <span class="hljs-keyword">in</span> details) <span class="hljs-keyword">or</span> <span class="hljs-built_in">len</span>(line)&gt;=<span class="hljs-number">5</span> :<br>        logger.info(<span class="hljs-string">&#x27;#######æ•°æ®åº“&#123;&#125;,æ•°æ®åº“ç±»å‹&#123;&#125;åœ¨&#123;&#125;å­˜åœ¨å¤‡ä»½æ–‡ä»¶#######&#x27;</span>.<span class="hljs-built_in">format</span>(systemname,systemtype,yesterday))<br>        InsertDatabase(systemname,yesterday,details,<span class="hljs-string">&#x27;æ­£å¸¸&#x27;</span>)<br>    <span class="hljs-keyword">else</span> :<br>        logger.error(<span class="hljs-string">&#x27;+++++++æ•°æ®åº“&#123;&#125;,æ•°æ®åº“ç±»å‹&#123;&#125;åœ¨&#123;&#125;æŸ¥è¯¢ç»“æœå¼‚å¸¸+++++++&#x27;</span>.<span class="hljs-built_in">format</span>(systemname,systemtype,yesterday))<br>        InsertDatabase(systemname,yesterday,details,<span class="hljs-string">&#x27;æ— å¤‡ä»½&#x27;</span>)  <br><br><span class="hljs-comment"># æ’å…¥å·¡æŸ¥ä¿¡æ¯è®°å½•è¡¨</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">InsertDatabase</span>(<span class="hljs-params">systemname,querydate,details,result</span>):<br>    insertContent = (systemname,querydate,details,result)<br>    conn = sqlite3.connect(<span class="hljs-string">r&#x27;D:\sqlite\JicAiDatabase&#x27;</span>)<br>    c = conn.cursor()<br>    querySql = c.execute(<span class="hljs-string">&quot;insert into system_nbubakupinfo (systemname,querydate,details,result) values (?,?,?,?)&quot;</span>,insertContent)<br>    conn.commit()<br>    conn.close()<br>    logger.info(<span class="hljs-string">&#x27;#######&#123;&#125;æ—¥ï¼ŒæœåŠ¡å™¨&#123;&#125;çš„NBUå¤‡ä»½æ—¥å¿—å·²æ’å…¥æ•°æ®åº“#######&#x27;</span>.<span class="hljs-built_in">format</span>(querydate,systemname))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    yesterday = getYesterday()<br>    systemnameList = []<br>    systemtypeList = []<br>    logger.info(<span class="hljs-string">&#x27;#######å·¡æ£€å¼€å§‹#######&#x27;</span>)<br>    QuerySystemInfo(yesterday)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(systemnameList)):<br>        CmdQuery(systemnameList[i],systemtypeList[i],yesterday)<br>    logger.info(<span class="hljs-string">&#x27;***å¼€å§‹å‘é€é‚®ä»¶***&#x27;</span>)<br>    resultEmail.sendEmail(yesterday)<br>    logger.info(<span class="hljs-string">&#x27;***é‚®ä»¶å·²å‘ç»™å„ç³»ç»Ÿç®¡ç†å‘˜***&#x27;</span>)<br>    resultEmail.toManager(yesterday)<br>    logger.info(<span class="hljs-string">&#x27;***é‚®ä»¶å·²å‘ç»™NBUç®¡ç†å‘˜***&#x27;</span>)<br>    logger.info(<span class="hljs-string">&#x27;***é‚®ä»¶å‘é€å®Œæˆ***&#x27;</span>)<br>    logger.info(<span class="hljs-string">&#x27;#######å·¡æ£€ç»“æŸ#######&#x27;</span>)<br>    <br></code></pre></td></tr></table></figure><h4 id="emailéƒ¨åˆ†"><a class="markdownIt-Anchor" href="#emailéƒ¨åˆ†"></a> emailéƒ¨åˆ†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> sqlite3<br><span class="hljs-keyword">import</span> smtplib<br><span class="hljs-keyword">from</span> email.mime.text <span class="hljs-keyword">import</span> MIMEText<br><span class="hljs-keyword">from</span> email.mime.multipart <span class="hljs-keyword">import</span> MIMEMultipart<br><span class="hljs-keyword">from</span> email.header <span class="hljs-keyword">import</span> Header<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sendEmail</span>(<span class="hljs-params">yesterday</span>):<br>    toEmail = []<br>    contents = []<br>    details = []<br>    subject = <span class="hljs-string">&#x27;&#123;&#125;-æ•°æ®åº“å¤‡ä»½å·¡æ£€ç»“æœé€šçŸ¥&#x27;</span>.<span class="hljs-built_in">format</span>(datetime.date.today().strftime(<span class="hljs-string">r&#x27;%Y%m%d&#x27;</span>))<br>    conn = sqlite3.connect(<span class="hljs-string">r&#x27;D:\sqlite\******&#x27;</span>)<br>    c = conn.cursor()<br>    querySql = c.execute(<span class="hljs-string">&quot;select distinct email from bd_dbsysteminfo order by email&quot;</span>)<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> querySql:<br>        toEmail.append(row[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> toEmail:<br>        table = <span class="hljs-string">&#x27;&#x27;</span><br>        detail = <span class="hljs-string">&#x27;details:&#x27;</span><br>        contentSql = c.execute(<span class="hljs-string">&quot;select a.systemname,b.systemip,b.systemmemo,a.result,a.details from  system_nbubakupinfo a left join bd_dbsysteminfo b on a.systemname=b.systemname where b.email=&#x27;&#123;&#125;&#x27; and a.querydate=&#x27;&#123;&#125;&#x27;&quot;</span>.<span class="hljs-built_in">format</span>(row,yesterday))<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> contentSql:<br>            <span class="hljs-comment"># å°è£…å†…å®¹</span><br>            detail = detail + i[<span class="hljs-number">4</span>]<br>            <span class="hljs-keyword">if</span> i[<span class="hljs-number">3</span>]  == <span class="hljs-string">&#x27;æ­£å¸¸&#x27;</span> :<br>                table = table + <span class="hljs-string">r&#x27;&lt;tr&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;/tr&gt;&#x27;</span>.<span class="hljs-built_in">format</span>(i[<span class="hljs-number">0</span>],i[<span class="hljs-number">1</span>],i[<span class="hljs-number">2</span>],i[<span class="hljs-number">3</span>])<br>            <span class="hljs-keyword">else</span> :<br>                table = table + <span class="hljs-string">r&#x27;&lt;tr&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td style=&quot;color:red;&quot;&gt;&#123;&#125;&lt;/td&gt;&lt;/tr&gt;&#x27;</span>.<span class="hljs-built_in">format</span>(i[<span class="hljs-number">0</span>],i[<span class="hljs-number">1</span>],i[<span class="hljs-number">2</span>],i[<span class="hljs-number">3</span>])<br>        contents.append(<span class="hljs-string">r&#x27;&lt;p&gt;&#123;&#125;æ—¥æ•°æ®åº“å¤‡ä»½å·¡æ£€ç»“æœ&lt;/p&gt;&lt;table border=&quot;1&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th style=&quot;text-align:center;&quot;&gt;æœåŠ¡å™¨å&lt;/th&gt;&lt;th style=&quot;text-align:center;&quot;&gt;æœåŠ¡å™¨IP&lt;/th&gt;&lt;th style=&quot;text-align:center;&quot;&gt;æ•°æ®åº“ç”¨é€”&lt;/th&gt;&lt;th style=&quot;text-align:center;&quot;&gt;å·¡æ£€ç»“æœ&lt;/th&gt;&lt;/tr&gt;&#123;&#125;&lt;/tbody&gt;&lt;colgroup&gt;&lt;col style=&quot;width: 25%;&quot;&gt;&lt;col style=&quot;width: 25%;&quot;&gt;&lt;col style=&quot;width: 25%;&quot;&gt;&lt;col style=&quot;width: 25%;&quot;&gt;&lt;/colgroup&gt;&lt;/table&gt;&lt;span&gt;è¯¦ç»†å¤‡ä»½ä¿¡æ¯å‚è§é™„ä»¶ï¼è¯¥é‚®ä»¶ä¸ºç³»ç»Ÿè‡ªåŠ¨å‘é€ï¼Œè¯·å‹¿å›å¤ã€‚&lt;/span&gt;&#x27;</span>.<span class="hljs-built_in">format</span>(yesterday,table))<br>        details.append(detail)<br>    conn.close()<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(toEmail)):<br>        <span class="hljs-comment"># åˆ›å»º SMTP å¯¹è±¡</span><br>        smtp = smtplib.SMTP()<br>        smtp.connect(<span class="hljs-string">&quot;****.cn&quot;</span>, port=<span class="hljs-number">25</span>)<br>        smtp.login(user=<span class="hljs-string">&quot;**@*.cn&quot;</span>, password=<span class="hljs-string">r&quot;***&quot;</span>)<br>        message = MIMEMultipart()<br>        message[<span class="hljs-string">&#x27;From&#x27;</span>] = Header(<span class="hljs-string">&quot;***@***.cn&quot;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>) <br>        message[<span class="hljs-string">&#x27;Subject&#x27;</span>] = Header(subject, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;details.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(details[i])<br>        message[<span class="hljs-string">&#x27;To&#x27;</span>] = Header(toEmail[i], <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        message.attach(MIMEText(contents[i], <span class="hljs-string">&#x27;html&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>        att = MIMEText(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;details.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read(),<span class="hljs-string">&#x27;base64&#x27;</span>,<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        att[<span class="hljs-string">&#x27;Content-Type&#x27;</span>] = <span class="hljs-string">&#x27;application/octet-stream&#x27;</span><br>        att[<span class="hljs-string">&quot;Content-Disposition&quot;</span>] = <span class="hljs-string">&#x27;attachment; filename=&quot;details.txt&quot;&#x27;</span><br>        message.attach(att)<br>        smtp.sendmail(from_addr=<span class="hljs-string">&quot;******@****.cn&quot;</span>, to_addrs=toEmail[i], msg=message.as_string())<br>        smtp.quit()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">toManager</span>(<span class="hljs-params">yesterday</span>):<br>    to = <span class="hljs-string">&#x27;&#x27;</span><br>    contents = <span class="hljs-string">&#x27;&#x27;</span><br>    subject = <span class="hljs-string">&#x27;&#123;&#125;-æ•°æ®åº“å¤‡ä»½å·¡æ£€ç»“æœé€šçŸ¥&#x27;</span>.<span class="hljs-built_in">format</span>(datetime.date.today().strftime(<span class="hljs-string">r&#x27;%Y%m%d&#x27;</span>))<br>    conn = sqlite3.connect(<span class="hljs-string">r&#x27;D:\sqlite\****&#x27;</span>)<br>    c = conn.cursor()<br>    querySql = c.execute(<span class="hljs-string">&quot;select distinct supermanager from bd_dbsysteminfo &quot;</span>)<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> querySql:<br>        to = row[<span class="hljs-number">0</span>]<br>        table = <span class="hljs-string">&#x27;&#x27;</span><br>        contentSql = c.execute(<span class="hljs-string">&quot;select a.systemname,b.systemip,b.systemmemo,a.result from  system_nbubakupinfo a left join bd_dbsysteminfo b on a.systemname=b.systemname where a.querydate=&#x27;&#123;&#125;&#x27;&quot;</span>.<span class="hljs-built_in">format</span>(yesterday))<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> contentSql:<br>            <span class="hljs-keyword">if</span> i[<span class="hljs-number">3</span>]  == <span class="hljs-string">&#x27;æ­£å¸¸&#x27;</span> :<br>                table = table + <span class="hljs-string">r&#x27;&lt;tr&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;/tr&gt;&#x27;</span>.<span class="hljs-built_in">format</span>(i[<span class="hljs-number">0</span>],i[<span class="hljs-number">1</span>],i[<span class="hljs-number">2</span>],i[<span class="hljs-number">3</span>])<br>            <span class="hljs-keyword">else</span> :<br>                table = table + <span class="hljs-string">r&#x27;&lt;tr&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td&gt;&#123;&#125;&lt;/td&gt;&lt;td style=&quot;color:red;&quot;&gt;&#123;&#125;&lt;/td&gt;&lt;/tr&gt;&#x27;</span>.<span class="hljs-built_in">format</span>(i[<span class="hljs-number">0</span>],i[<span class="hljs-number">1</span>],i[<span class="hljs-number">2</span>],i[<span class="hljs-number">3</span>])<br>        contents = contents + <span class="hljs-string">&#x27;&lt;p&gt;&#123;&#125;æ—¥æ•°æ®åº“å¤‡ä»½å·¡æ£€ç»“æœ&lt;/p&gt;&lt;table border=&quot;1&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th style=&quot;text-align:center;&quot;&gt;æœåŠ¡å™¨å&lt;/th&gt;&lt;th style=&quot;text-align:center;&quot;&gt;æœåŠ¡å™¨IP&lt;/th&gt;&lt;th style=&quot;text-align:center;&quot;&gt;æ•°æ®åº“ç”¨é€”&lt;/th&gt;&lt;th style=&quot;text-align:center;&quot;&gt;å·¡æ£€ç»“æœ&lt;/th&gt;&lt;/tr&gt;&#123;&#125;&lt;/tbody&gt;&lt;colgroup&gt;&lt;col style=&quot;width: 25%;&quot;&gt;&lt;col style=&quot;width: 25%;&quot;&gt;&lt;col style=&quot;width: 25%;&quot;&gt;&lt;col style=&quot;width: 25%;&quot;&gt;&lt;/colgroup&gt;&lt;/table&gt;&lt;span&gt;è¯¥é‚®ä»¶ä¸ºç³»ç»Ÿè‡ªåŠ¨å‘é€ï¼Œè¯·å‹¿å›å¤ã€‚&lt;/span&gt;&#x27;</span>.<span class="hljs-built_in">format</span>(yesterday,table)<br>    conn.close()<br><br>    smtp = smtplib.SMTP()<br>    smtp.connect(<span class="hljs-string">&quot;****.****.cn&quot;</span>, port=<span class="hljs-number">25</span>)<br>    smtp.login(user=<span class="hljs-string">&quot;****@***.cn&quot;</span>, password=<span class="hljs-string">r&quot;***&quot;</span>)<br>    message = MIMEMultipart()<br>    message[<span class="hljs-string">&#x27;From&#x27;</span>] = Header(<span class="hljs-string">&quot;***@***.cn&quot;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>) <br>    message[<span class="hljs-string">&#x27;Subject&#x27;</span>] = Header(subject, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    message[<span class="hljs-string">&#x27;To&#x27;</span>] = Header(to, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    message.attach(MIMEText(contents, <span class="hljs-string">&#x27;html&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    smtp.sendmail(from_addr=<span class="hljs-string">&quot;***@***.cn&quot;</span>, to_addrs=to, msg=message.as_string())<br>    smtp.quit()<br></code></pre></td></tr></table></figure><h3 id="å®šæ—¶ä»»åŠ¡"><a class="markdownIt-Anchor" href="#å®šæ—¶ä»»åŠ¡"></a> å®šæ—¶ä»»åŠ¡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">@echo off<br>D:<br>cd D:\***<br>python ***.py<br>exit    <br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>ç®€å•å¥½ç”¨ï¼Œè½»è½»æ¾æ¾ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>osè‡ªåŠ¨åŒ–</category>
      
      <category>loguru</category>
      
      <category>resultEmail</category>
      
      <category>sqlite3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªåŠ¨åŒ–</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Power Automate</title>
    <link href="/2023/03/08/PowerAutomate/"/>
    <url>/2023/03/08/PowerAutomate/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Š<a href="https://hncd1024.github.io/2022/08/26/Python%20selenium/">Python|seleniumå®ç°è‡ªåŠ¨ç‚¹èµæ”¶è—(è¿›é˜¶ç‰ˆ)</a>ã€‹ä¸­å†™è¿‡åˆ©ç”¨ python çš„selenium å®ç°ç½‘é¡µè‡ªåŠ¨åŒ–ç‚¹èµ+æ”¶è—çš„åŠŸèƒ½ï¼Œä½†ä½¿ç”¨ä¸Šéœ€è¦æœ‰ä¸€å®š python åŸºç¡€ã€‚<br />è¿‘æœŸåœ¨ç”µè„‘ä¸Šå‘ç°äº†å¾®è½¯win11ç³»ç»Ÿé¢„è£…çš„ Power Automateï¼Œå°±ç”¨åŒæ ·çš„æŸç½‘ç«™ç‚¹èµçš„æ¡ˆä¾‹è¿›è¡Œäº†ä½“éªŒã€‚</p><h1 id="æµ‹è¯•è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#æµ‹è¯•è¿‡ç¨‹"></a> æµ‹è¯•è¿‡ç¨‹</h1><p>ç™»å½•å¹¶æ‰“å¼€å¾…å¤„ç†çš„åˆ—è¡¨ç•Œé¢ã€‚<br /><img src="https://i.328888.xyz/2023/03/08/5Sy23.png" alt="ç™»å½•è¿‡ç¨‹" /><br />è·å–æœªç‚¹èµçš„é“¾æ¥ï¼Œå¹¶æ‰“å¼€è¿›è¡Œç‚¹èµã€æ”¶è—ã€‚<br /><img src="https://i.328888.xyz/2023/03/08/5SVqv.png" alt="ç‚¹èµã€æ”¶è—è¿‡ç¨‹" /><br />è¿è¡Œç™»å½•ï¼Œå¹¶å¾ªç¯è¿›è¡Œç‚¹èµã€æ”¶è—ã€‚<br /><img src="https://i.328888.xyz/2023/03/08/5SidU.png" alt="å¾ªç¯éå†" /><br />æµ‹è¯•ç»“æœåŸºæœ¬æ»¡è¶³éœ€è¦ï¼Œåç»­å¯å‘æ˜æ›´ä¸°å¯Œçš„åº”ç”¨åœºæ™¯ã€‚</p><h1 id="æ€»ç»“ä¸€ä¸‹"><a class="markdownIt-Anchor" href="#æ€»ç»“ä¸€ä¸‹"></a> æ€»ç»“ä¸€ä¸‹</h1><p>Microsoft Power Automateæ˜¯ä¸€ä¸ªä½ä»£ç å¹³å°çš„RPAå·¥å…·ï¼Œå¯ä»¥è¾…åŠ©ç”¨æˆ·è¿›è¡Œæµç¨‹è‡ªåŠ¨åŒ–åŠå…¬ï¼Œæå‡å·¥ä½œæ•ˆç‡ã€‚ç›¸æ¯”æˆ‘ä¹‹å‰æ¥è§¦è¿‡çš„UIPathï¼Œä¸ªäººæ„Ÿè§‰ç›¸å¯¹å…·æœ‰ä¼˜åŠ¿ã€‚</p><div class="note note-primary">            <p>ä¼˜åŠ¿ä¸€ï¼šPower Automateå¯¹ç»ˆç«¯ä¸ªäººç”¨æˆ·å…è´¹ï¼Œä»win11ç³»ç»Ÿé¢„è£…å°±å¯ä»¥çœ‹å‡ºå¾®è½¯è¿˜æ˜¯è¯šæ„æ»¡æ»¡çš„ã€‚ç›¸æ¯”UIPathä½œä¸ºä¸€æ¬¾éœ€æˆæƒä½¿ç”¨çš„è½¯ä»¶ï¼Œä½¿ç”¨é—¨æ§›è¾ƒé«˜ã€‚</p>          </div><div class="note note-primary">            <p>ä¼˜åŠ¿äºŒï¼šç³»ç»Ÿé›†æˆè¾ƒå¥½ï¼Œä½œä¸ºå¾®è½¯å‡ºå“ï¼ŒPower Automateå¯¹å¾®è½¯ç¯å¢ƒä¸‹çš„åº”ç”¨äº¤äº’åšçš„æ¯”è¾ƒå¥½ã€‚é™¤officeå…¨å®¶æ¡¶éƒ½èƒ½å¾ˆå¥½çš„äº¤äº’å¤–ï¼Œå¯¹httpã€FTPç­‰æœåŠ¡æ”¯æŒä¹Ÿæ¯”è¾ƒå‹å¥½ï¼Œç”šè‡³Power Automateè¿˜æ”¯æŒpythonã€JSã€VBã€shellç­‰è„šæœ¬ã€‚çœŸé¦™ï¼</p>          </div><div class="note note-primary">            <p>ä¼˜åŠ¿ä¸‰ï¼šä½ è§è¿‡è‡ªåŠ¨å¸®ä½ è¿›è¡Œæµç¨‹è®¾è®¡çš„RPAå·¥å…·å—ï¼ŸPower Automateå¯ä»¥ï¼å³ä¾¿ä½ ä¸ä¼šè‡ªå·±è®¾è®¡æµç¨‹ï¼Œä½ å¯ä»¥æ‰“å¼€Power Automateçš„æ•è·åŠŸèƒ½ã€‚ç„¶åä½ åªéœ€è¦ç»™å®ƒæ¼”ç¤ºä¸‹ä½ è¦æ€ä¹ˆåšï¼ŒPower Automateä¾¿ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆæµç¨‹ï¼ˆå½“ç„¶ä¸€èˆ¬æƒ…å†µä¸‹è¿˜æ˜¯è¦åœ¨æ­¤åŸºç¡€ä¸Šå†ä¼˜åŒ–è°ƒæ•´çš„ï¼‰ã€‚</p>          </div> ]]></content>
    
    
    <categories>
      
      <category>PowerAutomate</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PowerAutomate</tag>
      
      <tag>RPA</tag>
      
      <tag>è‡ªåŠ¨åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æœº|è®°ä¸€æ¬¡CPUé™é¢‘é—®é¢˜æ’æŸ¥ä¸ä¿®å¤</title>
    <link href="/2023/02/03/LowerCpuUsage/"/>
    <url>/2023/02/03/LowerCpuUsage/</url>
    
    <content type="html"><![CDATA[<p>å»å¹´ä¹°äº†å°ç¬”è®°æœ¬ç”µè„‘ï¼Œi7-11390H 3.42Ghzå¤„ç†å™¨ï¼Œ16.0 GBå†…å­˜ï¼Œ512G SSDï¼Œä½¿ç”¨ä¸€æ®µæ—¶é—´æ„Ÿè§‰å¦‚å¾·èŠ™èˆ¬ä¸æ»‘ã€‚å¤§æ¦‚ä¸€ä¸ªæœˆå‰ç³»ç»Ÿå‡ºç°å¼‚å¸¸å¡é¡¿çš„ç°è±¡ï¼ŒCPUå’Œå†…å­˜ä½¿ç”¨ç‡ä½åˆ°ä¸è¡Œï¼Œä½†å¼€æœºå’Œè¿è¡Œç¨‹åºå°±æ˜¯å¾ˆå¡ï¼Œå“åº”å»¶è¿Ÿå’Œæ‰å¸§å¾ˆä¸¥é‡ã€‚æ‰“å¼€ä¸ªæ–‡ä»¶å¤¹éƒ½èƒ½æ…¢åˆ°æ€€ç–‘äººç”Ÿï¼Œæ„Ÿè§‰åˆä¸­å¾®æœºè¯¾çš„XPç³»ç»Ÿéƒ½æ¯”å®ƒè¦é¡ºç•…ğŸ˜‚ğŸ˜‚ğŸ˜‚<br />æŠ˜è…¾äº†å¾ˆä¹…éƒ½æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œæˆ‘éƒ½æƒ³é‡è£…ç³»ç»Ÿè¯•ä¸€ä¸‹äº†ï¼ˆè€ƒè™‘åˆ°æœ¬åœ°çš„å‡ ä¸ªå¼€å‘ç¯å¢ƒè¿ç§»å¤ªéº»çƒ¦è€Œä¸ç”˜å¿ƒï¼‰ã€‚å°±åœ¨ä»Šå¤©ç»ˆäºæ‰¾åˆ°äº†é—®é¢˜åŸå› ~</p><h2 id="ç»“è®ºåœ¨å‰"><a class="markdownIt-Anchor" href="#ç»“è®ºåœ¨å‰"></a> ç»“è®ºåœ¨å‰</h2><p>CPUé™ç”µå¯¼è‡´çš„é™é¢‘ã€é”é¢‘</p><h2 id="æ’æŸ¥è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#æ’æŸ¥è¿‡ç¨‹"></a> æ’æŸ¥è¿‡ç¨‹</h2><h3 id="æ€€ç–‘win11å‡çº§å¯¼è‡´"><a class="markdownIt-Anchor" href="#æ€€ç–‘win11å‡çº§å¯¼è‡´"></a> æ€€ç–‘win11å‡çº§å¯¼è‡´</h3><p>æœ€è¿‘åŠå¹´ä¸€ç›´åœ¨ä½“éªŒwin11ï¼Œå¾®è½¯æ›´æ–°ä¹ŸæŒºç§¯æçš„ï¼Œæˆ‘é¦–å…ˆæ€€ç–‘æ˜¯win11ç³»ç»Ÿæœ¬èº«å¯¼è‡´çš„å¡é¡¿ã€‚æ°å·§æˆ‘win11 22H2æ›´æ–°åŒ…ä¸€ç›´æ‰“ä¸ä¸Šå»ï¼Œè®©æˆ‘ä¸¥é‡æ€€ç–‘æ˜¯å½“å‰ç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿbugã€‚<br />åºŸäº†å¾ˆå¤§åŠŸå¤«å»ä¿®å¤æ“ä½œç³»ç»Ÿçš„æ›´æ–°é—®é¢˜ï¼Œç”šè‡³é‡è£…äº†Windows UpdateåŠŸèƒ½ä¹Ÿä¸è¡Œã€‚</p><h3 id="æ€€ç–‘ç—…æ¯’æ–‡ä»¶å¯¼è‡´"><a class="markdownIt-Anchor" href="#æ€€ç–‘ç—…æ¯’æ–‡ä»¶å¯¼è‡´"></a> æ€€ç–‘ç—…æ¯’æ–‡ä»¶å¯¼è‡´</h3><p>CPUå’Œå†…å­˜ä½¿ç”¨ç‡å¾ˆä½ï¼Œç”µè„‘å´å¾ˆå¡ã€‚å…ˆç¡®è®¤ç”µè„‘æ²¡æœ‰å®‰è£…æŸæ•°å­—å®‰å…¨ç®¡å®¶ã€æŸåº¦å®‰å…¨ç®¡å®¶ã€æŸè®¯å®‰å…¨ç®¡å®¶ã€‚ç„¶åæ‰«æäº†å…¨ç›˜ä¹Ÿæ²¡æœ‰å‘ç°ç—…æ¯’æ–‡ä»¶ã€æ¶æ„ä»¥æ–‡ä»¶ï¼Œåå°è¿›ç¨‹çœ‹èµ·æ¥ä¹Ÿå¾ˆæ­£å¸¸ã€‚ğŸ˜‚ğŸ˜‚ğŸ˜‚</p><h3 id="æ€€ç–‘ç³»ç»Ÿé…ç½®å¯¼è‡´"><a class="markdownIt-Anchor" href="#æ€€ç–‘ç³»ç»Ÿé…ç½®å¯¼è‡´"></a> æ€€ç–‘ç³»ç»Ÿé…ç½®å¯¼è‡´</h3><p>ç½‘ä¸Šæ‰¾äº†ä¸€å¤§å †æ•™ç¨‹ï¼ŒWindowså¤–è§‚å’Œæ€§èƒ½è®¾ç½®è°ƒæ•´ä½æœ€ä½³æ€§èƒ½äº†ï¼Œæ²¡ç”¨ï¼›ç”µæ± ä½¿ç”¨è®¡åˆ’ä¹Ÿè°ƒæ•´ä¸ºäº†é«˜æ€§èƒ½ï¼Œæ²¡ç”¨ï¼›å­˜å‚¨æ„ŸçŸ¥å¼€äº†ï¼Œæ²¡ç”¨ï¼›ä¸´æ—¶æ–‡ä»¶åˆ äº†ï¼Œæ²¡ç”¨â€¦â€¦</p><h3 id="æ€€ç–‘ç”µè„‘å“ç‰Œé—®é¢˜"><a class="markdownIt-Anchor" href="#æ€€ç–‘ç”µè„‘å“ç‰Œé—®é¢˜"></a> æ€€ç–‘ç”µè„‘å“ç‰Œé—®é¢˜</h3><p>æˆ‘è´­ä¹°çš„æ˜¯å°ç±³pro14å¢å¼ºç‰ˆé¡¶é…ï¼Œç½‘ä¸Šæœç´¢å°ç±³ç”µè„‘å¡é¡¿æ—¶å‘ç°è´Ÿé¢è¯„ä»·ä¸€å¤§å †ï¼Œä½†æˆ‘å†…å¿ƒä»ç„¶è§‰å¾—ç¡¬ä»¶é—®é¢˜å¯èƒ½æ€§ä¸å¤§ï¼Œæµè§ˆå¾ˆå¤šç½‘é¡µè§‰å¾—æ²¡æœ‰å¤ªå¤šæœ‰æ•ˆä¿¡æ¯ã€‚</p><h3 id="æ€€ç–‘ç¡¬ä»¶æ•…éšœ"><a class="markdownIt-Anchor" href="#æ€€ç–‘ç¡¬ä»¶æ•…éšœ"></a> æ€€ç–‘ç¡¬ä»¶æ•…éšœ</h3><p>åˆ°è¿™é‡Œæˆ‘åŸºæœ¬æ„Ÿè§‰å°±æ˜¯ç¡¬ä»¶æ•…éšœäº†ï¼Œå®˜æ–¹ç»´ä¿®ç‚¹ä¹ŸæŸ¥äº†ï¼Œéƒ½å‡†å¤‡è¦èµ°ç»´ä¿®äº†ã€‚ç„¶åæˆ‘æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨æƒ³çœ‹ä¸‹ç£ç›˜å·æ˜¯å¦æ•…éšœï¼Œçªç„¶å‘ç°CPUä¸€ç›´æ˜¯0.38Ghzï¼Œè¿™è‚¯å®šæ˜¯ä¸æ­£å¸¸çš„ã€‚ä¹‹åæµ‹è¯•æ‰“å¼€äº†å‡ ä¸ªç¨‹åºæœåŠ¡ï¼ŒCPUå§‹ç»ˆé”é¢‘åœ¨0.38ï¼Œç»ˆäºæ‰¾åˆ°æ•…éšœçš„åŸå› äº†ï¼</p><h2 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h2><p>ç½‘ä¸Šæœç´¢CPUé”é¢‘ã€CPUé™é¢‘ï¼š<br />æœ‰ <strong>æ›´æ¢é£æ‰‡å’Œé‡æ‰“ç¡…èƒ¶</strong> çš„ï¼šç”µè„‘æ‰ä½¿ç”¨åŠå¹´ä¸åˆ°ï¼Œç°å°˜è‚¯å®šä¸å¤šï¼Œè¿™ä¸ªå¯èƒ½æ€§ä¸å¤§ï¼›<br />æœ‰å¸–å­è¯´ <strong>BIOSå‡çº§å¯¼è‡´</strong> çš„ï¼šæˆ‘åœ¨å°ç±³å®˜ç½‘ä¸Šä¸‹è½½äº†æœ€æ–°çš„BIOSé‡æ–°å‡çº§äº†é©±åŠ¨ï¼Œä¾æ—§æ— æ•ˆï¼›<br />æœ‰å¸–å­è¯´å°ç±³å·¥ç¨‹å¸ˆä¸ºäº†é™ä½åŠŸè€—å»¶é•¿ä½¿ç”¨æ—¶é—´ <strong>æ•…æ„é™é¢‘</strong> äº†ï¼ˆä¿æŒä¸­ç«‹ï¼‰ï¼Œä¹‹åæˆ‘æ‰¾åˆ°ThrottleStopè¿™æ¬¾è½¯ä»¶ï¼Œä¸“é—¨è§£é™¤ç¬”è®°æœ¬ç”µè„‘çš„æ¸©åº¦å¢™ï¼Œè°ƒæ•´CPUæ—¶é’Ÿé€Ÿåº¦ã€‚ä¸ºäº†æ€§èƒ½å·²ç»ä¸åœ¨ä¹æ¸©åº¦äº†ï¼Œæœæ–­ä¸‹è½½æµ‹è¯•äº†ä¸‹ï¼Œå‘ç°è¿˜æ˜¯æ— æ•ˆï¼›<br />æœ€ç»ˆçœ‹åˆ°ä¸€ä¸ªåŸå› æ˜¯ <strong>CPUé™ç”µ</strong> ï¼Œä¼šé€ æˆCPUé™ç”µä¿æŠ¤ä¸»åŠ¨é™é¢‘é”é¢‘ã€‚è‡³æ­¤ç»ˆäºæ‰¾åˆ°äº†é—®é¢˜çš„æ ¹æœ¬åŸå› ï¼ï¼ï¼<br /><font color="#dd0000">ç”µè„‘å…³æœºé”®é•¿æŒ‰äº†1miné‡Šæ”¾CPUé™ç”µï¼Œä¹‹åé‡æ–°æ‰“å¼€ç”µè„‘å‘ç°å¾·èŠ™å›æ¥äº†ï¼Œä¸æ»‘å¦‚åˆ~ğŸ‘ğŸ‘ğŸ‘  </font><br />æœ€åä¹Ÿä¸ºå°ç±³ç”µè„‘æ­£ä¸ªåï¼Œæ¯”èµ·Thinkxxxï¼Œç¨³å®šæ€§å®Œèƒœã€‚Thinkxxxå·²ç»ä¸æ˜¯å½“å¹´çš„Thinkxxxäº†ï¼Œæƒ‹æƒœ~</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºé—®é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¡ç®—æœºé—®é¢˜</tag>
      
      <tag>CPUé™é¢‘</tag>
      
      <tag>CPUé”é¢‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NC|ç§‘ç›®è¡¨è°ƒæ•´</title>
    <link href="/2022/11/04/yonyouNC_account/"/>
    <url>/2022/11/04/yonyouNC_account/</url>
    
    <content type="html"><![CDATA[<p>ä¸€ä¸ªæœ‹å‹æœ€è¿‘åˆç¢°åˆ°äº†å…³äºç”¨å‹NCç³»ç»Ÿç§‘ç›®è¡¨å˜æ›´çš„é—®é¢˜ï¼Œä¸Šæ¬¡å¿˜äº†è®°å½•è¿‡ç¨‹ï¼Œåæ‚”è«åŠ~ è¿™æ¬¡å®Œæ•´çš„è®°å½•ä¸‹æ¥ï¼Œä»¥å¤‡åç”¨ã€‚</p><h2 id="é—®é¢˜èƒŒæ™¯"><a class="markdownIt-Anchor" href="#é—®é¢˜èƒŒæ™¯"></a> é—®é¢˜èƒŒæ™¯</h2><p>XXé›†å›¢ä½¿ç”¨ç”¨å‹ NC Cloud äº§å“ï¼Œä¸‹å±å¤šä¸ªä¸šåŠ¡å•å…ƒï¼Œé‡‡ç”¨é›†å›¢ç®¡æ§ï¼Œç³»ç»Ÿä¸­å„ä¸šåŠ¡å•å…ƒå‡ä½¿ç”¨çš„æ˜¯é›†å›¢ç§‘ç›®è¡¨ã€‚åå› å„ä¸šåŠ¡å•å…ƒä¸»è¥ä¸šåŠ¡å·®å¼‚ï¼Œéœ€æ”¹ä¸ºé›†å›¢+åˆ†çº§ç®¡æ§ï¼ˆå³å…è®¸å„ä¸šåŠ¡å•å…ƒä¼šè®¡ç§‘ç›®çš„å·®å¼‚åŒ–ç®¡ç†ï¼‰ã€‚</p><h2 id="ç¯å¢ƒç°çŠ¶"><a class="markdownIt-Anchor" href="#ç¯å¢ƒç°çŠ¶"></a> ç¯å¢ƒç°çŠ¶</h2><ol><li><strong>ä¸šåŠ¡å•å…ƒ:</strong><br />33ä¸ªä¸šåŠ¡å•å…ƒï¼ˆå«é›†å›¢è™šæ‹Ÿç»„ç»‡åŠ4ä¸ªå·¥ä¼šç»„ç»‡ï¼‰ï¼Œæœ€å¤šä¸‰çº§ï¼Œå…¶ä¸­ä¸€å®¶å¯ç”¨äº†èµ„é‡‘æ¨¡å—ã€‚</li><li><strong>è´¦ç°¿ç±»å‹:</strong><br />é»˜è®¤åŸºå‡†è´¦ç°¿ï¼Œå¦å¢åŠ ä¸€ä¸ªå·¥ä¼šè´¦ç°¿ï¼ˆç”¨äºå·¥ä¼šç»„ç»‡ä½¿ç”¨ï¼‰ã€‚</li><li><strong>è´¢åŠ¡æ ¸ç®—è´¦ç°¿:</strong><br />14ä¸ªä¸šåŠ¡å•å…ƒåŸºå‡†è´¦ç°¿ï¼ˆå‡ä½¿ç”¨é›†å›¢ç§‘ç›®è¡¨ï¼‰ï¼Œå››ä¸ªå·¥ä¼šè´¦ç°¿ã€‚</li><li><strong>ç§‘ç›®ä½“ç³»:</strong><br />åŸºå‡†è´¦ç°¿å¼•ç”¨â€œXXé›†å›¢ç§‘ç›®ä½“ç³»â€ã€‚å·¥ä¼šå¼•ç”¨â€œå·¥ä¼šç§‘ç›®ä½“ç³»â€ã€‚</li><li><strong>ä¼šè®¡ç§‘ç›®:</strong> ã€ä¼šè®¡ç§‘ç›®-è´¢åŠ¡ç»„ç»‡ã€‘ä¸­æ²¡æœ‰ç»´æŠ¤ç§‘ç›®è¡¨ï¼Œä¼šè®¡ç§‘ç›®æœªä½¿ç”¨å¤šç‰ˆæœ¬ã€‚</li><li><strong>æ€»è´¦ï¼š</strong> 2020-12å¯ç”¨ã€‚</li></ol><h2 id="è°ƒæ•´æ€è·¯"><a class="markdownIt-Anchor" href="#è°ƒæ•´æ€è·¯"></a> è°ƒæ•´æ€è·¯</h2><ol><li>ã€ä¼šè®¡ç§‘ç›®-è´¢åŠ¡ç»„ç»‡ã€‘ä¸­ä¸ºå¯¹åº”çš„è´¢åŠ¡ç»„ç»‡å¢åŠ ç»„ç»‡çº§ç§‘ç›®è¡¨ã€‚</li><li>åå°æ›´æ–°å¯¹åº”è´¢åŠ¡ç»„ç»‡çš„è´¢åŠ¡æ ¸ç®—è´¦ç°¿æ‰€å¼•ç”¨çš„ç§‘ç›®è¡¨ã€‚</li><li>åå°è°ƒæ•´bd_accountã€bd_accasoaç­‰ç§‘ç›®ç›¸å…³åŸºç¡€æ•°æ®è¡¨ã€‚</li><li>åå°è°ƒæ•´gl_detailç­‰å‡­è¯ç›¸å…³æ•°æ®è¡¨ã€‚</li><li>æ€»è´¦æœŸåˆä½™é¢ã€å‡­è¯ã€ç§‘ç›®ä½™é¢è¡¨ç­‰åŠŸèƒ½éªŒè¯ã€‚</li><li>ä¼šè®¡å¹³å°æ¢³ç†ã€‚</li></ol><h2 id="è°ƒæ•´æ­¥éª¤"><a class="markdownIt-Anchor" href="#è°ƒæ•´æ­¥éª¤"></a> è°ƒæ•´æ­¥éª¤</h2><div class="note note-info">            <p>ä¸‹è¿°è°ƒæ•´ä»¥è´¢åŠ¡ç»„ç»‡=AJJT0101 ä¸ºä¾‹ã€‚</p>          </div><h3 id="ç§‘ç›®è¡¨è°ƒæ•´"><a class="markdownIt-Anchor" href="#ç§‘ç›®è¡¨è°ƒæ•´"></a> ç§‘ç›®è¡¨è°ƒæ•´</h3><p>ã€ä¼šè®¡ç§‘ç›®-å…¨å±€ã€‘èŠ‚ç‚¹ä¸‹ï¼Œä¿®æ”¹å…¨å±€ç§‘ç›®è¡¨ï¼Œæ ¹æ®å®é™…ç®¡æ§éœ€è¦å°†â€œç§‘ç›®æ§åˆ¶çº§æ¬¡â€ä¿®æ”¹ä¸ºâ€œä¸æ§åˆ¶â€æˆ–å…¶ä»–å…·ä½“çš„çº§æ¬¡ã€‚<font color="#dd0000">è‹¥æš‚æ—¶éœ€è¦æ§åˆ¶è´¢åŠ¡ç»„ç»‡ä¸å…è®¸å¢åŠ ç§‘ç›®ï¼Œåˆ™æ— éœ€ä¿®æ”¹ã€‚</font><br />ã€ä¼šè®¡ç§‘ç›®-é›†å›¢ã€‘èŠ‚ç‚¹ä¸‹ï¼Œä¿®æ”¹é›†å›¢ç§‘ç›®è¡¨ï¼Œæ ¹æ®å®é™…ç®¡æ§éœ€è¦å°†â€œç§‘ç›®æ§åˆ¶çº§æ¬¡â€ä¿®æ”¹ä¸ºâ€œä¸æ§åˆ¶â€æˆ–å…¶ä»–å…·ä½“çš„çº§æ¬¡ã€‚<br />ã€ä¼šè®¡ç§‘ç›®-è´¢åŠ¡ç»„ç»‡ã€‘èŠ‚ç‚¹ä¸‹ï¼Œé€‰æ‹©è´¢åŠ¡ç»„ç»‡ã€ç§‘ç›®ä½“ç³»ï¼Œç‚¹å‡»[ç§‘ç›®è¡¨ç»´æŠ¤]ï¼Œå¢åŠ ç§‘ç›®è¡¨ã€‚</p><h3 id="è´¢åŠ¡æ ¸ç®—è´¦ç°¿è°ƒæ•´"><a class="markdownIt-Anchor" href="#è´¢åŠ¡æ ¸ç®—è´¦ç°¿è°ƒæ•´"></a> è´¢åŠ¡æ ¸ç®—è´¦ç°¿è°ƒæ•´</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- æŸ¥è¯¢é›†å›¢ç§‘ç›®è¡¨ä¸»é”®  1001A510000000000EQO</span><br><span class="hljs-keyword">select</span> pk_accchart,<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJ&#x27;</span>;<br><span class="hljs-comment">-- æŸ¥è¯¢AJJT0101æ–°å»ºç«‹çš„ç»„ç»‡çº§ç§‘ç›®è¡¨ä¸»é”®  1001B310000000007HEW</span><br><span class="hljs-keyword">select</span> pk_accchart,<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>;<br><span class="hljs-comment">-- æŸ¥è¯¢AJJT0101å½“å‰å¯¹åº”è´¢åŠ¡æ ¸ç®—è´¦ç°¿çš„ç§‘ç›®è¡¨  1001A510000000000EQO</span><br><span class="hljs-keyword">select</span> pk_curraccchart,pk_accountingbook <span class="hljs-keyword">from</span> org_accountingbook <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101-0001&#x27;</span>;<br><span class="hljs-comment">/*é€ä¸ªæ›´æ–°è´¢åŠ¡å¸ç°¿çš„ç§‘ç›®è¡¨ï¼ˆç”±é›†å›¢çº§æ”¹ä¸ºç»„ç»‡çº§ï¼‰*/</span><br><span class="hljs-keyword">update</span> org_accountingbook <span class="hljs-keyword">set</span> pk_curraccchart<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_accchart <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>) <span class="hljs-keyword">where</span>   pk_relorg<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>);<br></code></pre></td></tr></table></figure><h3 id="ä¼šè®¡ç§‘ç›®ç›¸å…³åŸºç¡€è¡¨æ•´ç†"><a class="markdownIt-Anchor" href="#ä¼šè®¡ç§‘ç›®ç›¸å…³åŸºç¡€è¡¨æ•´ç†"></a> ä¼šè®¡ç§‘ç›®ç›¸å…³åŸºç¡€è¡¨æ•´ç†</h3><p>å› ä¼šè®¡ç§‘ç›®æœªä½¿ç”¨å¤šç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨2022-12-31å‰å®Œæˆè°ƒæ•´ï¼Œè¿™æ · bd_account ã€ bd_accasoa å¯ä¸ç”¨è°ƒæ•´ã€‚è‹¥å…ˆåˆ›å»ºæ–°ç‰ˆæœ¬å†è°ƒæ•´ï¼Œä¼šæ¶‰åŠ bd_account ã€ bd_accasoa åŠ bd_accasoahistory ã€ bd_accasshistory ç­‰å†å²è¡¨çš„è°ƒæ•´ã€‚<br /><strong>å…³äº bd_account å’Œ bd_accasoa çš„ä¸€äº›è¡¥å……ï¼š</strong><br />bd_accasoa ä¸å…·å¤‡ç§‘ç›®çš„ç»§æ‰¿æ€§ï¼Œå³æ¯ä¸€ä¸ªç§‘ç›®è¡¨ä¸‹éƒ½ä¼šç”Ÿæˆå…·ä½“çš„å…¨é‡çš„ç§‘ç›®æ˜ç»†ï¼Œç”Ÿæˆæ–°çš„ pk_accasoa ã€‚ä½† bd_accasoa å´ç»§æ‰¿äº†é›†å›¢ç®¡æ§ç§‘ç›®çš„ pk_account ï¼ŒåŒä¸€ä¼šè®¡ç§‘ç›®ï¼Œé›†å›¢å’Œç»„ç»‡çº§çš„ pk_account å€¼ä¸€æ ·;<br />bd_account å…·å¤‡ç§‘ç›®çš„ç»§æ‰¿æ€§ï¼Œé›†å›¢ç®¡æ§ä¸‹çš„ä¼šè®¡ç§‘ç›®åœ¨ç»„ç»‡çº§ä¸å†æ–°å¢ï¼Œç»„ç»‡çº§ä»…è®°å½•æ–°å¢çš„ä¼šè®¡ç§‘ç›®ï¼ˆpk_account)ã€‚</p><h3 id="å‡­è¯ç›¸å…³æ•°æ®è¡¨æ•´ç†"><a class="markdownIt-Anchor" href="#å‡­è¯ç›¸å…³æ•°æ®è¡¨æ•´ç†"></a> å‡­è¯ç›¸å…³æ•°æ®è¡¨æ•´ç†</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*åˆ›å»ºè§†å›¾case_accasoaVoä½“ç°é›†å›¢ç§‘ç›®ä½“ç³»å’Œè´¢åŠ¡ç»„ç»‡ï¼ˆAJJT0101ï¼‰çš„pk_accasoaå¯¹åº”å…³ç³»ã€‚*/</span><br><span class="hljs-keyword">select</span> a.pk_accasoa <span class="hljs-keyword">as</span> old_accasoa,b.pk_accasoa <span class="hljs-keyword">as</span> new_accasoa  <span class="hljs-keyword">from</span> bd_accasoa a <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> bd_accasoa b <span class="hljs-keyword">on</span> a.pk_account<span class="hljs-operator">=</span>b.pk_account<br><span class="hljs-keyword">where</span>  a.pk_accchart <span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_accchart <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJ&#x27;</span>) <span class="hljs-comment">-- å›ºå®šé›†å›¢</span><br><span class="hljs-keyword">and</span> b.pk_accchart<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_accchart <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>) <span class="hljs-comment">-- æ­¤æ¬¡è°ƒæ•´çš„è´¢åŠ¡ç»„ç»‡</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*ä¿®æ”¹å‡­è¯æ˜ç»†è¡¨ä¸­ç§‘ç›®è¡¨ä¸»é”®ã€‚*/</span><br><span class="hljs-keyword">update</span> gl_detail <span class="hljs-keyword">set</span> pk_accchart<span class="hljs-operator">=</span>( <span class="hljs-keyword">select</span> pk_accchart <span class="hljs-keyword">from</span> bd_accchart <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span>)  <span class="hljs-keyword">where</span> pk_org<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span> )<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*ä¿®æ”¹å‡­è¯æ˜ç»†è¡¨ä¸­ä¼šè®¡ç§‘ç›®ä¸»é”®ã€‚*/</span><br><span class="hljs-keyword">update</span>  gl_detail <span class="hljs-keyword">set</span>  pk_accasoa<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> new_accasoa <span class="hljs-keyword">from</span> case_accasoaVo <span class="hljs-keyword">where</span> old_accasoa<span class="hljs-operator">=</span>pk_accasoa) <span class="hljs-keyword">where</span> pk_org<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span> );<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*ä¿®æ”¹å‡­è¯ä½™é¢è¡¨ä¸­ä¼šè®¡ç§‘ç›®ä¸»é”®ã€‚*/</span><br><span class="hljs-keyword">update</span>  gl_balance <span class="hljs-keyword">set</span>  pk_accasoa<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> new_accasoa <span class="hljs-keyword">from</span> case_accasoaVo <span class="hljs-keyword">where</span> old_accasoa<span class="hljs-operator">=</span>pk_accasoa) <span class="hljs-keyword">where</span> pk_org<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span> );<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*ä¿®æ”¹å‡­è¯æ˜ç»†è¡¨ä¸­å¯¹æ–¹ç§‘ç›®ä¸»é”®ã€‚è¯¥æ­¥æ“ä½œé€šè¿‡æ¸¸æ ‡éå†æ‰€æœ‰ç§‘ç›®ï¼Œè¾ƒä¸ºè€—æ—¶ã€‚å­˜å‚¨è¿‡ç¨‹ä»£ç è§ä¸‹æ–¹é™„ä»¶ã€‚*/</span><br><span class="hljs-keyword">exec</span> gldetail_oppositesubj_update <span class="hljs-variable">@p</span>_org_code<span class="hljs-operator">=</span><span class="hljs-string">&#x27;AJJT0101&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="é‡å»ºæœŸåˆå‡­è¯-é‡å»ºä½™é¢è¡¨"><a class="markdownIt-Anchor" href="#é‡å»ºæœŸåˆå‡­è¯-é‡å»ºä½™é¢è¡¨"></a> é‡å»ºæœŸåˆå‡­è¯ã€é‡å»ºä½™é¢è¡¨</h3><p>ã€åŠ¨æ€å»ºæ¨¡å¹³å°ã€‘-ã€è´¢åŠ¡ä¼šè®¡ã€‘-ã€æ€»è´¦ã€‘-ã€æœŸåˆä½™é¢ã€‘èŠ‚ç‚¹é‡å»ºæœŸåˆå‡­è¯ï¼›<br />ã€åŠ¨æ€å»ºæ¨¡å¹³å°ã€‘-ã€è´¢åŠ¡ä¼šè®¡ã€‘-ã€æ€»è´¦ã€‘-ã€ç»“è´¦ã€‘èŠ‚ç‚¹é‡å»ºä½™é¢è¡¨ã€‚<br />æ¸…ç¼“å­˜ï¼Œé‡æ–°ç™»å½•åå†éªŒè¯æ•°æ®ã€‚</p><h3 id="ä¼šè®¡å¹³å°æ¢³ç†å¦‚æœ‰"><a class="markdownIt-Anchor" href="#ä¼šè®¡å¹³å°æ¢³ç†å¦‚æœ‰"></a> ä¼šè®¡å¹³å°æ¢³ç†ï¼ˆå¦‚æœ‰ï¼‰</h3><p>å› pk_accasoaå‘ç”Ÿäº†å˜åŒ–ï¼Œè‹¥ä½¿ç”¨äº†ä¼šè®¡å¹³å°ï¼Œä¸šåŠ¡å•å…ƒçº§ç›¸å…³ç§‘ç›®æ˜ å°„å»ºè®®é‡æ–°æŒ‡å®šä¸€éã€‚</p><h3 id="é™„å­˜å‚¨è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#é™„å­˜å‚¨è¿‡ç¨‹"></a> é™„ï¼šå­˜å‚¨è¿‡ç¨‹</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*</span><br><span class="hljs-comment">åˆ›å»ºå­˜å‚¨è¿‡ç¨‹ gldetail_oppositesubj_update ï¼Œæ›´æ–°å‡­è¯æ˜ç»†è¡¨ä¸­çš„å¯¹æ–¹ç§‘ç›®</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">SET</span> ANSI_NULLS <span class="hljs-keyword">ON</span><br>GO<br><span class="hljs-keyword">SET</span> QUOTED_IDENTIFIER <span class="hljs-keyword">ON</span><br>GO<br><span class="hljs-comment">-- =============================================</span><br><span class="hljs-comment">-- Author:chendi</span><br><span class="hljs-comment">-- Create date: 2022-11-04</span><br><span class="hljs-comment">-- Description:XXé›†å›¢å‡­è¯æ˜ç»†è¡¨å¯¹æ–¹ç§‘ç›®æ›´æ–°</span><br><span class="hljs-comment">-- =============================================</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> [dbo].[gldetail_oppositesubj_update ]<br>(<br><span class="hljs-variable">@p</span>_org_code <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>)<br>)<br><span class="hljs-keyword">AS</span><br><span class="hljs-keyword">BEGIN</span><br><span class="hljs-keyword">SET</span> NOCOUNT <span class="hljs-keyword">ON</span>;<br>if <span class="hljs-keyword">exists</span> (<span class="hljs-keyword">select</span> old_accasoa,new_accasoa <span class="hljs-keyword">from</span> case_accasoaVo)<br><span class="hljs-keyword">begin</span><br><span class="hljs-comment">--å£°æ˜å˜é‡</span><br><span class="hljs-keyword">declare</span> <span class="hljs-variable">@old</span>_accasoa <span class="hljs-type">varchar</span>(max)<br><span class="hljs-keyword">declare</span> <span class="hljs-variable">@new</span>_accasoa <span class="hljs-type">varchar</span>(max)<br><span class="hljs-keyword">declare</span> <span class="hljs-variable">@pk</span>_org <span class="hljs-type">varchar</span>(max)<br><span class="hljs-keyword">set</span> <span class="hljs-variable">@pk</span>_org <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> pk_org <span class="hljs-keyword">from</span> org_orgs <span class="hljs-keyword">where</span> code<span class="hljs-operator">=</span><span class="hljs-variable">@p</span>_org_code );<br><span class="hljs-comment">--å°†SQLè¯­å¥è®¾ç½®ä¸ºæ¸¸æ ‡ï¼Œæ¸¸æ ‡ånew_cursor</span><br><span class="hljs-keyword">declare</span> new_cursor <span class="hljs-keyword">cursor</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">select</span> old_accasoa,new_accasoa <span class="hljs-keyword">from</span> case_accasoaVo;<br><span class="hljs-keyword">open</span> new_cursor<br><br><span class="hljs-comment">--è·å–æŸ¥è¯¢æ•°æ®èµ‹å€¼ç»™å˜é‡</span><br><span class="hljs-keyword">fetch</span> next <span class="hljs-keyword">from</span> new_cursor <span class="hljs-keyword">into</span> <span class="hljs-variable">@old</span>_accasoa,<span class="hljs-variable">@new</span>_accasoa<br><span class="hljs-comment">--è‹¥æ£€ç´¢åˆ°æ•°æ®ç»§ç»­æ‰§è¡Œ</span><br>while @<span class="hljs-variable">@FETCH</span>_STATUS<span class="hljs-operator">=</span><span class="hljs-number">0</span> <br><span class="hljs-keyword">BEGIN</span><br>print  <span class="hljs-variable">@old</span>_accasoa <span class="hljs-operator">+</span><span class="hljs-string">&#x27;_&#x27;</span><span class="hljs-operator">+</span><span class="hljs-variable">@new</span>_accasoa<span class="hljs-operator">+</span><span class="hljs-string">&#x27;_&#x27;</span><span class="hljs-operator">+</span><span class="hljs-variable">@pk</span>_org <br><span class="hljs-keyword">update</span>  gl_detail <span class="hljs-keyword">set</span>  oppositesubj<span class="hljs-operator">=</span>REPLACE(oppositesubj,<span class="hljs-variable">@old</span>_accasoa,<span class="hljs-variable">@new</span>_accasoa) <span class="hljs-keyword">where</span> pk_org<span class="hljs-operator">=</span><span class="hljs-variable">@pk</span>_org;<br><span class="hljs-comment">--è·å–ä¸‹ä¸€æ¡æ•°æ®å¹¶èµ‹å€¼ç»™å˜é‡</span><br><span class="hljs-keyword">fetch</span> next <span class="hljs-keyword">from</span> new_cursor <span class="hljs-keyword">into</span> <span class="hljs-variable">@old</span>_accasoa,<span class="hljs-variable">@new</span>_accasoa<br><span class="hljs-keyword">END</span><br><span class="hljs-keyword">close</span> new_cursor<br><span class="hljs-keyword">deallocate</span> new_cursor<br><span class="hljs-keyword">END</span><br><span class="hljs-keyword">END</span><br>GO<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>NC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yonyou</tag>
      
      <tag>NC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Excel|å¤šä¸ªdbfæ–‡ä»¶çš„åˆå¹¶å¤„ç†</title>
    <link href="/2022/09/14/VBA-%E5%90%88%E5%B9%B6%E5%A4%9A%E4%B8%AAdbf%E6%96%87%E4%BB%B6/"/>
    <url>/2022/09/14/VBA-%E5%90%88%E5%B9%B6%E5%A4%9A%E4%B8%AAdbf%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä»¥å‰çš„æ–‡ç« <a href="https://hncd1024.github.io/2022/08/15/Python%20os%20%E6%89%B9%E9%87%8F%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/">Python|OSã€shutilå®ç°æ‰¹é‡æ‰«æã€å¤åˆ¶ã€å‹ç¼©æ–‡ä»¶</a>ä¸­ä»‹ç»è¿‡æ‰¹é‡ä»æœ‰è§„åˆ™çš„è·¯å¾„ä¸‹å¤åˆ¶æ–‡ä»¶çš„æ“ä½œã€‚<br />ä»Šå¤©ç¢°åˆ°çš„éœ€æ±‚å’Œä¸Šæ¬¡ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä»æœ‰è§„åˆ™çš„è·¯å¾„ä¸­å¤åˆ¶æ–‡ä»¶å‡ºæ¥ï¼Œä½†å¤åˆ¶å‡ºæ¥çš„æ•°æ®æ–‡ä»¶ï¼ˆdbfæ ¼å¼ï¼‰éœ€è¦è¿›è¡Œåˆå¹¶æ“ä½œã€‚å…³äºPythonå¤„ç†dbfæ–‡ä»¶æˆ‘æ²¡æœ‰ç ”ç©¶è¿‡ï¼Œäºæ˜¯æˆ‘å°±æƒ³åˆ°äº†ä¹‹å‰å†™è¿‡çš„<a href="https://hncd1024.github.io/2019/08/29/VBA-%E5%90%88%E5%B9%B6excel%E6%96%87%E4%BB%B6/">Excel|åˆå¹¶å½“å‰ç›®å½•æ‰€æœ‰çš„excelæ–‡ä»¶</a>ã€‚å› ä¸ºdbfæ–‡ä»¶æ˜¯å¯ä»¥åœ¨excelä¸­è¿›è¡Œå¤„ç†çš„ï¼Œæ‰€ä»¥å°±çŒœæƒ³æ˜¯å¦å¯ä»¥ä¿®æ”¹.dbfæ–‡ä»¶çš„åç¼€ä¸º.xlsï¼Œä¹‹åé€šè¿‡VBAå®ç°æ‰¹é‡åˆå¹¶æ“ä½œ~</p><h2 id="å¤„ç†è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#å¤„ç†è¿‡ç¨‹"></a> å¤„ç†è¿‡ç¨‹</h2><h3 id="dbfæ–‡ä»¶æ‰¹é‡å¤åˆ¶å¹¶ä¿®æ”¹åç¼€å"><a class="markdownIt-Anchor" href="#dbfæ–‡ä»¶æ‰¹é‡å¤åˆ¶å¹¶ä¿®æ”¹åç¼€å"></a> dbfæ–‡ä»¶æ‰¹é‡å¤åˆ¶å¹¶ä¿®æ”¹åç¼€å</h3><p>æ•ˆæœå›¾å¦‚ä¸‹ï¼š<br /><img src="https://s3.bmp.ovh/imgs/2022/09/14/b6311b07d6bb7718.png" alt="dbfæ–‡ä»¶æ‰¹é‡å¤åˆ¶å¹¶ä¿®æ”¹åç¼€å" /><br />æºç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br><span class="hljs-comment"># æ¡Œé¢åˆ›å»ºæ–‡ä»¶å¤¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md</span>(<span class="hljs-params">tp=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\&#x27;</span>+tp):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        os.makedirs(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\&#x27;</span>+tp)<br>    <span class="hljs-keyword">return</span><br><br><span class="hljs-comment"># è¯»å–æ–‡ä»¶å¤¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rd</span>(<span class="hljs-params">begindate,enddate</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(begindate),<span class="hljs-built_in">int</span>(enddate)+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)):<br>            <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;\\PAR_COMPANY_CREDIT&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.dbf&#x27;</span>):<br>                shutil.copy(<span class="hljs-string">&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;\\PAR_COMPANY_CREDIT&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.dbf&#x27;</span>,<span class="hljs-string">&#x27;C:\\Users\\admin\\Desktop\\èšæºè¯„çº§ä¿¡æ¯&#x27;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;&#125;æ—¥çš„è¯„çº§ä¿¡æ¯å·²å®Œæˆå¤åˆ¶&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ— &#123;&#125;æ—¥çš„è¯„çº§ä¿¡æ¯&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ— &#123;&#125;æ—¥çš„èšæºæ•°æ®æ–‡ä»¶å¤¹&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br><br><span class="hljs-comment"># ä¿®æ”¹dbfçš„æ–‡ä»¶æ ¼å¼ä¸ºxls</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbf_to_xls</span>():<br>    os.chdir(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\èšæºè¯„çº§ä¿¡æ¯&#x27;</span>) <br>    os.system(<span class="hljs-string">r&#x27;rename *.dbf *.xls&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># è¾“å…¥èµ·æ­¢æ—¥æœŸ</span><br>    begindate = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥å¼€å§‹æ—¥æœŸï¼ˆæ ¼å¼ï¼š20220801ï¼‰:&#x27;</span>)<br>    enddate =  <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥ç»“æŸæ—¥æœŸï¼ˆæ ¼å¼ï¼š20220831ï¼‰:&#x27;</span>)<br>    <span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶å¤¹</span><br>    md(<span class="hljs-string">&quot;èšæºè¯„çº§ä¿¡æ¯&quot;</span>)<br>    <span class="hljs-comment"># éå†æ–‡ä»¶å¤¹</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;#####å¼€å§‹å¤åˆ¶&#123;&#125;-&#123;&#125;çš„è¯„çº§ä¿¡æ¯#####&#x27;</span>.<span class="hljs-built_in">format</span>(begindate,enddate))<br>    rd(begindate,enddate)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####æ–‡ä»¶å¤åˆ¶å®Œæˆ#####&quot;</span>)<br>    dbf_to_xls()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####æ–‡ä»¶åç¼€ä¿®æ”¹å®Œæˆ#####&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####ä»»åŠ¡æ‰§è¡Œå®Œæˆ#####&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="vbaæ‰¹é‡åˆå¹¶xlsæ–‡ä»¶"><a class="markdownIt-Anchor" href="#vbaæ‰¹é‡åˆå¹¶xlsæ–‡ä»¶"></a> VBAæ‰¹é‡åˆå¹¶xlsæ–‡ä»¶</h3><p>æ•ˆæœå›¾å¦‚ä¸‹ï¼š<br /><img src="https://s3.bmp.ovh/imgs/2022/09/14/49e89648b2be1e22.png" alt="VBAæ‰¹é‡åˆå¹¶xlsæ–‡ä»¶" /><br />æºç å‚è€ƒï¼š<a href="https://hncd1024.github.io/2019/08/29/VBA-%E5%90%88%E5%B9%B6excel%E6%96%87%E4%BB%B6/">Excel|åˆå¹¶å½“å‰ç›®å½•æ‰€æœ‰çš„excelæ–‡ä»¶</a></p>]]></content>
    
    
    <categories>
      
      <category>Excel</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VBA</tag>
      
      <tag>Excel</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|PyPDF2å®ç°PDFè‡ªåŠ¨æ‹†åˆ†</title>
    <link href="/2022/09/05/Python_PDFCut/"/>
    <url>/2022/09/05/Python_PDFCut/</url>
    
    <content type="html"><![CDATA[<h2 id="å®ç°pdfè‡ªåŠ¨æ‹†åˆ†"><a class="markdownIt-Anchor" href="#å®ç°pdfè‡ªåŠ¨æ‹†åˆ†"></a> å®ç°PDFè‡ªåŠ¨æ‹†åˆ†</h2><p>å‰æ®µæ—¶é—´å¸®åŒäº‹ä»ç³»ç»Ÿä¸­æ‰¹é‡å¯¼å‡ºå‡ åä¸ªæµç¨‹ï¼Œå¯¼å‡ºå‘ç°åˆå¹¶ç”Ÿæˆäº†ä¸€ä¸ªPDFï¼Œéœ€è¦æ¯2é¡µæ‹†åˆ†ä¸ºä¸€ä¸ªPDFã€‚Adobe pdfreaderè™½ç„¶å¯ä»¥æ‹†åˆ†ï¼Œä½†é€ä¸€æ‹†åˆ†è¿˜æ˜¯æ¯”è¾ƒè€—è´¹ç²¾åŠ›ã€‚åœ¨çº¿PDFå¤„ç†å·¥å…·å¤§å¤šä¹Ÿå¯ä»¥å®ç°PDFçš„æ‰¹é‡æ‹†åˆ†ï¼Œè€ƒè™‘åˆ°å…¬å¸å†…éƒ¨æ–‡ä»¶ï¼Œè¿˜æ˜¯å°½é‡é¿å…ä½¿ç”¨åœ¨çº¿å·¥å…·ã€‚ä¹‹åæˆ‘å°±ç”¨pythonå®ç°äº†PDFæ–‡ä»¶çš„è‡ªåŠ¨æ‹†åˆ†ã€‚<br /><img src="https://s3.bmp.ovh/imgs/2022/09/06/8e10d6d5a7414749.png" alt="" /><br />æºç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader, PdfWriter<br><span class="hljs-comment"># è·å–æ–‡ä»¶é¡µæ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_reader</span>(<span class="hljs-params">pdf_in</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_in,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> in_pdf:<br>        pdf_file = PdfReader(in_pdf)<br>        pages = pdf_file.getNumPages()<br>    <span class="hljs-keyword">return</span> pages<br>         <br><span class="hljs-comment"># æ‹†åˆ†pdf</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_split</span>(<span class="hljs-params">pdf_in,pdf_out,start,end</span>):<br>    <span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªpdf</span><br>    output = PdfWriter()<br>    <span class="hljs-comment"># ä»æŒ‡å®šè·¯å¾„è¯»å–ç›®æ ‡pdf</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_in, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> in_pdf:<br>        pdf_file = PdfReader(in_pdf)<br>        <span class="hljs-comment"># ä»ç›®æ ‡pdfä¸­å–å‡ºæŒ‡å®šé¡µ</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(start, end):<br>            output.addPage(pdf_file.getPage(i))<br>        <span class="hljs-comment"># å†™å…¥æ–°çš„pdfï¼Œè¾“å‡ºåˆ°æŒ‡å®šè·¯å¾„</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_out, <span class="hljs-string">&#x27;ab&#x27;</span>) <span class="hljs-keyword">as</span> out_pdf:<br>            output.write(out_pdf)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    pdf_in = <span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\æµ‹è¯•.pdf&#x27;</span><br>    pages = pdf_reader(pdf_in)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,pages):<br>        pdf_out = <span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\ç¬¬&#123;&#125;ä¸ª.pdf&#x27;</span>.<span class="hljs-built_in">format</span>(i)<br>        pdf_split(pdf_in, pdf_out, i-<span class="hljs-number">1</span> ,i)<br></code></pre></td></tr></table></figure><h2 id="ä»£ç æ›´æ–°å®Œå–„"><a class="markdownIt-Anchor" href="#ä»£ç æ›´æ–°å®Œå–„"></a> ä»£ç æ›´æ–°å®Œå–„</h2><p>åœ¨ä¹‹å‰çš„ä»£ç ä¸­ï¼Œè™½ç„¶å®ç°äº†PDFçš„è‡ªåŠ¨æ‹†åˆ†ï¼Œä½†å´ä»…ä»…æ˜¯æ¯2é¡µæ‹†åˆ†ä¸ºä¸€ä¸ªï¼Œå®é™…ä½¿ç”¨æ—¶æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯æ ¹æ®å›ºå®šçš„å†…å®¹ï¼ˆå¦‚æ ‡é¢˜ã€ç¼–å·ã€å…³é”®å­—ç­‰ï¼‰è¿›è¡Œæ‹†åˆ†çš„ã€‚æ‰€ä»¥æˆ‘åˆä¼˜åŒ–äº†ä»£ç ï¼Œé€é¡µè¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶æ ¹æ®â€œå‡ºå·®ç”³è¯·â€å…³é”®å­—è¿›è¡Œæ‹†åˆ†ï¼Œä¸”é€šè¿‡å†…å®¹ä¸­çš„â€œç¼–å·â€ç”Ÿæˆæ–‡ä»¶åã€‚ä»£ç å¦‚ä¸‹ï¼š</p><blockquote><p>ä½¿ç”¨æ—¶å‘ç°PyPDF2åº“æ›´æ–°äº†ï¼Œèˆå¼ƒäº†ä¹‹å‰reader.getNumPages()ã€writer.addPage()çš„ç”¨æ³•ï¼Œæ–°çš„ç”¨æ³•ä¸ºlen(reader.pages)ã€writer.add_page()ã€‚çŸ¥è¯†çš„å­¦ä¹ æœçœŸæ˜¯å¸¸å­¦å¸¸æ–°ã€‚ğŸ˜</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader, P dfWriter<br><span class="hljs-keyword">import</span> re<br><span class="hljs-comment"># è·å–æ–‡ä»¶é¡µæ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_reader</span>(<span class="hljs-params">pdf_in</span>):<br>    pdf_file = PdfReader(pdf_in)<br>    pages = <span class="hljs-built_in">len</span>(pdf_file.pages)<br>    <span class="hljs-keyword">return</span> pages<br><br><span class="hljs-comment"># è·å–é¡µé¢å†…å®¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_content</span>(<span class="hljs-params">pdf_in,page</span>):<br>    pdf_page = PdfReader(pdf_in)<br>    page = pdf_page.pages[page]<br>    <span class="hljs-keyword">return</span> page.extract_text()<br><br><span class="hljs-comment"># æ‹†åˆ†pdf</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_split</span>(<span class="hljs-params">pdf_in,pdf_out,start,end</span>):<br>    <span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªpdf</span><br>    output = PdfWriter()<br>    <span class="hljs-comment"># ä»æŒ‡å®šè·¯å¾„è¯»å–ç›®æ ‡pdf</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_in, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> in_pdf:<br>        pdf_file = PdfReader(in_pdf)<br>        <span class="hljs-comment"># ä»ç›®æ ‡pdfä¸­å–å‡ºæŒ‡å®šé¡µ</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(start, end):<br>            output.add_page(pdf_file.pages[i])<br>        <span class="hljs-comment"># å†™å…¥æ–°çš„pdfï¼Œè¾“å‡ºåˆ°æŒ‡å®šè·¯å¾„</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdf_out, <span class="hljs-string">&#x27;ab&#x27;</span>) <span class="hljs-keyword">as</span> out_pdf:<br>            output.write(out_pdf)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    pdf_in = <span class="hljs-string">r&#x27;C:\Users\admin\Desktop\æ–°å»ºæ–‡ä»¶å¤¹\all.pdf&#x27;</span><br>    <span class="hljs-comment"># è·å–ç¼–å·ï¼Œç”¨äºç”Ÿæˆæ‹†åˆ†åçš„pdfæ–‡ä»¶å</span><br>    pat = <span class="hljs-string">r&#x27;(?&lt;=[0-9]&#123;4&#125;\])[0-9]+&#x27;</span><br>    pages = pdf_reader(pdf_in)<br>    startPage =  pages-<span class="hljs-number">1</span><br>    endPage = pages<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(pages,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>        s = pdf_content(pdf_in,i-<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;[XXXä¿¡][å‡ºå·®ç”³è¯·]&quot;</span> <span class="hljs-keyword">in</span> s:<br>            filename = re.findall(pat,s)[<span class="hljs-number">0</span>]<br>            pdf_out = <span class="hljs-string">r&#x27;C:\Users\admin\Desktop\æ–°å»ºæ–‡ä»¶å¤¹\ç”³è¯·ç¼–å·&#123;&#125;.pdf&#x27;</span>.<span class="hljs-built_in">format</span>(filename)<br>            startPage = i-<span class="hljs-number">1</span><br>            pdf_split(pdf_in,pdf_out,startPage,endPage)<br>            startPage =  i-<span class="hljs-number">2</span><br>            endPage = i-<span class="hljs-number">1</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç”³è¯·ç¼–å·:&#123;&#125;,æ‹†åˆ†æˆåŠŸï¼&#x27;</span>.<span class="hljs-built_in">format</span>(filename))<br><br></code></pre></td></tr></table></figure><h2 id="pypdf2åº“åŸºæœ¬ç”¨æ³•æ•´ç†"><a class="markdownIt-Anchor" href="#pypdf2åº“åŸºæœ¬ç”¨æ³•æ•´ç†"></a> PyPDF2åº“åŸºæœ¬ç”¨æ³•æ•´ç†</h2><h3 id="pypdf2å†å²"><a class="markdownIt-Anchor" href="#pypdf2å†å²"></a> PyPDF2å†å²</h3><p>PyPDF2æ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æºçº¯ python PDF åº“ï¼Œèƒ½å¤Ÿåˆ†å‰²ã€åˆå¹¶ã€è£å‰ªå’Œè½¬æ¢ PDF æ–‡ä»¶çš„é¡µé¢ã€‚å®ƒè¿˜å¯ä»¥å‘ PDF æ–‡ä»¶æ·»åŠ è‡ªå®šä¹‰æ•°æ®ã€æŸ¥çœ‹é€‰é¡¹å’Œå¯†ç ã€‚PyPDF2ä¹Ÿå¯ä»¥ä» PDF ä¸­æ£€ç´¢æ–‡æœ¬å’Œå…ƒæ•°æ®ã€‚PyPDF2 è¿‘æœŸä¹Ÿæ²¡æœ‰å†æ›´æ–°äº†ï¼Œæœ€è¿‘ä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒåœ¨2016å¹´ï¼Œä½†ä½¿ç”¨çƒ­åº¦ä¾ç„¶æ²¡æœ‰æ¶ˆé€€ã€‚</p><h3 id="pdfæ–‡ä»¶ä¿¡æ¯å¤„ç†"><a class="markdownIt-Anchor" href="#pdfæ–‡ä»¶ä¿¡æ¯å¤„ç†"></a> PDFæ–‡ä»¶ä¿¡æ¯å¤„ç†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è¯»å–pdfæ–‡ä»¶ä¿¡æ¯</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_info</span>(<span class="hljs-params">pdf_in</span>):<br>Â  Â  reader = PdfReader(pdf_in)<br>Â  Â  pdfinfo = reader.metadata<br>Â  Â  <span class="hljs-keyword">return</span> reader.numPages , <span class="hljs-built_in">len</span>(reader.pages) , pdfinfo.author , pdfinfo.creator , pdfinfo.producer , pdfinfo.subject , pdfinfo.title<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span> : <br>Â  Â  pdf_in = <span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/æµ‹è¯•.pdf&#x27;</span><br>Â  Â  pdfinfo = pdf_info(pdf_in)<br>Â  Â  <span class="hljs-built_in">print</span>(pdfinfo)<br><span class="hljs-comment"># æ‰§è¡Œç»“æœï¼š (7, 7, &#x27;chen di1&#x27;, &#x27;MicrosoftÂ® Word é€‚ç”¨äº Microsoft 365&#x27;, &#x27;MicrosoftÂ® Word é€‚ç”¨äº Microsoft 365&#x27;, None, None)</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ’å…¥æ–‡ä»¶ä¿¡æ¯</span><br><span class="hljs-comment"># write metadata</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader,PdfWriter<br>reader = PdfReader(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\javascriptåŸç†.pdf&#x27;</span>)<br>writer = PdfWriter()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> reader.pages:<br>Â  Â  writer.add_page(i)<br>writer.add_metadata(<br>Â  Â  &#123;<br>Â  Â  Â  Â  <span class="hljs-string">&#x27;/Author&#x27;</span>:<span class="hljs-string">&#x27;TestAuthor&#x27;</span>,<br>Â  Â  Â  Â  <span class="hljs-string">&#x27;/Title&#x27;</span>:<span class="hljs-string">&#x27;TestTitle&#x27;</span>,<br>Â  Â  &#125;<br>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test2.pdf&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> wf :<br>Â  Â  writer.write(wf)<br></code></pre></td></tr></table></figure><h3 id="pdfåˆå¹¶"><a class="markdownIt-Anchor" href="#pdfåˆå¹¶"></a> PDFåˆå¹¶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç®€å•åˆå¹¶pdf</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfMerger<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf_combine</span>(<span class="hljs-params">pdf_in1,pdf_in2,pdf_out</span>):<br>Â  Â  outpdf = PdfMerger()<br>Â  Â  <span class="hljs-keyword">for</span> pdf <span class="hljs-keyword">in</span> [pdf_in1,pdf_in2]:<br>Â  Â  Â  Â  outpdf.append(pdf)<br>Â  Â  outpdf.write(pdf_out)<br>Â  Â  outpdf.close()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>Â  Â  pdf_in1 = <span class="hljs-string">&#x27;C:/Users/admin/Desktop/case/ç¬¬1ä¸ª.pdf&#x27;</span><br>Â  Â  pdf_in2 = <span class="hljs-string">&#x27;C:/Users/admin/Desktop/case/ç¬¬2ä¸ª.pdf&#x27;</span><br>Â  Â  pdf_out = <span class="hljs-string">&#x27;C:/Users/admin/Desktop/case/åˆå¹¶å.pdf&#x27;</span><br>Â  Â  pages = pdf_combine(pdf_in1,pdf_in2,pdf_out)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å¤špdfçµæ´»åˆå¹¶</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfMerger<br>merger = PdfMerger()<br>input1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/æµ‹è¯•.pdf&#x27;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br>input2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/ç¬¬6ä¸ª.pdf&#x27;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br>input3 = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/ç¬¬4ä¸ª.pdf&#x27;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br><span class="hljs-comment"># å–input1æ–‡ä»¶çš„å‰ä¸‰é¡µ</span><br>merger.append(fileobj=input1, pages=(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>))<br><span class="hljs-comment"># åœ¨ç¬¬äºŒé¡µåæ’å…¥input2çš„ç¬¬ä¸€é¡µ</span><br>merger.merge(position=<span class="hljs-number">2</span>, fileobj=input2, pages=(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))<br><span class="hljs-comment"># åœ¨æœ€åä¸€é¡µæ’å…¥input3æ‰€æœ‰é¡µ</span><br>merger.append(input3)<br><span class="hljs-comment"># å†™å…¥æ–°çš„pdfæ–‡ä»¶</span><br>output = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/case/åˆå¹¶æµ‹è¯•.pdf&#x27;</span>, <span class="hljs-string">&quot;wb&quot;</span>)<br>merger.write(output)<br>merger.close()<br>output.close()<br></code></pre></td></tr></table></figure><h3 id="pdfè£å‰ªä¸è½¬æ¢"><a class="markdownIt-Anchor" href="#pdfè£å‰ªä¸è½¬æ¢"></a> PDFè£å‰ªä¸è½¬æ¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># PDFè£å‰ªä¸è½¬æ¢</span><br><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfWriter, PdfReader<br>reader = PdfReader(<span class="hljs-string">&quot;example.pdf&quot;</span>)<br>writer = PdfWriter()<br><span class="hljs-comment"># æ·»åŠ ç¬¬ä¸€é¡µåˆ°pdf:</span><br>writer.add_page(reader.pages[<span class="hljs-number">0</span>])<br><span class="hljs-comment"># æ·»åŠ ç¬¬äºŒé¡µå¹¶é¡ºæ—¶é’ˆæ—‹è½¬90åº¦åˆ°pdf:</span><br>writer.add_page(reader.pages[<span class="hljs-number">1</span>].rotate(<span class="hljs-number">90</span>))<br><span class="hljs-comment"># æ·»åŠ ç¬¬ä¸‰é¡µå¹¶æˆªå–1/4åˆ°pdf:</span><br>page3 = reader.pages[<span class="hljs-number">2</span>]<br>page3.mediabox.upper_right = (<br>Â  Â  page3.mediabox.right / <span class="hljs-number">2</span>,<br>Â  Â  page3.mediabox.top / <span class="hljs-number">2</span>,<br>)<br>writer.add_page(page3)<br><span class="hljs-comment"># æ·»åŠ ä¸€äº›JavaScriptä»¥åœ¨æ‰“å¼€æ­¤PDFæ—¶å¯åŠ¨â€œæ‰“å°çª—å£â€ã€‚:</span><br>writer.add_js(<span class="hljs-string">&quot;this.print(&#123;bUI:true,bSilent:false,bShrinkToFit:true&#125;);&quot;</span>)<br><span class="hljs-comment"># è¾“å‡ºpdf</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;PyPDF2-output.pdf&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>Â  Â  writer.write(fp)<br></code></pre></td></tr></table></figure><h3 id="æå–pdfä¸­çš„æ–‡å­—"><a class="markdownIt-Anchor" href="#æå–pdfä¸­çš„æ–‡å­—"></a> æå–PDFä¸­çš„æ–‡å­—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader<br>reader = PdfReader(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test2.pdf&#x27;</span>)<br>page = reader.pages[<span class="hljs-number">0</span>]<br>content0 = page.extract_text()<br><span class="hljs-comment"># print(page.extract_text((0, 90))) # é¡µé¢å·¦è½¬90åº¦æå–</span><br><span class="hljs-built_in">print</span>(content0)<br></code></pre></td></tr></table></figure><h3 id="pdfåŠ è§£å¯†"><a class="markdownIt-Anchor" href="#pdfåŠ è§£å¯†"></a> PDFåŠ è§£å¯†</h3><p>å¦‚æœè®¡åˆ’ä½¿ç”¨ PyPDF2å¯¹ä½¿ç”¨ AES çš„ PDF è¿›è¡ŒåŠ å¯†æˆ–è§£å¯†ï¼Œåˆ™éœ€è¦å®‰è£…ä¸€äº›é¢å¤–çš„ä¾èµ–é¡¹ã€‚ä½¿ç”¨å¸¸è§„å®‰è£…æ”¯æŒä½¿ç”¨ RC4è¿›è¡ŒåŠ å¯†ã€‚</p><blockquote><p>pip install PyPDF2[crypto]</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader,PdfWriter<br>reader = PdfReader(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test2.pdf&#x27;</span>)<br>writer = PdfWriter()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> reader.pages:<br>Â  Â  writer.add_page(i)<br><span class="hljs-comment"># æ–‡ä»¶åŠ å¯†</span><br>writer.encrypt(<span class="hljs-string">&#x27;qwer1234&#x27;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test3.pdf&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f :<br>Â  Â  writer.write(f)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PyPDF2 <span class="hljs-keyword">import</span> PdfReader,PdfWriter<br>reader = PdfReader(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test3.pdf&#x27;</span>)<br>writer = PdfWriter()<br><span class="hljs-comment"># æ–‡ä»¶è§£å¯†</span><br><span class="hljs-keyword">if</span> reader.is_encrypted:<br>Â  Â  reader.decrypt(<span class="hljs-string">&#x27;qwer1234&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> reader.pages:<br>Â  Â  writer.add_page(i)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;C:/Users/Administrator/Desktop/test4.pdf&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f :<br>Â  Â  writer.write(f)<br></code></pre></td></tr></table></figure><h3 id="å…¶ä»–"><a class="markdownIt-Anchor" href="#å…¶ä»–"></a> å…¶ä»–</h3><p>ç±»ä¼¼åœ°ï¼Œpypdf2è¿˜æœ‰ç¿»é¡µã€ç¼©æ”¾ã€æ·»åŠ æ°´å°ã€é˜…è¯»/æ·»åŠ æ³¨é‡Šã€è¡¨æ ¼å¤„ç†ç­‰ã€‚å…·ä½“å¯å‚ç…§ <a href="https://pypdf2.readthedocs.io/en/latest/user/installation.html#anaconda">PyPDF2å®˜æ–¹æ–‡æ¡£</a></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>PyPDF2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>PyPDF2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|PyAutoGUIæ ¹æ®æ–‡ä»¶æ¸…å•è‡ªåŠ¨ä¸‹è½½æ–‡ä»¶</title>
    <link href="/2022/09/03/Python%20PyAutoGUI%E6%A0%B9%E6%8D%AE%E6%96%87%E4%BB%B6%E6%B8%85%E5%8D%95%E8%87%AA%E5%8A%A8%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/"/>
    <url>/2022/09/03/Python%20PyAutoGUI%E6%A0%B9%E6%8D%AE%E6%96%87%E4%BB%B6%E6%B8%85%E5%8D%95%E8%87%AA%E5%8A%A8%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a class="markdownIt-Anchor" href="#èƒŒæ™¯"></a> èƒŒæ™¯</h2><p>å‘¨äº”ä¸‹ç­å‰å…¬å¸åˆè§„éƒ¨çš„åŒäº‹æ‰¾åˆ°æˆ‘ï¼Œè¯´éœ€è¦æŠŠå…¬å¸åˆ¶åº¦ç®¡ç†ç³»ç»Ÿä¸­çš„æ‰€æœ‰åˆ¶åº¦ä¸‹è½½ä¸‹æ¥ï¼Œå¤§æ¦‚æœ‰ä¸‰ç™¾å¤šç¯‡ç°è¡Œæœ‰æ•ˆåˆ¶åº¦ã€äº”åå¤šç¯‡åºŸæ­¢åˆ¶åº¦ï¼Œç¦»è°±çš„æ˜¯åˆ¶åº¦ç³»ç»Ÿç«Ÿç„¶æ²¡æœ‰æ‰¹é‡ä¸‹è½½çš„åŠŸèƒ½ï¼ˆä¾›åº”å•†å›å¤å¯ä»¥å®ç°æ‰¹é‡ä¸‹è½½åŠŸèƒ½ï¼Œä½†æ²¡è¿™ä¹ˆå¿«~ ï¼‰ï¼Œå› ä¸ºæœ‰ç‚¹ç€æ€¥ï¼Œå°±æƒ³åˆ°é€šè¿‡pythonè„šæœ¬å®Œæˆè‡ªåŠ¨ä¸‹è½½ã€‚è¿™é‡Œå‚è€ƒäº†<a href="https://hncd1024.github.io/2022/08/14/Python%20PyAutoGUI/">Python|PyAutoGUIå®ç°è‡ªåŠ¨ç‚¹èµæ”¶è—</a>é‡Œä»‹ç»çš„pyautoguiåº“ã€‚<br />ç®€å•åˆ†æäº†ä¸‹ï¼Œæ–‡ä»¶ä¸‹è½½çš„urlæ˜¯å›ºå®šçš„urlæ ¼å¼ï¼Œä¸”é€šè¿‡getçš„æ–¹æ³•ä¼ çš„idå‚ã€‚æˆ‘å°±åå°æ•°æ®åº“æŸ¥åˆ°äº†è¦ä¸‹è½½çš„åˆ¶åº¦çš„idåˆ—è¡¨ï¼Œç„¶åå¯¼å‡ºtxtç”¨äºéå†ã€‚ä¸‹è½½çš„è„šæœ¬å¾ˆç®€å•ï¼Œå†™å®Œæˆ‘å°±å»å‡ºå»åƒé¥­äº†ï¼Œåƒä¸ªé¥­çš„åŠŸå¤«å°±å…¨éƒ¨ä¸‹è½½å®Œæˆäº†ğŸ˜ğŸ˜ğŸ˜<br />æºç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyautogui<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_download</span>(<span class="hljs-params">url</span>):<br>    pyautogui.click(<span class="hljs-number">500</span>,<span class="hljs-number">97</span>,duration=<span class="hljs-number">1.5</span>) <span class="hljs-comment"># é¡µé¢åœ°å€ï¼š Point(x=776, y=97)</span><br>    pyautogui.typewrite(url,<span class="hljs-number">0.01</span>)<br>    pyautogui.press(<span class="hljs-string">&#x27;Enter&#x27;</span>)<br>    time.sleep(<span class="hljs-number">1.5</span>) <span class="hljs-comment"># ç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½å®Œæˆ</span><br>    pyautogui.click(<span class="hljs-number">2014</span>,<span class="hljs-number">236</span>,duration=<span class="hljs-number">2</span>) <span class="hljs-comment"># ä¸‹è½½æ­£æ–‡ï¼š Point(x=2014, y=236)</span><br>    time.sleep(<span class="hljs-number">1.5</span>) <span class="hljs-comment"># ç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½å®Œæˆ</span><br>    pyautogui.click(<span class="hljs-number">393</span>,<span class="hljs-number">250</span>,duration=<span class="hljs-number">2</span>) <span class="hljs-comment"># æ‰“å¼€é™„ä»¶ï¼š Point(x=393, y=250)</span><br>    pyautogui.click(<span class="hljs-number">116</span>,<span class="hljs-number">464</span>,duration=<span class="hljs-number">1.5</span>) <span class="hljs-comment"># å…¨é€‰é™„ä»¶ï¼š Point(x=116, y=464)</span><br>    pyautogui.click(<span class="hljs-number">2371</span>,<span class="hljs-number">387</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># ä¸‹è½½é™„ä»¶ï¼š Point(x=2371, y=387)</span><br>    time.sleep(<span class="hljs-number">1.5</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># print(pyautogui.position())</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;***********è¯·10ç§’å†…åˆ‡æ¢åˆ°æµè§ˆå™¨ä¸­***********&#x27;</span>)<br>    time.sleep(<span class="hljs-number">10</span>)<br>    id_list = <span class="hljs-string">r&#x27;C:\Users\admin\Desktop\åˆ¶åº¦20220903\ç°è¡Œæœ‰æ•ˆ.txt&#x27;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(id_list , encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        count = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.readlines():<br>            url = (<span class="hljs-string">&#x27;http://xxxx/spa/document/index.jsp?id=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>            auto_download(url)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;***********å·²å®Œæˆ&#123;&#125;ç¯‡åˆ¶åº¦ä¸‹è½½***********&#x27;</span>.<span class="hljs-built_in">format</span>(count))<br>            count += <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>è¿™ç§é€šè¿‡GUIä¸‹è½½æ–‡ä»¶çš„æ–¹å¼åªèƒ½ç”¨ä½œåº”æ€¥æ–¹æ¡ˆï¼Œæ¯•ç«Ÿè¦ä¸“é—¨è…¾å‡ºæ¥ç”µè„‘ç»™å®ƒä½¿ç”¨ã€‚å¦‚æœæ—¶é—´ä¸æ€¥çš„è¯ï¼Œä¹Ÿå®Œå…¨å¯ä»¥é€šè¿‡ç³»ç»Ÿæ ‡å‡†æ¥å£å®ç°æ–‡ä»¶ä¸‹è½½ã€‚ï¼ˆå½“ç„¶æœ€ç¨³å¦¥çš„æ–¹æ¡ˆæ˜¯è®©ä¾›åº”å•†åšæˆæ‰¹é‡ä¸‹è½½çš„æ ‡å‡†åŠŸèƒ½ï¼‰<br /><font color="#dd0000">äº‹åååº”è¿‡æ¥ï¼Œæ— ä¸­ç”Ÿæœ‰çš„å·¥ä½œæˆ‘ä¸ºå•¥æ½è¿‡æ¥äº†ï¼Ÿå¤§å†¤ç§æœ¬ç§å°±æ˜¯æˆ‘~ğŸ˜‚ğŸ˜‚ğŸ˜‚</font></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>GUIè‡ªåŠ¨åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªåŠ¨åŒ–</tag>
      
      <tag>Python</tag>
      
      <tag>PyAutoGui</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|seleniumå®ç°è‡ªåŠ¨ç‚¹èµæ”¶è—(è¿›é˜¶ç‰ˆ)</title>
    <link href="/2022/08/26/Python%20selenium/"/>
    <url>/2022/08/26/Python%20selenium/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Š<a href="https://hncd1024.github.io/2022/08/14/Python%20PyAutoGUI/">Python|PyAutoGUIå®ç°è‡ªåŠ¨ç‚¹èµæ”¶è—</a>ã€‹ä¸­å†™è¿‡åˆ©ç”¨ PyAutoGUI å®ç°ç½‘é¡µè‡ªåŠ¨åŒ–ç‚¹èµ+æ”¶è—çš„åŠŸèƒ½ï¼Œå®æµ‹å‘ç°ä¾é å±å¹•åæ ‡ç³»å®Œæˆé¼ æ ‡æ“ä½œçš„å¼Šç«¯ï¼ˆå› ä¸ºå¸ƒå±€åŸå› å¯¼è‡´å›¾æ ‡ä½ç½®å˜åŒ–æ—¶ï¼Œä¸èƒ½å¾ˆå¥½çš„å¤„ç†ï¼‰ï¼ŒITäººå½“ç„¶ä¸èƒ½æ¥å—è¿™ç§ç‘•ç–µğŸ˜‚ğŸ˜‚ğŸ˜‚<br />ä»Šå¤©ç”¨å¦ä¸€ä¸ª python åº“å®ç°å…¨å¤©å€™ã€å…¨åœ°åŸŸçš„ç²¾å‡†ç‚¹å‡»ğŸ˜ğŸ˜ğŸ˜</p><h2 id="æ€è·¯"><a class="markdownIt-Anchor" href="#æ€è·¯"></a> æ€è·¯</h2><p>å’Œä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·ï¼Œä¹Ÿæ˜¯åŸºäºç½‘é¡µå®ç°å¾ªç¯æ‰“å¼€æœªè¯»æ–‡ç« ï¼Œä¹‹åè¿›è¡Œç‚¹èµ+æ”¶è—æ“ä½œã€‚ä¸åŒçš„æ˜¯ä»Šå¤©ä½¿ç”¨çš„ selenium åº“åœ¨å…ƒç´ å®šä½æ—¶æ˜¯åŸºäºç½‘é¡µhtmlçš„æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡å…ƒç´  id ã€ name ã€ class ã€ css ç”šè‡³ xpath å®ç°ç²¾å‡†å®šä½ã€‚åœ¨ç½‘é¡µçš„å¤„ç†ä¸Šæ¯” PyAutoGUI æœ‰æ›´é«˜çš„ç¨³å®šæ€§ã€‚</p><h2 id="æµ‹è¯•æ•ˆæœ"><a class="markdownIt-Anchor" href="#æµ‹è¯•æ•ˆæœ"></a> æµ‹è¯•æ•ˆæœ</h2><p><img src="https://s2.loli.net/2022/08/26/v8QpfH51kbxazW7.png" alt="æµ‹è¯•æ•ˆæœ" /></p><h3 id="æºç å¦‚ä¸‹"><a class="markdownIt-Anchor" href="#æºç å¦‚ä¸‹"></a> æºç å¦‚ä¸‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver = webdriver.Edge(<span class="hljs-string">&#x27;C:\Program Files (x86)\Microsoft\Edge\Application\msedgedriver.exe&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-comment">#æ‰“å¼€ç½‘é¡µç‰ˆAPPï¼Œå®Œæˆç™»å½•</span><br>    driver.get(<span class="hljs-string">&#x27;https://XXXX/&#x27;</span>)<br>    driver.maximize_window() <span class="hljs-comment">#çª—å£æœ€å¤§åŒ–</span><br>    time.sleep(<span class="hljs-number">25</span>) <span class="hljs-comment">#ç™»å½•ç³»ç»Ÿ</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;----------ç™»å½•æˆåŠŸ----------&#x27;</span>)<br>    <span class="hljs-keyword">if</span> driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//img[@alt=&quot;èµ„è®¯&quot;]&#x27;</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;----------æ‰“å¼€èµ„è®¯----------&#x27;</span>)<br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//img[@alt=&quot;èµ„è®¯&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;----------æ‰“å¼€æ¨è----------&#x27;</span>)<br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[text()=&quot;æ¨è&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_click</span>(<span class="hljs-params">num</span>):<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i&lt;num:<br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;çƒ­åº¦ä¼˜å…ˆ&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">0.5</span>)<br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//span[text()=&quot;æ—¶é—´ä¼˜å…ˆ&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">0.5</span>)<br>        <span class="hljs-comment"># æ‰“å¼€ç¬¬ä¸€ç¯‡æ–‡ç« </span><br>        driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div [@class=&quot;home-main-partyNews&quot; and  @style=&quot;margin-top: 0px;&quot;]//div [@class=&quot;dynamic-left-title&quot;]&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># åˆ‡æ¢æ ‡ç­¾</span><br>        window = driver.current_window_handle <span class="hljs-comment">#è·å–å½“å‰å¥æŸ„</span><br>        all_handles = driver.window_handles<br>        driver.switch_to.window(all_handles[-<span class="hljs-number">1</span>])<br>        <span class="hljs-comment"># æ”¶è—</span><br>        <span class="hljs-keyword">try</span> :<br>            driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;icon&quot;]/span[@class=&quot;pointer&quot;]/i[@class=&quot;iconfont icon-shoucanghuise&quot;]&#x27;</span>).click()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç¬¬&#123;&#125;ç¯‡æ–‡ç« æ”¶è—æˆåŠŸ&#x27;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">except</span> :<br>            <span class="hljs-keyword">try</span>:<br>                driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@style=&quot;display: block;&quot;]/span[@class=&quot;header-icon&quot;]/i[@class=&quot;iconfont icon-weishoucang&quot;]&#x27;</span>).click()<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç¬¬&#123;&#125;ç¯‡æ–‡ç« æ”¶è—æˆåŠŸ&#x27;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">except</span> :<br>                <span class="hljs-built_in">print</span>(driver.current_url) <span class="hljs-comment"># è¾“å‡ºä¸èƒ½æ‰§è¡Œçš„é¡µé¢url</span><br>                <span class="hljs-comment"># print(driver.page_source) # è¾“å‡ºä¸èƒ½æ‰§è¡Œçš„é¡µé¢æºç </span><br>                <span class="hljs-keyword">pass</span><br><br>        time.sleep(<span class="hljs-number">0.2</span>)<br>        <span class="hljs-comment"># ç‚¹èµ</span><br>        <span class="hljs-keyword">try</span> :<br>            driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@class=&quot;icon&quot;]/span[@class=&quot;pointer&quot;]/i[@class=&quot;iconfont icon-dianzanhuise&quot;]&#x27;</span>).click()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç¬¬&#123;&#125;ç¯‡æ–‡ç« ç‚¹èµæˆåŠŸ&#x27;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">except</span> :<br>            <span class="hljs-keyword">try</span>:<br>                driver.find_element(By.XPATH,<span class="hljs-string">&#x27;//div[@style=&quot;display: block;&quot;]/span[@class=&quot;header-icon&quot;]/i[@class=&quot;iconfont icon-dianzanhuise&quot;]&#x27;</span>).click()<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç¬¬&#123;&#125;ç¯‡æ–‡ç« ç‚¹èµæˆåŠŸ&#x27;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">except</span> :<br>                <span class="hljs-built_in">print</span>(driver.current_url) <span class="hljs-comment"># è¾“å‡ºä¸èƒ½æ‰§è¡Œçš„é¡µé¢url</span><br>                <span class="hljs-comment"># print(driver.page_source) # è¾“å‡ºä¸èƒ½æ‰§è¡Œçš„é¡µé¢æºç </span><br>                <span class="hljs-keyword">pass</span><br>        time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># å…³é—­å½“å‰æ ‡ç­¾</span><br>        driver.close()<br>        driver.switch_to.window(window)<br>        time.sleep(<span class="hljs-number">0.5</span>)<br>        i +=<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;----------æ‰§è¡Œå®Œæ¯•----------&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    login()<br>    auto_click(<span class="hljs-number">10</span>)<br>    <br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>selenium åŒæ ·æ˜¯ä¸€æ¬¾ Web è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œä½†åŸºæœ¬éƒ½è¢«ç”¨æ¥çˆ¬è™«äº†ã€‚æœçœŸ python çš„ä¸€åˆ‡è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·çš„å½’å®¿éƒ½æ˜¯çˆ¬è™«ğŸ˜‚ğŸ˜‚ğŸ˜‚<br />selenium è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ï¼Œåœ¨ web é¡µé¢è§£æã€æµè§ˆå™¨æ§åˆ¶ã€é¼ é”®å¤„ç†ä¸Šéƒ½æ˜¯å¾ˆçµæ´»çš„ï¼Œå¯ä»¥å¤„ç†ä¸€äº›ç›¸å¯¹å¤æ‚çš„åœºæ™¯ã€‚å¹¶ä¸”selenium æ”¯æŒ IE ã€ chrome ã€ edge ç­‰å¸¸ç”¨æµè§ˆå™¨ï¼Œä½¿ç”¨æ—¶éœ€è¦å€ŸåŠ© webdriver æ’ä»¶å®Œæˆã€‚ï¼ˆ webdriver æ’ä»¶æœ€å¥½å’Œæœ¬åœ°è®¡ç®—æœºå¯¹åº”æµè§ˆå™¨çš„ç‰ˆæœ¬ä¿æŒä¸€è‡´ï¼‰</p><div class="note note-warning">            <p>éœ€è¦æç¤ºçš„æ˜¯ï¼Œseleniumçš„4.*ç‰ˆæœ¬è¯­æ³•åšäº†æ›´æ–°ï¼Œå’Œ3.*å·®å¼‚è¾ƒå¤§ï¼Œä½¿ç”¨æ—¶éœ€ç•™æ„å®˜æ–¹æ–‡æ¡£ã€‚</p>          </div><p><img src="https://s2.loli.net/2022/08/26/eh2XlkuZPBOr1YK.png" alt="pip show selenium" /></p><h2 id="é™„seleniumåº“åŸºæœ¬ç”¨æ³•æ•´ç†"><a class="markdownIt-Anchor" href="#é™„seleniumåº“åŸºæœ¬ç”¨æ³•æ•´ç†"></a> é™„ï¼šseleniumåº“åŸºæœ¬ç”¨æ³•æ•´ç†</h2><h3 id="æ¨¡å—å¯¼å…¥"><a class="markdownIt-Anchor" href="#æ¨¡å—å¯¼å…¥"></a> æ¨¡å—å¯¼å…¥</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys<br><span class="hljs-keyword">import</span> time<br></code></pre></td></tr></table></figure><h3 id="è°ƒç”¨webdriver"><a class="markdownIt-Anchor" href="#è°ƒç”¨webdriver"></a> è°ƒç”¨webdriver</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver = webdriver.Edge(<span class="hljs-string">&quot;C:\Program Files (x86)\Microsoft\Edge\Application\msedgedriver.exe&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨getæ–¹æ³•åŠ è½½urlç•Œé¢"><a class="markdownIt-Anchor" href="#ä½¿ç”¨getæ–¹æ³•åŠ è½½urlç•Œé¢"></a> ä½¿ç”¨getæ–¹æ³•åŠ è½½urlç•Œé¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.get(<span class="hljs-string">r&#x27;https://www.baidu.com&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="æ–­è¨€æ˜¯å¦å­˜åœ¨"><a class="markdownIt-Anchor" href="#æ–­è¨€æ˜¯å¦å­˜åœ¨"></a> æ–­è¨€æ˜¯å¦å­˜åœ¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">assert</span> <span class="hljs-string">&#x27;ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“&#x27;</span> <span class="hljs-keyword">in</span> driver.title<br></code></pre></td></tr></table></figure><h3 id="é€šè¿‡-find-_-element-æ–¹æ³•æŸ¥æ‰¾å…ƒç´ "><a class="markdownIt-Anchor" href="#é€šè¿‡-find-_-element-æ–¹æ³•æŸ¥æ‰¾å…ƒç´ "></a> é€šè¿‡ find _ element æ–¹æ³•æŸ¥æ‰¾å…ƒç´ </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># &lt;input type=&quot;text&quot; name=&quot;passwd&quot; id=&quot;passwd-id&quot; class=&quot;text-a&quot;/&gt;</span><br><span class="hljs-comment"># æ”¯æŒçš„Byç±»å±æ€§æœ‰ï¼š</span><br><span class="hljs-comment"># ID = &quot;id&quot;</span><br><span class="hljs-comment"># NAME = &quot;name&quot;</span><br><span class="hljs-comment"># XPATH = &quot;xpath&quot;</span><br><span class="hljs-comment"># LINK_TEXT = &quot;link text&quot;</span><br><span class="hljs-comment"># PARTIAL_LINK_TEXT = &quot;partial link text&quot;</span><br><span class="hljs-comment"># TAG_NAME = &quot;tag name&quot;</span><br><span class="hljs-comment"># CLASS_NAME = &quot;class name&quot;</span><br><span class="hljs-comment"># CSS_SELECTOR = &quot;css selector&quot;</span><br>element = driver.find_element(By.ID, <span class="hljs-string">&quot;passwd-id&quot;</span>)<br>element = driver.find_element(By.NAME, <span class="hljs-string">&quot;passwd&quot;</span>)<br>element = driver.find_element(By.CLASS_NAME, <span class="hljs-string">&quot;text-a&quot;</span>)<br>element = driver.find_element(By.XPATH, <span class="hljs-string">&quot;//input[@id=&#x27;passwd-id&#x27;]&quot;</span>)<br>element = driver.find_element(By.CSS_SELECTOR, <span class="hljs-string">&quot;input#passwd-id&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="é”®ç›˜è¾“å…¥"><a class="markdownIt-Anchor" href="#é”®ç›˜è¾“å…¥"></a> é”®ç›˜è¾“å…¥</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">element.clear() <span class="hljs-comment"># æ¸…é™¤é¢„åŠ è½½ä¿¡æ¯</span><br>element.send_keys(<span class="hljs-string">&quot;pycon&quot;</span>) <span class="hljs-comment"># è¾“å…¥ä¿¡æ¯</span><br>element.send_keys(Keys.RETURN) <span class="hljs-comment"># æ‰§è¡ŒæŸ¥è¯¢</span><br></code></pre></td></tr></table></figure><h3 id="å¤„ç†ä¸‹æ‹‰é€‰é¡¹"><a class="markdownIt-Anchor" href="#å¤„ç†ä¸‹æ‹‰é€‰é¡¹"></a> å¤„ç†ä¸‹æ‹‰é€‰é¡¹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># è°ƒç”¨webdriver</span><br>driver = webdriver.Edge(<span class="hljs-string">&quot;C:\Program Files (x86)\Microsoft\Edge\Application\msedgedriver.exe&quot;</span>)<br><span class="hljs-comment"># ä½¿ç”¨getæ–¹æ³•åŠ è½½urlç•Œé¢</span><br>driver.get(<span class="hljs-string">r&#x27;https://www.sojson.com/time/jsq.html&#x27;</span>)<br>element = driver.find_element(By.ID, <span class="hljs-string">&quot;month3&quot;</span>)<br>all_options = element.find_elements(By.TAG_NAME, <span class="hljs-string">&quot;option&quot;</span>)<br><span class="hljs-keyword">for</span> option <span class="hljs-keyword">in</span> all_options:<br>Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Value is: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(option.get_attribute(<span class="hljs-string">&quot;value&quot;</span>))) <span class="hljs-comment"># è·å–ä¸‹æ‹‰é€‰é¡¹</span><br>Â  Â  <span class="hljs-keyword">if</span> option.get_attribute(<span class="hljs-string">&quot;value&quot;</span>)==<span class="hljs-number">10</span> : <span class="hljs-comment"># è·å–é€‰é¡¹ï¼š10</span><br>Â  Â  Â  Â  option.click()<br>time.sleep(<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><h3 id="å¤„ç†é€‰æ‹©"><a class="markdownIt-Anchor" href="#å¤„ç†é€‰æ‹©"></a> å¤„ç†é€‰æ‹©</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.support.ui <span class="hljs-keyword">import</span> Select<br>select = Select(driver.find_element(By.NAME, <span class="hljs-string">&#x27;name&#x27;</span>))<br>select.select_by_index(index)<br>select.select_by_visible_text(<span class="hljs-string">&quot;text&quot;</span>)<br>select.select_by_value(value)<br><span class="hljs-comment"># é€‰æ‹©/å–æ¶ˆé€‰æ‹©æ‰€æœ‰</span><br>select = Select(driver.find_element(By.ID, <span class="hljs-string">&#x27;id&#x27;</span>))<br>select.deselect_all()<br></code></pre></td></tr></table></figure><h3 id="å¤„ç†æ‹–æ”¾"><a class="markdownIt-Anchor" href="#å¤„ç†æ‹–æ”¾"></a> å¤„ç†æ‹–æ”¾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å¤„ç†æ‹–æ”¾ï¼Œå°†ä¸€ä¸ªå…ƒç´ æ‹–æ‹½åˆ°å¦ä¸€ä¸ªå…ƒç´ ä¸Š</span><br>element = driver.find_element(By.NAME, <span class="hljs-string">&quot;source&quot;</span>)<br>target = driver.find_element(By.NAME, <span class="hljs-string">&quot;target&quot;</span>)<br><br><span class="hljs-keyword">from</span> selenium.webdriver <span class="hljs-keyword">import</span> ActionChains<br>action_chains = ActionChains(driver)<br>action_chains.drag_and_drop(element, target).perform()<br></code></pre></td></tr></table></figure><h3 id="å®ç°çª—å£é—´çš„åˆ‡æ¢"><a class="markdownIt-Anchor" href="#å®ç°çª—å£é—´çš„åˆ‡æ¢"></a> å®ç°çª—å£é—´çš„åˆ‡æ¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.switch_to_window(<span class="hljs-string">&quot;windowName&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="è§¦å‘å¼¹çª—åå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è·å–è­¦æŠ¥"><a class="markdownIt-Anchor" href="#è§¦å‘å¼¹çª—åå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è·å–è­¦æŠ¥"></a> è§¦å‘å¼¹çª—åå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è·å–è­¦æŠ¥</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">alert = driver.switch_to.alert<br></code></pre></td></tr></table></figure><h3 id="å¤„ç†æµè§ˆå™¨å½“å‰ç½‘é¡µçš„å‰è¿›åé€€"><a class="markdownIt-Anchor" href="#å¤„ç†æµè§ˆå™¨å½“å‰ç½‘é¡µçš„å‰è¿›åé€€"></a> å¤„ç†æµè§ˆå™¨ï¼ˆå½“å‰ç½‘é¡µï¼‰çš„å‰è¿›/åé€€</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.forward()<br>driver.back()<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£"><a class="markdownIt-Anchor" href="#å‚è€ƒæ–‡æ¡£"></a> å‚è€ƒæ–‡æ¡£</h2><p><a href="https://selenium-python.readthedocs.io/index.html">Selenium with Python</a></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>GUIè‡ªåŠ¨åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªåŠ¨åŒ–</tag>
      
      <tag>Python</tag>
      
      <tag>selenium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Excel|å…³äºExcelçš„ä¸€äº›å¥‡æ€ªæ¢ç´¢</title>
    <link href="/2022/08/24/Excel_%E8%BD%AC%E5%8E%8B%E7%BC%A9%E5%8C%85/"/>
    <url>/2022/08/24/Excel_%E8%BD%AC%E5%8E%8B%E7%BC%A9%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a class="markdownIt-Anchor" href="#å†™åœ¨å‰é¢"></a> å†™åœ¨å‰é¢</h1><p>2020å¹´å‚åŠ ç½‘ç»œæ”»é˜²å¤§èµ›çš„æ—¶å€™åˆ·è¿‡ä¸€æ®µæ—¶é—´CTFçš„é¢˜ç›®ï¼Œåœ¨CTFå¤ºæ——èµ›çš„é¢˜ç›®é€‰æ‹©ä¸Šï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢æ‚é¡¹ï¼Œå› ä¸ºæ‚é¡¹çš„è§£é¢˜æ€è·¯å¤©é©¬è¡Œç©ºï¼ˆå„ç§éªšæ“ä½œå±‚å‡ºä¸ç©·ï¼Œæµè¿å¿˜è¿”~ ï¼‰ã€‚è®°å¾—jpgã€gifã€exeç­‰æ–‡ä»¶ä½œä¸ºé¢˜ç›®çš„æ—¶å€™ï¼Œæœ‰ç§è§£é¢˜æ€è·¯æ˜¯å°†æ–‡ä»¶åç¼€æ”¹æˆ.txtæˆ–è€….zipå°±èƒ½æ‰¾åˆ°éšè—çš„flagã€‚<br />å‰æ®µæ—¶é—´æœ‰åŒäº‹é—®æˆ‘è¯´excelé‡Œæœ‰å¤§é‡çš„ç…§ç‰‡ï¼Œéœ€è¦ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶å¤¹ä¸­ï¼Œé—®æœ‰æ²¡æœ‰å¿«æ·çš„æ–¹æ³•ã€‚æˆ‘ç¬¬ä¸€ååº”å°±æ˜¯å°è¯•æ”¹åç¼€åä¸º.zipï¼Œåæ¥å‘ç°æœç„¶å¯ä»¥ã€‚äºæ˜¯å°±æœ‰äº†è¿™ç¯‡åšæ–‡~<br />åæ¥åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼Œæä¾›äº†æ›´å¤šçš„ä½¿ç”¨æŠ€å·§ã€‚æœçœŸå®‡å®™çš„å°½å¤´æ˜¯0å’Œ1~<br />å‚è€ƒæ–‡çŒ®ï¼š<a href="https://zhuanlan.zhihu.com/p/30952873?utm_id=0">ä¸ä¸ºäººçŸ¥çš„Excelè½¬å‹ç¼©åŒ…é€†å¤©åŠŸèƒ½</a></p><h1 id="æµ‹è¯•è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#æµ‹è¯•è¿‡ç¨‹"></a> æµ‹è¯•è¿‡ç¨‹</h1><h2 id="ç›®æ ‡excel"><a class="markdownIt-Anchor" href="#ç›®æ ‡excel"></a> ç›®æ ‡excel</h2><p>åœ¨å‡†å¤‡å¥½çš„excelä¸­ï¼Œæ’å…¥äº†å›¾ç‰‡ã€æ’å…¥äº†æ‰¹æ³¨ã€sheet2å·¥ä½œè¡¨è®¾ç½®äº†ä¿æŠ¤å¯†ç ã€sheet3å·¥ä½œè¡¨è¢«éšè—ã€‚<br /><img src="https://s2.loli.net/2022/08/24/1OiehHKRyrUdslw.png" alt="sheet1æ’å…¥äº†ç…§ç‰‡åŠæ‰¹æ³¨" /><br /><img src="https://s2.loli.net/2022/08/24/qWaySHwI5GYX6tT.png" alt="sheet2è¢«ä¿æŠ¤" /><br /><img src="https://s2.loli.net/2022/08/24/paJHt9y5DENjRuC.png" alt="sheet3è¢«éšè—" /><br />å¤åˆ¶excelï¼Œå°†åç¼€.xlsxæ”¹ä¸º.zipï¼ˆæˆ–rarç­‰å‹ç¼©æ ¼å¼ï¼‰åè§£å‹ã€‚å¯ä»¥çœ‹åˆ°æœ‰_relsï¼ŒdocPropsã€xlä¸‰ä¸ªæ–‡ä»¶å¤¹åŠä¸€ä¸ª[content_Types].xmlæ–‡ä»¶ã€‚åç»­æ“ä½œå‡åœ¨xlæ–‡ä»¶å¤¹ä¸‹è¿›è¡Œ~<br /><img src="https://s2.loli.net/2022/08/24/5HMtIDsm2fLu6kl.png" alt="ä¿®æ”¹åç¼€åå¹¶è§£å‹" /><br /><img src="https://s2.loli.net/2022/08/24/Zg4vR3yxWHcQN2X.png" alt="è§£å‹åæ–‡ä»¶ç»„æˆ" /><br /><img src="https://s2.loli.net/2022/08/24/GTJqFux6iAwYXaU.png" alt="xlç›®å½•ç»„æˆ" /></p><h2 id="æ‰¹é‡ä¿®æ”¹sheetè¡¨åç§°"><a class="markdownIt-Anchor" href="#æ‰¹é‡ä¿®æ”¹sheetè¡¨åç§°"></a> æ‰¹é‡ä¿®æ”¹sheetè¡¨åç§°</h2><p>åœ¨xlæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°workbook.xmlï¼Œæ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ã€‚å¯ä»¥çœ‹åˆ°nameå±æ€§å³ä¸ºsheetè¡¨åç§°ï¼Œä¿®æ”¹nameçš„å€¼åä¿å­˜ã€‚<br /><img src="https://s2.loli.net/2022/08/24/zJ8MZpmNcbeHSvT.png" alt="ä¿®æ”¹sheetè¡¨åç§°" /><br />ä¿®æ”¹åå°†è§£å‹çš„æ–‡ä»¶é‡æ–°å‹ç¼©ä¸º.zipæ–‡ä»¶ï¼Œåä¿®æ”¹åç¼€åä¸º.xlsxã€‚ä¹‹åexcelæ‰“å¼€å‘ç°sheetè¡¨ä¿®æ”¹æˆåŠŸ~<br /><img src="https://s2.loli.net/2022/08/24/IMYaVGw1PUNz9Jx.png" alt="ä¿®æ”¹sheetè¡¨åç§°éªŒè¯" /></p><h2 id="å–æ¶ˆéšè—sheetè¡¨"><a class="markdownIt-Anchor" href="#å–æ¶ˆéšè—sheetè¡¨"></a> å–æ¶ˆéšè—sheetè¡¨</h2><p>åœ¨xlæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°workbook.xmlï¼Œæ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ã€‚å¯ä»¥çœ‹åˆ°state=&quot;hidden&quot;å±æ€§ï¼Œå¯¹åº”çš„sheetè¡¨å³ä¸ºéšè—çš„sheetè¡¨ã€‚åˆ é™¤state=&quot;hidden&quot;åä¿å­˜ã€‚<br /><img src="https://s2.loli.net/2022/08/24/9wnN6fJRAogqTeU.png" alt="å–æ¶ˆéšè—sheetè¡¨" /><br />ä¿®æ”¹åå°†è§£å‹çš„æ–‡ä»¶é‡æ–°å‹ç¼©ä¸º.zipæ–‡ä»¶ï¼Œåä¿®æ”¹åç¼€åä¸º.xlsxã€‚ä¹‹åexcelæ‰“å¼€å‘ç°éšè—çš„sheetè¡¨å·²å–æ¶ˆéšè—~<br /><img src="https://s2.loli.net/2022/08/24/IastC3brgl8V7O5.png" alt="å–æ¶ˆéšè—sheetè¡¨éªŒè¯" /></p><h2 id="æ‰¹é‡æå–ç…§ç‰‡"><a class="markdownIt-Anchor" href="#æ‰¹é‡æå–ç…§ç‰‡"></a> æ‰¹é‡æå–ç…§ç‰‡</h2><p>åœ¨xlæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°mediaæ–‡ä»¶å¤¹ï¼ŒåŸexcelä¸­çš„ç…§ç‰‡å·²è‡ªåŠ¨æ‰“åŒ…ä¸‹è½½~<br /><img src="https://s2.loli.net/2022/08/24/UKJjRk3bGFwCETv.png" alt="æ‰¹é‡æå–ç…§ç‰‡" /></p><h2 id="è§£å¯†å—ä¿æŠ¤çš„sheetè¡¨"><a class="markdownIt-Anchor" href="#è§£å¯†å—ä¿æŠ¤çš„sheetè¡¨"></a> è§£å¯†å—ä¿æŠ¤çš„sheetè¡¨</h2><p>åœ¨xl/worksheetsæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°éšè—çš„sheetè¡¨ï¼ˆå¦‚sheet2.xml)ï¼Œæ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ã€‚å¯ä»¥çœ‹åˆ°&lt;sheetProtection&gt;&lt;/sheetProtection&gt;å±æ€§ã€‚åˆ é™¤sheetProtectionæ ‡ç­¾åä¿å­˜ã€‚</p><p><img src="https://s2.loli.net/2022/08/24/DCkUNK279ASLOpB.png" alt="è§£å¯†å—ä¿æŠ¤çš„sheetè¡¨" /><br />ä¿®æ”¹åå°†è§£å‹çš„æ–‡ä»¶é‡æ–°å‹ç¼©ä¸º.zipæ–‡ä»¶ï¼Œåä¿®æ”¹åç¼€åä¸º.xlsxã€‚ä¹‹åexcelæ‰“å¼€å‘ç°å—ä¿æŠ¤çš„sheetè¡¨å·²å–æ¶ˆä¿æŠ¤~<br /><img src="https://s2.loli.net/2022/08/24/ChLIY347cRNzjyr.png" alt="è§£å¯†å—ä¿æŠ¤çš„sheetè¡¨åéªŒè¯" /></p><h2 id="æ‰¹é‡ä¿®æ”¹æ‰¹æ³¨"><a class="markdownIt-Anchor" href="#æ‰¹é‡ä¿®æ”¹æ‰¹æ³¨"></a> æ‰¹é‡ä¿®æ”¹æ‰¹æ³¨</h2><p>åœ¨xlæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°comments1.xmlï¼Œæ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ã€‚å¯ä»¥çœ‹åˆ°&lt;t&gt;æ ‡ç­¾å³ä¸ºæ‰¹æ³¨å†…å®¹ï¼Œä¿®æ”¹æ‰¹æ³¨å†…å®¹åä¿å­˜ã€‚<br /><img src="https://s2.loli.net/2022/08/24/16VWQ4iI2KSqZr9.png" alt="æ‰¹é‡ä¿®æ”¹æ‰¹æ³¨" /><br />ä¿®æ”¹åå°†è§£å‹çš„æ–‡ä»¶é‡æ–°å‹ç¼©ä¸º.zipæ–‡ä»¶ï¼Œåä¿®æ”¹åç¼€åä¸º.xlsxã€‚ä¹‹åexcelæ‰“å¼€å‘ç°æ‰¹æ³¨ä¿®æ”¹æˆåŠŸ~<br /><img src="https://s2.loli.net/2022/08/24/y6JTDw5PURbx9nZ.png" alt="æ‰¹é‡ä¿®æ”¹æ‰¹æ³¨åéªŒè¯" /></p>]]></content>
    
    
    <categories>
      
      <category>Excel</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VBA</tag>
      
      <tag>Excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Markdown|åŸºæœ¬ç”¨æ³•</title>
    <link href="/2022/08/19/markdown%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/"/>
    <url>/2022/08/19/markdown%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="å…³äºmarkdown"><a class="markdownIt-Anchor" href="#å…³äºmarkdown"></a> å…³äºmarkdown</h1><p>æœ€è¿‘æ¥è§¦è¿‡çš„å¾ˆå¤šç¼–è¾‘å™¨/ç½‘ç«™æ„Ÿè§‰éƒ½å¾ˆæ¸…çˆ½ï¼Œåæ¥çŸ¥é“åŸæ¥æ˜¯æ”¯æŒäº†markdownã€‚å…³äºmarkdownæˆ‘åœ¨å‰å‡ å¹´å°±æœ‰å¬è¯´è¿‡ï¼Œä½†å½“æ—¶è§‰å¾—è‡ªå·±ç”¨ä¸åˆ°ï¼Œä»¥ä¸ºåªæ˜¯htmlçš„ç®€åŒ–ç‰ˆï¼Œæ²¡æƒ³åˆ°æœ‰ä¸€å¤©ä¹Ÿä¼šå¤§å‹çœŸé¦™ç°åœº~ ğŸ˜‚ğŸ˜‚ğŸ˜‚<br />è¿™ä¸ªåšå®¢ç³»ç»Ÿçš„åšå®¢å°±æ˜¯é€šè¿‡markdownç¼–å†™çš„ï¼Œæ—¥å¸¸è®°ç¬”è®°ä¹Ÿæ…¢æ…¢ä¹ æƒ¯ä½¿ç”¨markdownäº†ï¼Œå¥½çš„å·¥å…·å½“ç„¶äº‹åŠåŠŸå€ã€‚<br />åœ¨ç¼–è¾‘å™¨çš„é€‰æ‹©ä¸Šï¼Œæˆ‘ç”¨è¿‡æœ‰é“ç¬”è®°ã€Typoraã€vscodeï¼Œä¸ªäººæœ€ç»ˆè¿˜æ˜¯å€¾å‘ä½¿ç”¨vscodeã€‚ï¼ˆvscodeçš„æ’ä»¶å¤ªå¼ºå¤§äº†ï¼Œä¸€æ¬¾ç¼–è¾‘å™¨æå®šæ—¥å¸¸æ¶‰åŠåˆ°çš„æ‰€æœ‰è®¡ç®—æœºè¯­è¨€ï¼Œç‰›æ‰¹çˆ†äº†~ ï¼‰<br /><a href="https://baike.baidu.com/item/markdown/3245829?fr=kg_general">ç™¾åº¦ç™¾ç§‘</a>å¦‚ä¸‹ï¼š</p><blockquote><p>Markdown æ˜¯ä¸€ç§è½»é‡çº§æ ‡è®°è¯­è¨€ï¼Œåˆ›å§‹äººä¸ºçº¦ç¿°Â·æ ¼é²ä¼¯ï¼ˆJohn Gruberï¼‰ã€‚ å®ƒå…è®¸äººä»¬ä½¿ç”¨æ˜“è¯»æ˜“å†™çš„çº¯æ–‡æœ¬æ ¼å¼ç¼–å†™æ–‡æ¡£ï¼Œç„¶åè½¬æ¢æˆæœ‰æ•ˆçš„ XHTMLï¼ˆæˆ–è€…HTMLï¼‰æ–‡æ¡£ã€‚è¿™ç§è¯­è¨€å¸æ”¶äº†å¾ˆå¤šåœ¨ç”µå­é‚®ä»¶ä¸­å·²æœ‰çš„çº¯æ–‡æœ¬æ ‡è®°çš„ç‰¹æ€§ã€‚<br />ç”±äº Markdown çš„è½»é‡åŒ–ã€æ˜“è¯»æ˜“å†™ç‰¹æ€§ï¼Œå¹¶ä¸”å¯¹äºå›¾ç‰‡ï¼Œå›¾è¡¨ã€æ•°å­¦å¼éƒ½æœ‰æ”¯æŒï¼Œè®¸å¤šç½‘ç«™éƒ½å¹¿æ³›ä½¿ç”¨ Markdown æ¥æ’°å†™å¸®åŠ©æ–‡æ¡£æˆ–æ˜¯ç”¨äºè®ºå›ä¸Šå‘è¡¨æ¶ˆæ¯ã€‚ å¦‚ GitHubã€Redditã€Diasporaã€Stack Exchangeã€OpenStreetMap ã€SourceForgeã€ç®€ä¹¦ç­‰ï¼Œç”šè‡³è¿˜èƒ½è¢«ä½¿ç”¨æ¥æ’°å†™ç”µå­ä¹¦ã€‚<br />ä¼˜åŠ¿ï¼š</p><ul><li>ä¸–ç•Œä¸Šæœ€æµè¡Œçš„åšå®¢å¹³å°WordPresså’Œå¤§å‹CMSå¦‚Joomlaã€Drupaléƒ½èƒ½å¾ˆå¥½çš„æ”¯æŒMarkdownã€‚å®Œå…¨é‡‡ç”¨Markdownç¼–è¾‘å™¨çš„åšå®¢å¹³å°æœ‰Ghostå’ŒTypechoç­‰ã€‚</li><li>ç”¨äºç¼–å†™è¯´æ˜æ–‡æ¡£ï¼Œä»¥â€œ<a href="http://README.md">README.md</a>â€çš„æ–‡ä»¶åä¿å­˜åœ¨è½¯ä»¶çš„ç›®å½•ä¸‹é¢ã€‚</li><li>Markdownå¯ä»¥å¿«é€Ÿè½¬åŒ–ä¸ºæ¼”è®²PPTã€Wordäº§å“æ–‡æ¡£ç”šè‡³æ˜¯ç”¨éå¸¸å°‘é‡çš„ä»£ç å®Œæˆæœ€å°å¯ç”¨åŸå‹ã€‚</li></ul></blockquote><h1 id="markdownè¯­æ³•"><a class="markdownIt-Anchor" href="#markdownè¯­æ³•"></a> markdownè¯­æ³•</h1><p>åŸºäº<a href="https://www.runoob.com/markdown/md-tutorial.html">Markdown æ•™ç¨‹|èœé¸Ÿæ•™ç¨‹</a>æ•´ç†ã€‚</p><h2 id="æ ‡é¢˜"><a class="markdownIt-Anchor" href="#æ ‡é¢˜"></a> æ ‡é¢˜</h2><p>ä½¿ç”¨â€œ# â€æ ‡è®°1-6çº§æ ‡é¢˜ï¼Œæ ‡é¢˜ä¹¦å†™æ ¼å¼ä¸ºâ€œ#â€+â€œç©ºæ ¼â€ï¼š</p><blockquote><p># ä¸€çº§æ ‡é¢˜<br />## äºŒçº§æ ‡é¢˜<br />### ä¸‰çº§æ ‡é¢˜<br />#### å››çº§æ ‡é¢˜<br />##### äº”çº§æ ‡é¢˜<br />###### å…­çº§æ ‡é¢˜</p></blockquote><h2 id="æ®µè½æ ·å¼"><a class="markdownIt-Anchor" href="#æ®µè½æ ·å¼"></a> æ®µè½æ ·å¼</h2><h3 id="æ¢è¡Œ"><a class="markdownIt-Anchor" href="#æ¢è¡Œ"></a> æ¢è¡Œ</h3><ul><li>æ–¹å¼ä¸€ï¼šæ®µè½çš„æ¢è¡Œæ˜¯ä½¿ç”¨ä¸¤ä¸ªä»¥ä¸Šç©ºæ ¼åŠ ä¸Šå›è½¦ï¼›</li><li>æ–¹å¼äºŒï¼šæ®µè½åå¢åŠ :&lt;br&gt;æ®µè½ç¬¦</li></ul><hr /><h3 id="å­—ä½“"><a class="markdownIt-Anchor" href="#å­—ä½“"></a> å­—ä½“</h3><blockquote><p>*æ–œä½“æ–‡æœ¬*<br />_æ–œä½“æ–‡æœ¬_<br />*<em>ç²—ä½“æ–‡æœ¬</em>*<br />_<em>ç²—ä½“æ–‡æœ¬</em>_<br />*<strong>ç²—æ–œä½“æ–‡æœ¬</strong>*<br />_<strong>ç²—æ–œä½“æ–‡æœ¬</strong>_</p></blockquote><hr /><h3 id="åˆ†å‰²çº¿"><a class="markdownIt-Anchor" href="#åˆ†å‰²çº¿"></a> åˆ†å‰²çº¿</h3><p>å¯ä»¥åœ¨ä¸€è¡Œä¸­ç”¨ä¸‰ä¸ªä»¥ä¸Šçš„æ˜Ÿå·ã€å‡å·ã€åº•çº¿æ¥å»ºç«‹ä¸€ä¸ªåˆ†éš”çº¿ï¼Œè¡Œå†…ä¸èƒ½æœ‰å…¶ä»–ä¸œè¥¿ã€‚</p><blockquote><p>***<br />â€”<br />___</p></blockquote><hr /><h3 id="åˆ é™¤çº¿"><a class="markdownIt-Anchor" href="#åˆ é™¤çº¿"></a> åˆ é™¤çº¿</h3><p>åªéœ€è¦åœ¨æ–‡å­—çš„ä¸¤ç«¯åŠ ä¸Šä¸¤ä¸ªæ³¢æµªçº¿ ~~ å³å¯</p><blockquote><p>ç¤ºä¾‹ï¼š~<sub>è¦åˆ é™¤çš„å†…å®¹~</sub><br />æ•ˆæœï¼š<s>è¦åˆ é™¤çš„å†…å®¹</s></p></blockquote><h3 id="ä¸‹åˆ’çº¿"><a class="markdownIt-Anchor" href="#ä¸‹åˆ’çº¿"></a> ä¸‹åˆ’çº¿</h3><p>ä¸‹åˆ’çº¿å¯ä»¥é€šè¿‡ HTML çš„ &lt;u&gt; æ ‡ç­¾æ¥å®ç°</p><blockquote><p>ç¤ºä¾‹ï¼š&lt;u&gt;å¸¦ä¸‹åˆ’çº¿çš„æ–‡æœ¬&lt;/u&gt;<br />æ•ˆæœï¼š<u>å¸¦ä¸‹åˆ’çº¿çš„æ–‡æœ¬</u></p></blockquote><h3 id="è„šæ³¨"><a class="markdownIt-Anchor" href="#è„šæ³¨"></a> è„šæ³¨</h3><blockquote><p>åˆ›å»ºè„šæ³¨æ ¼å¼ç±»ä¼¼è¿™æ ·ï¼šç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ [^1]ã€‚<br />[^1]: å¯Œå¼ºã€æ°‘ä¸»ã€æ–‡æ˜ã€å’Œè°ï¼Œè‡ªç”±ã€å¹³ç­‰ã€å…¬æ­£ã€æ³•åˆ¶ï¼Œçˆ±å›½ã€æ•¬ä¸šã€è¯šä¿¡ã€å‹å–„</p></blockquote><p>æ•ˆæœï¼šç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="å¯Œå¼ºæ°‘ä¸»æ–‡æ˜å’Œè°ï¼Œè‡ªç”±å¹³ç­‰å…¬æ­£æ³•åˆ¶ï¼Œçˆ±å›½æ•¬ä¸šè¯šä¿¡å‹å–„">[1]</span></a></sup></p><h2 id="åˆ—è¡¨"><a class="markdownIt-Anchor" href="#åˆ—è¡¨"></a> åˆ—è¡¨</h2><p>Markdown æ”¯æŒæœ‰åºåˆ—è¡¨å’Œæ— åºåˆ—è¡¨ã€‚<br />æ— åºåˆ—è¡¨ä½¿ç”¨æ˜Ÿå·(*)ã€åŠ å·(+)æˆ–æ˜¯å‡å·(-)ä½œä¸ºåˆ—è¡¨æ ‡è®°ï¼Œè¿™äº›æ ‡è®°åé¢è¦æ·»åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œç„¶åå†å¡«å†™å†…å®¹ï¼š</p><blockquote><p>* ç¬¬ä¸€é¡¹<br />+ ç¬¬äºŒé¡¹<br />- ç¬¬ä¸‰é¡¹</p></blockquote><ul><li>ç¬¬ä¸€é¡¹</li></ul><ul><li>ç¬¬äºŒé¡¹</li></ul><ul><li>ç¬¬ä¸‰é¡¹</li></ul><hr /><p>æœ‰åºåˆ—è¡¨ä½¿ç”¨æ•°å­—å¹¶åŠ ä¸Š . å·æ¥è¡¨ç¤ºï¼Œå¦‚ï¼š</p><ol><li>åºå·1</li><li>åºå·2</li></ol><hr /><p><strong>åˆ—è¡¨åµŒå¥—</strong><br />åˆ—è¡¨åµŒå¥—åªéœ€åœ¨å­åˆ—è¡¨ä¸­çš„é€‰é¡¹å‰é¢æ·»åŠ ä¸¤ä¸ªæˆ–å››ä¸ªç©ºæ ¼å³å¯ï¼š</p><ol><li>ç¬¬ä¸€é¡¹ï¼š<ul><li>ç¬¬ä¸€é¡¹åµŒå¥—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>ç¬¬ä¸€é¡¹åµŒå¥—çš„ç¬¬äºŒä¸ªå…ƒç´ </li></ul></li><li>ç¬¬äºŒé¡¹ï¼š<ul><li>ç¬¬äºŒé¡¹åµŒå¥—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>ç¬¬äºŒé¡¹åµŒå¥—çš„ç¬¬äºŒä¸ªå…ƒç´ </li></ul></li></ol><h2 id="åŒºå—-ä»£ç "><a class="markdownIt-Anchor" href="#åŒºå—-ä»£ç "></a> åŒºå—ã€ä»£ç </h2><p><strong>åŒºå—</strong>ï¼šMarkdown åŒºå—å¼•ç”¨æ˜¯åœ¨æ®µè½å¼€å¤´ä½¿ç”¨ &gt; ç¬¦å· ï¼Œç„¶ååé¢ç´§è·Ÿä¸€ä¸ªç©ºæ ¼ç¬¦å·ã€‚<br />å¦å¤–åŒºå—æ˜¯å¯ä»¥åµŒå¥—çš„ï¼Œä¸€ä¸ª &gt; ç¬¦å·æ˜¯æœ€å¤–å±‚ï¼Œä¸¤ä¸ª &gt; ç¬¦å·æ˜¯ç¬¬ä¸€å±‚åµŒå¥—ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><hr /><p><strong>ä»£ç </strong>ï¼šç”¨ ``` åŒ…è£¹ä¸€æ®µä»£ç ï¼Œå¹¶æŒ‡å®šä¸€ç§è¯­è¨€ï¼ˆä¹Ÿå¯ä»¥ä¸æŒ‡å®šï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hello world&#x27;</span>)<br>    time.sleep(<span class="hljs-number">2</span>)<br>    i += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h2 id="é“¾æ¥-å›¾ç‰‡"><a class="markdownIt-Anchor" href="#é“¾æ¥-å›¾ç‰‡"></a> é“¾æ¥ã€å›¾ç‰‡</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-selector-attr">[é“¾æ¥åç§°]</span>(é“¾æ¥åœ°å€)<br><br>æˆ–è€…<br><br>&lt;é“¾æ¥åœ°å€&gt;<br></code></pre></td></tr></table></figure><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">!<span class="hljs-selector-attr">[alt å±æ€§æ–‡æœ¬]</span>(å›¾ç‰‡åœ°å€)<br></code></pre></td></tr></table></figure><h2 id="è¡¨æ ¼"><a class="markdownIt-Anchor" href="#è¡¨æ ¼"></a> è¡¨æ ¼</h2><p>Markdown åˆ¶ä½œè¡¨æ ¼ä½¿ç”¨ | æ¥åˆ†éš”ä¸åŒçš„å•å…ƒæ ¼ï¼Œä½¿ç”¨ - æ¥åˆ†éš”è¡¨å¤´å’Œå…¶ä»–è¡Œã€‚</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">|<span class="hljs-string">  è¡¨å¤´   </span>|<span class="hljs-string"> è¡¨å¤´  </span>|<br>|<span class="hljs-string">  ----  </span>|<span class="hljs-string"> ----  </span>|<br>|<span class="hljs-string"> å•å…ƒæ ¼  </span>|<span class="hljs-string"> å•å…ƒæ ¼ </span>|<br>|<span class="hljs-string"> å•å…ƒæ ¼  </span>|<span class="hljs-string"> å•å…ƒæ ¼ </span>|<br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><table><thead><tr><th>è¡¨å¤´</th><th>è¡¨å¤´</th></tr></thead><tbody><tr><td>å•å…ƒæ ¼</td><td>å•å…ƒæ ¼</td></tr><tr><td>å•å…ƒæ ¼</td><td>å•å…ƒæ ¼</td></tr></tbody></table><p><strong>å¯¹é½æ–¹å¼</strong></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">-: è®¾ç½®å†…å®¹å’Œæ ‡é¢˜æ å±…å³å¯¹é½ã€‚<br>:- è®¾ç½®å†…å®¹å’Œæ ‡é¢˜æ å±…å·¦å¯¹é½ã€‚<br><span class="hljs-meta">:-:</span> è®¾ç½®å†…å®¹å’Œæ ‡é¢˜æ å±…ä¸­å¯¹é½ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">|<span class="hljs-string"> å·¦å¯¹é½ </span>|<span class="hljs-string"> å³å¯¹é½ </span>|<span class="hljs-string"> å±…ä¸­å¯¹é½ </span>|<br>|<span class="hljs-string"> :-----</span>|<span class="hljs-string"> ----: </span>|<span class="hljs-string"> :----: </span>|<br>|<span class="hljs-string"> å•å…ƒæ ¼ </span>|<span class="hljs-string"> å•å…ƒæ ¼ </span>|<span class="hljs-string"> å•å…ƒæ ¼ </span>|<br>|<span class="hljs-string"> å•å…ƒæ ¼ </span>|<span class="hljs-string"> å•å…ƒæ ¼ </span>|<span class="hljs-string"> å•å…ƒæ ¼ </span>|<br></code></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">å·¦å¯¹é½</th><th style="text-align:right">å³å¯¹é½</th><th style="text-align:center">å±…ä¸­å¯¹é½</th></tr></thead><tbody><tr><td style="text-align:left">å•å…ƒæ ¼</td><td style="text-align:right">å•å…ƒæ ¼</td><td style="text-align:center">å•å…ƒæ ¼</td></tr><tr><td style="text-align:left">å•å…ƒæ ¼</td><td style="text-align:right">å•å…ƒæ ¼</td><td style="text-align:center">å•å…ƒæ ¼</td></tr></tbody></table><h2 id="å…¶ä»–"><a class="markdownIt-Anchor" href="#å…¶ä»–"></a> å…¶ä»–</h2><h3 id="htmlå…ƒç´ "><a class="markdownIt-Anchor" href="#htmlå…ƒç´ "></a> HTMLå…ƒç´ </h3><p>ä¸åœ¨ Markdown æ¶µç›–èŒƒå›´ä¹‹å†…çš„æ ‡ç­¾ï¼Œéƒ½å¯ä»¥ç›´æ¥åœ¨æ–‡æ¡£é‡Œé¢ç”¨ HTML æ’°å†™ã€‚<br />ç›®å‰æ”¯æŒçš„ HTML å…ƒç´ æœ‰ï¼š&lt;kbd&gt; &lt;b&gt; &lt;i&gt; &lt;em&gt; &lt;sup&gt; &lt;sub&gt; &lt;br&gt;ç­‰ ï¼Œå¦‚ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">ä½¿ç”¨ &lt;<span class="hljs-selector-tag">kbd</span>&gt;Ctrl&lt;/<span class="hljs-selector-tag">kbd</span>&gt;+&lt;<span class="hljs-selector-tag">kbd</span>&gt;Alt&lt;/<span class="hljs-selector-tag">kbd</span>&gt;+&lt;<span class="hljs-selector-tag">kbd</span>&gt;<span class="hljs-selector-tag">Del</span>&lt;/<span class="hljs-selector-tag">kbd</span>&gt; é‡å¯ç”µè„‘<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd> é‡å¯ç”µè„‘</p><hr /><h3 id="tagä¾¿ç­¾"><a class="markdownIt-Anchor" href="#tagä¾¿ç­¾"></a> Tagä¾¿ç­¾</h3><p>åœ¨ markdown ä¸­åŠ å…¥å¦‚ä¸‹çš„ä»£ç æ¥ä½¿ç”¨ä¾¿ç­¾ã€‚æ ‡ç­¾å±æ€§åŒ…æ‹¬ï¼šprimaryã€secondaryã€successã€dangerã€warningã€infoã€light<br />æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="hljs-template-tag">&#123;% <span class="hljs-name">note</span> success %&#125;</span><span class="language-xml"></span><br><span class="language-xml">æµ‹è¯•ä¾¿ç­¾success</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;% <span class="hljs-name">endnote</span> %&#125;</span><br></code></pre></td></tr></table></figure><div class="note note-success">            <p>æµ‹è¯•ä¾¿ç­¾ success</p>          </div><div class="note note-primary">            <p>æµ‹è¯•ä¾¿ç­¾ primary</p>          </div><div class="note note-secondary">            <p>æµ‹è¯•ä¾¿ç­¾ secondary</p>          </div><div class="note note-danger">            <p>æµ‹è¯•ä¾¿ç­¾ danger</p>          </div><div class="note note-warning">            <p>æµ‹è¯•ä¾¿ç­¾ warning</p>          </div><div class="note note-info">            <p>æµ‹è¯•ä¾¿ç­¾ info</p>          </div><div class="note note-light">            <p>æµ‹è¯•ä¾¿ç­¾ light</p>          </div><h3 id="æ•°å­¦å…¬å¼"><a class="markdownIt-Anchor" href="#æ•°å­¦å…¬å¼"></a> æ•°å­¦å…¬å¼</h3><p>Markdown Preview Enhanced ä½¿ç”¨ KaTeX æˆ–è€… MathJax æ¥æ¸²æŸ“æ•°å­¦è¡¨è¾¾å¼ã€‚</p><p>KaTeX æ‹¥æœ‰æ¯” MathJax æ›´å¿«çš„æ€§èƒ½ï¼Œä½†æ˜¯å®ƒå´å°‘äº†å¾ˆå¤š MathJax æ‹¥æœ‰çš„ç‰¹æ€§ã€‚ä½ å¯ä»¥æŸ¥çœ‹ KaTeX supported functions/symbols æ¥äº†è§£ KaTeX æ”¯æŒé‚£äº›ç¬¦å·å’Œå‡½æ•°ã€‚</p><p>é»˜è®¤ä¸‹çš„åˆ†éš”ç¬¦ï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-symbol">$</span>...<span class="hljs-symbol">$</span> æˆ–è€… \(...\) ä¸­çš„æ•°å­¦è¡¨è¾¾å¼å°†ä¼šåœ¨è¡Œå†…æ˜¾ç¤ºã€‚<br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>...<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span> æˆ–è€… \[...\] æˆ–è€… ```math ä¸­çš„æ•°å­¦è¡¨è¾¾å¼å°†ä¼šåœ¨å—å†…æ˜¾ç¤ºã€‚<br></code></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">f(x)=sin(x)+12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>d</mi></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\begin{Bmatrix}   a &amp; b \\   c &amp; d\end{Bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">}</span></span></span></span></span></span></span></p>\begin{CD}   A @>a>> B \\@VbVV @AAcA \\   C @= D\end{CD}<hr /><h3 id="æµç¨‹å›¾"><a class="markdownIt-Anchor" href="#æµç¨‹å›¾"></a> æµç¨‹å›¾</h3><p>1ã€æ¨ªå‘æµç¨‹å›¾æºç æ ¼å¼ï¼š</p><pre><code class=" \mermaid">graph LRA[æ–¹å½¢] --&gt;B(åœ†è§’)    B --&gt; C&#123;æ¡ä»¶a&#125;    C --&gt;|a=1| D[ç»“æœ1]    C --&gt;|a=2| E[ç»“æœ2]    F[æ¨ªå‘æµç¨‹å›¾]</code></pre><p>2ã€ç«–å‘æµç¨‹å›¾æºç æ ¼å¼ï¼š</p><pre><code class=" \mermaid">graph TDA[æ–¹å½¢] --&gt; B(åœ†è§’)    B --&gt; C&#123;æ¡ä»¶a&#125;    C --&gt; |a=1| D[ç»“æœ1]    C --&gt; |a=2| E[ç»“æœ2]    F[ç«–å‘æµç¨‹å›¾]</code></pre><p>3ã€æ ‡å‡†æµç¨‹å›¾æºç æ ¼å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs \flow">st=&gt;start: å¼€å§‹æ¡†<br>op=&gt;operation: å¤„ç†æ¡†<br>cond=&gt;condition: åˆ¤æ–­æ¡†(æ˜¯æˆ–å¦?)<br>sub1=&gt;subroutine: å­æµç¨‹<br>io=&gt;inputoutput: è¾“å…¥è¾“å‡ºæ¡†<br>e=&gt;end: ç»“æŸæ¡†<br>st-&gt;op-&gt;cond<br>cond(yes)-&gt;io-&gt;e<br>cond(no)-&gt;sub1(right)-&gt;op<br></code></pre></td></tr></table></figure><p>4ã€æ ‡å‡†æµç¨‹å›¾æºç æ ¼å¼ï¼ˆæ¨ªå‘ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs \flow">st=&gt;start: å¼€å§‹æ¡†<br>op=&gt;operation: å¤„ç†æ¡†<br>cond=&gt;condition: åˆ¤æ–­æ¡†(æ˜¯æˆ–å¦?)<br>sub1=&gt;subroutine: å­æµç¨‹<br>io=&gt;inputoutput: è¾“å…¥è¾“å‡ºæ¡†<br>e=&gt;end: ç»“æŸæ¡†<br>st(right)-&gt;op(right)-&gt;cond<br>cond(yes)-&gt;io(bottom)-&gt;e<br>cond(no)-&gt;sub1(right)-&gt;op<br></code></pre></td></tr></table></figure><p>5ã€UMLæ—¶åºå›¾æºç æ ·ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs \sequence">å¯¹è±¡A-&gt;å¯¹è±¡B: å¯¹è±¡Bä½ å¥½å—?ï¼ˆè¯·æ±‚ï¼‰<br>Note right of å¯¹è±¡B: å¯¹è±¡Bçš„æè¿°<br>Note left of å¯¹è±¡A: å¯¹è±¡Açš„æè¿°(æç¤º)<br>å¯¹è±¡B--&gt;å¯¹è±¡A: æˆ‘å¾ˆå¥½(å“åº”)<br>å¯¹è±¡A-&gt;å¯¹è±¡B: ä½ çœŸçš„å¥½å—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>6ã€UMLæ—¶åºå›¾æºç å¤æ‚æ ·ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs \sequence">Title: æ ‡é¢˜ï¼šå¤æ‚ä½¿ç”¨<br>å¯¹è±¡A-&gt;å¯¹è±¡B: å¯¹è±¡Bä½ å¥½å—?ï¼ˆè¯·æ±‚ï¼‰<br>Note right of å¯¹è±¡B: å¯¹è±¡Bçš„æè¿°<br>Note left of å¯¹è±¡A: å¯¹è±¡Açš„æè¿°(æç¤º)<br>å¯¹è±¡B--&gt;å¯¹è±¡A: æˆ‘å¾ˆå¥½(å“åº”)<br>å¯¹è±¡B-&gt;å°ä¸‰: ä½ å¥½å—<br>å°ä¸‰--&gt;&gt;å¯¹è±¡A: å¯¹è±¡Bæ‰¾æˆ‘äº†<br>å¯¹è±¡A-&gt;å¯¹è±¡B: ä½ çœŸçš„å¥½å—ï¼Ÿ<br>Note over å°ä¸‰,å¯¹è±¡B: æˆ‘ä»¬æ˜¯æœ‹å‹<br>participant C<br>Note right of C: æ²¡äººé™ªæˆ‘ç©<br></code></pre></td></tr></table></figure><p>7ã€UMLæ ‡å‡†æ—¶åºå›¾æ ·ä¾‹ï¼š</p><pre><code class=" \mermaid">%% æ—¶åºå›¾ä¾‹å­,-&gt; ç›´çº¿ï¼Œ--&gt;è™šçº¿ï¼Œ-&gt;&gt;å®çº¿ç®­å¤´  sequenceDiagram    participant å¼ ä¸‰    participant æå››    å¼ ä¸‰-&gt;ç‹äº”: ç‹äº”ä½ å¥½å—ï¼Ÿ    loop å¥åº·æ£€æŸ¥        ç‹äº”-&gt;ç‹äº”: ä¸ç–¾ç—…æˆ˜æ–—    end    Note right of ç‹äº”: åˆç† é£Ÿç‰© &lt;br/&gt;çœ‹åŒ»ç”Ÿ...    æå››--&gt;&gt;å¼ ä¸‰: å¾ˆå¥½!    ç‹äº”-&gt;æå››: ä½ æ€ä¹ˆæ ·?    æå››--&gt;ç‹äº”: å¾ˆå¥½!</code></pre><p>8ã€ç”˜ç‰¹å›¾æ ·ä¾‹ï¼š</p><pre><code class=" \mermaid">%% è¯­æ³•ç¤ºä¾‹        gantt        dateFormat  YYYY-MM-DD        title è½¯ä»¶å¼€å‘ç”˜ç‰¹å›¾        section è®¾è®¡        éœ€æ±‚                      :done,    des1, 2014-01-06,2014-01-08        åŸå‹                      :active,  des2, 2014-01-09, 3d        UIè®¾è®¡                     :         des3, after des2, 5d    æœªæ¥ä»»åŠ¡                     :         des4, after des3, 5d        section å¼€å‘        å­¦ä¹ å‡†å¤‡ç†è§£éœ€æ±‚                      :crit, done, 2014-01-06,24h        è®¾è®¡æ¡†æ¶                             :crit, done, after des2, 2d        å¼€å‘                                 :crit, active, 3d        æœªæ¥ä»»åŠ¡                              :crit, 5d        è€                                   :2d        section æµ‹è¯•        åŠŸèƒ½æµ‹è¯•                              :active, a1, after des3, 3d        å‹åŠ›æµ‹è¯•                               :after a1  , 20h        æµ‹è¯•æŠ¥å‘Š                               : 48h</code></pre><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>å¯Œå¼ºæ°‘ä¸»æ–‡æ˜å’Œè°ï¼Œè‡ªç”±å¹³ç­‰å…¬æ­£æ³•åˆ¶ï¼Œçˆ±å›½æ•¬ä¸šè¯šä¿¡å‹å–„<p><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section></p>]]></content>
    
    
    <categories>
      
      <category>Markdown</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Markdown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|OSã€shutilå®ç°æ‰¹é‡æ‰«æã€å¤åˆ¶ã€å‹ç¼©æ–‡ä»¶</title>
    <link href="/2022/08/15/Python%20os%20%E6%89%B9%E9%87%8F%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/"/>
    <url>/2022/08/15/Python%20os%20%E6%89%B9%E9%87%8F%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<p>æ¯å¤©ä¸€åˆ’æ°´ï¼Œæ— äº‹å°ç¥ä»™ã€‚<br/><br />ä»Šå¤©æœ‰ä¸ªéœ€æ±‚ï¼šæœåŠ¡å™¨ä¸Šæœ‰ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æŒ‰æ—¥æœŸç”Ÿæˆäº†æ–‡ä»¶å¤¹ã€‚å·¥ä½œæ—¥æ‰€åœ¨çš„æ–‡ä»¶å¤¹å†…æœ‰éœ€è¦æˆ‘å¤åˆ¶ä¸‹æ¥çš„æ–‡ä»¶ã€‚è¦æ±‚æ¯ä¸ªæœˆå–ä¸€æ¬¡ã€‚<br/><br />æ¯æœˆè¦ç¿»ä¸‰åä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰¾äºŒåå¤šä¸ªæ–‡ä»¶ï¼Œè®©æˆ‘æ‰‹å·¥å¤åˆ¶æ˜¯ç»ä¸å¯èƒ½çš„ï¼ğŸ™‚ğŸ™‚ğŸ™‚é‚£å¿…é¡»è¦æä¸ªè„šæœ¬è‡ªå·±è·‘ã€‚</p><h2 id="æ€è·¯"><a class="markdownIt-Anchor" href="#æ€è·¯"></a> æ€è·¯</h2><p>1ã€æœåŠ¡å™¨ç£ç›˜å·²æ˜ å°„ï¼ˆæœ¬åœ°å¯ç›´æ¥è®¿é—®ï¼‰ã€‚<br/><br />2ã€ç¡®å®šè¦æ‰¹é‡æ‰«æçš„æ–‡ä»¶å¤¹åç§°ï¼ˆæŒ‰æ—¥æœŸå‘½åçš„æ–‡ä»¶å¤¹ï¼‰ã€‚<br/><br />3ã€æ ¹æ®è¦æ‰«æçš„æ—¥æœŸï¼ŒæŒ‰æ–‡ä»¶å¤¹åè¿›è¡Œéå†ï¼Œæ‰¾åˆ°è¦å¤åˆ¶çš„æ–‡ä»¶ã€‚<br/><br />4ã€åœ¨æ¡Œé¢åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ŒæŠŠæ‰¾åˆ°çš„æ–‡ä»¶å¤åˆ¶è¿›å»ã€‚<br/><br />5ã€å°†å¤åˆ¶å‡ºæ¥çš„æ–‡ä»¶å¤¹è¿›è¡Œå‹ç¼©ã€‚<br/></p><h2 id="è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è¿‡ç¨‹"></a> è¿‡ç¨‹</h2><h3 id="æ•ˆæœæˆªå›¾"><a class="markdownIt-Anchor" href="#æ•ˆæœæˆªå›¾"></a> æ•ˆæœæˆªå›¾</h3><p>è¦æ‰«æçš„æ–‡ä»¶å¤¹ï¼Œä¸æ•¢æƒ³è±¡è®©æˆ‘æ‰‹å·¥å»å¤åˆ¶è¦æåˆ°ä»€ä¹ˆæ—¶å€™~<br /><img src="https://s2.loli.net/2022/08/15/LB2IrOTtkRqbmMN.png" alt="ç›®æ ‡æ–‡ä»¶å¤¹" /><br />ä»£ç æ‰¹é‡æ‰§è¡Œè¿˜æ˜¯å¾ˆå¿«çš„ï¼Œè¾“å…¥è¦æ‰§è¡Œçš„åŒºé—´å³å¯ã€‚<br /><img src="https://s2.loli.net/2022/08/15/Uwz6fT5xXNYyAtH.png" alt="æ‰§è¡Œæ—¥å¿—" /><br />æ‰§è¡Œç»“æœå®Œå…¨ç¬¦åˆé¢„æœŸğŸ˜ğŸ˜ğŸ˜<br /><img src="https://s2.loli.net/2022/08/15/3AG1UhmXs96qiod.png" alt="æ‰§è¡Œç»“æœ" /><br />ç„¶åå†è‡ªåŠ¨ç”Ÿæˆå‹ç¼©æ–‡ä»¶~</p><h3 id="æºç å¦‚ä¸‹"><a class="markdownIt-Anchor" href="#æºç å¦‚ä¸‹"></a> æºç å¦‚ä¸‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br><span class="hljs-comment"># æ¡Œé¢åˆ›å»ºæ–‡ä»¶å¤¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md</span>(<span class="hljs-params">tp=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\&#x27;</span>+tp):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        os.makedirs(<span class="hljs-string">r&#x27;C:\\Users\\admin\\Desktop\\&#x27;</span>+tp)<br>    <span class="hljs-keyword">return</span><br><br><span class="hljs-comment"># è¯»å–æ–‡ä»¶å¤¹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rd</span>(<span class="hljs-params">begindate,enddate</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(begindate),<span class="hljs-built_in">int</span>(enddate)+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)):<br>            <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">r&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;\\PAR_YIELDCURVE_ALL&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.dbf&#x27;</span>):<br>                shutil.copy(<span class="hljs-string">&#x27;Z:\\gildata\\FileSync\\Download\\gz\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;\\PAR_YIELDCURVE_ALL&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.dbf&#x27;</span>,<span class="hljs-string">&#x27;C:\\Users\\admin\\Desktop\\æ”¶ç›Šç‡æ›²çº¿&#x27;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;&#125;æ—¥çš„æ”¶ç›Šç‡æ›²çº¿å·²å®Œæˆå¤åˆ¶&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ— &#123;&#125;æ—¥çš„æ”¶ç›Šç‡æ›²çº¿&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ— &#123;&#125;æ—¥çš„èšæºæ•°æ®æ–‡ä»¶å¤¹&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br><br><span class="hljs-comment"># ç”Ÿæˆå‹ç¼©åŒ…</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">zip_dir</span>(<span class="hljs-params">dirname,zipfilename</span>):<br>    shutil.make_archive(zipfilename,<span class="hljs-string">&#x27;zip&#x27;</span>,root_dir=dirname)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># è¾“å…¥èµ·æ­¢æ—¥æœŸ</span><br>    begindate = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥å¼€å§‹æ—¥æœŸï¼ˆæ ¼å¼ï¼š20220801ï¼‰:&#x27;</span>)<br>    enddate =  <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥ç»“æŸæ—¥æœŸï¼ˆæ ¼å¼ï¼š20220831ï¼‰:&#x27;</span>)<br>    <span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶å¤¹</span><br>    md(<span class="hljs-string">&quot;æ”¶ç›Šç‡æ›²çº¿&quot;</span>)<br>    <span class="hljs-comment"># éå†æ–‡ä»¶å¤¹</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;#####å¼€å§‹å¤åˆ¶&#123;&#125;-&#123;&#125;çš„æ”¶ç›Šç‡æ›²çº¿#####&#x27;</span>.<span class="hljs-built_in">format</span>(begindate,enddate))<br>    rd(begindate,enddate)<br>    <span class="hljs-comment"># åˆ›å»ºå‹ç¼©åŒ…</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####å¼€å§‹åˆ›å»ºå‹ç¼©åŒ…#####&quot;</span>)<br>    dirname=<span class="hljs-string">&#x27;C:\\Users\\admin\\Desktop\\æ”¶ç›Šç‡æ›²çº¿&#x27;</span><br>    zipfilename=<span class="hljs-string">&#x27;C:\\Users\\admin\\Desktop\\æ”¶ç›Šç‡æ›²çº¿&#123;&#125;-&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(begindate,enddate)<br>    zip_dir(dirname, zipfilename)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;#####ä»»åŠ¡æ‰§è¡Œå®Œæˆ#####&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="é™„osåº“åŸºæœ¬ç”¨æ³•æ•´ç†"><a class="markdownIt-Anchor" href="#é™„osåº“åŸºæœ¬ç”¨æ³•æ•´ç†"></a> é™„ï¼šOSåº“åŸºæœ¬ç”¨æ³•æ•´ç†</h2><p>osæ˜¯â€œoperating systemâ€çš„ç¼©å†™ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸æ“ä½œç³»ç»Ÿç›¸å…³çš„æ ‡å‡†åº“ã€‚å¦‚ï¼šæ–‡ä»¶ï¼Œç›®å½•ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚</p><h3 id="å·¥ä½œè·¯å¾„"><a class="markdownIt-Anchor" href="#å·¥ä½œè·¯å¾„"></a> å·¥ä½œè·¯å¾„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å·¥ä½œè·¯å¾„</span><br><span class="hljs-built_in">print</span>(os.getcwd()) <span class="hljs-comment"># è¿”å›å½“å‰å·¥ä½œç›®å½•</span><br>os.chdir(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\test&quot;</span>) <span class="hljs-comment"># æ”¹å˜å½“å‰</span><br></code></pre></td></tr></table></figure><h3 id="å·¥ä½œç›®å½•"><a class="markdownIt-Anchor" href="#å·¥ä½œç›®å½•"></a> å·¥ä½œç›®å½•</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å·¥ä½œç›®å½•</span><br><span class="hljs-built_in">print</span>(os.listdir()) <span class="hljs-comment"># è¿”å›å½“å‰å·¥ä½œç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹åˆ—è¡¨</span><br><span class="hljs-built_in">print</span>(os.path.exists(<span class="hljs-string">&#x27;modules&#x27;</span>)) <span class="hljs-comment"># åˆ¤æ–­æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br><br><span class="hljs-comment"># os.walk()</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">for</span> i, j, k <span class="hljs-keyword">in</span> os.walk(os.getcwd()):<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;path =&quot;</span>, i) <span class="hljs-comment"># è¿”å›å½“å‰è·¯å¾„</span><br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;List of directories =&quot;</span>, j) <span class="hljs-comment"># è¿”å›å½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶å¤¹</span><br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;List of files =&quot;</span>, k) <span class="hljs-comment"># è¿”å›å½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶åˆ—è¡¨</span><br></code></pre></td></tr></table></figure><h3 id="æ–‡ä»¶å¤¹çš„å¢åˆ "><a class="markdownIt-Anchor" href="#æ–‡ä»¶å¤¹çš„å¢åˆ "></a> æ–‡ä»¶å¤¹çš„å¢åˆ </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ–‡ä»¶å¤¹çš„å¢åˆ æ”¹</span><br>os.mkdir(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test\testa&#x27;</span>) <span class="hljs-comment"># åˆ›å»ºæ–‡ä»¶å¤¹,å½“æ‰¾ä¸åˆ°ä»»ä½•ä¸­é—´ç›®å½•æ—¶ï¼Œå®ƒä¼šå¼•å‘ FileNotFoundErrorã€‚</span><br>os.makedirs(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test\testb&#x27;</span>) <span class="hljs-comment"># åˆ›å»ºæ–‡ä»¶å¤¹,ä¸ mkdir ()ä¸åŒï¼Œå®ƒä¸ä¼šå¼•å‘é”™è¯¯ã€‚ç›¸åï¼Œå®ƒåˆ›å»ºæ‰€æœ‰ç¼ºå°‘çš„å­ç›®å½•ã€‚</span><br>os.removedirs(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test\testa&#x27;</span>) <span class="hljs-comment"># åˆ é™¤æ–‡ä»¶å¤¹ï¼Œå½“æ–‡ä»¶å¤¹ä¸å­˜åœ¨æ—¶æŠ¥é”™ã€‚</span><br>os.rmdir(<span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\test\testb&#x27;</span>) <span class="hljs-comment"># åˆ é™¤ç°æœ‰ç›®å½• </span><br>os.remove(<span class="hljs-string">&#x27;test.txt&#x27;</span>) <span class="hljs-comment"># åˆ é™¤æ–‡ä»¶</span><br>os.unlink(<span class="hljs-string">&#x27;test2.txt&#x27;</span>) <span class="hljs-comment"># åˆ é™¤æ–‡ä»¶</span><br>os.renames(<span class="hljs-string">r&#x27;C:\Users\a&#x27;</span>,<span class="hljs-string">r&#x27;C:\Users\test\b&#x27;</span>) <span class="hljs-comment"># ä¿®æ”¹ç›®å½•</span><br>os.rename(<span class="hljs-string">&quot;modules2&quot;</span>, <span class="hljs-string">&quot;modules3&quot;</span>) <span class="hljs-comment"># é‡å‘½åæ–‡ä»¶å¤¹æˆ–æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><h3 id="è¿è¡Œshellå‘½ä»¤"><a class="markdownIt-Anchor" href="#è¿è¡Œshellå‘½ä»¤"></a> è¿è¡Œshellå‘½ä»¤</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">os.system(<span class="hljs-string">&#x27;ipconfig&#x27;</span>) <span class="hljs-comment"># è¿è¡Œshellå‘½ä»¤</span><br></code></pre></td></tr></table></figure><h3 id="è·å–æ–‡ä»¶å¤§å°"><a class="markdownIt-Anchor" href="#è·å–æ–‡ä»¶å¤§å°"></a> è·å–æ–‡ä»¶å¤§å°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(os.path.getsize(<span class="hljs-string">&#x27;main.py&#x27;</span>)) <span class="hljs-comment"># è·å–æ–‡ä»¶å¤§å°ï¼Œå­—èŠ‚</span><br></code></pre></td></tr></table></figure><h3 id="æ‰“å¼€åˆ°å‘½ä»¤çš„ç®¡é“æˆ–ä»å‘½ä»¤æ‰“å¼€ç®¡é“"><a class="markdownIt-Anchor" href="#æ‰“å¼€åˆ°å‘½ä»¤çš„ç®¡é“æˆ–ä»å‘½ä»¤æ‰“å¼€ç®¡é“"></a> æ‰“å¼€åˆ°å‘½ä»¤çš„ç®¡é“æˆ–ä»å‘½ä»¤æ‰“å¼€ç®¡é“</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ‰“å¼€åˆ°å‘½ä»¤çš„ç®¡é“æˆ–ä»å‘½ä»¤æ‰“å¼€ç®¡é“</span><br>file_name=<span class="hljs-string">r&#x27;python C:\Users\Administrator\Desktop\test\a.py&#x27;</span><br>file = os.popen(file_name,<span class="hljs-string">&#x27;w&#x27;</span>)<br>file.writelines(<span class="hljs-string">&#x27;print(&quot;hello world2!!!&quot;&#x27;</span>)<br>file = os.popen(file_name,<span class="hljs-string">&#x27;r&#x27;</span>) <br><span class="hljs-built_in">print</span>(file.read())<br>file.close() <span class="hljs-comment"># å…³é—­ç”± popen ()æˆ– tube ()æ‰“å¼€çš„æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><h3 id="å‚è€ƒæ–‡æ¡£"><a class="markdownIt-Anchor" href="#å‚è€ƒæ–‡æ¡£"></a> å‚è€ƒæ–‡æ¡£</h3><p><a href="https://pythongeeks.org/python-os-module/">Python OS Module - Python Geeks</a></p><h2 id="é™„shutilåº“åŸºæœ¬ç”¨æ³•æ•´ç†"><a class="markdownIt-Anchor" href="#é™„shutilåº“åŸºæœ¬ç”¨æ³•æ•´ç†"></a> é™„ï¼šshutilåº“åŸºæœ¬ç”¨æ³•æ•´ç†</h2><p>shutilÂ æ˜¯ python ä¸­çš„é«˜çº§æ–‡ä»¶æ“ä½œæ¨¡å—ï¼Œä¸ os æ¨¡å—å½¢æˆäº’è¡¥çš„å…³ç³»ï¼Œos ä¸»è¦æä¾›äº†æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æ–°å»ºã€åˆ é™¤ã€æŸ¥çœ‹ç­‰æ–¹æ³•ï¼Œè¿˜æä¾›äº†å¯¹æ–‡ä»¶ä»¥åŠç›®å½•çš„è·¯å¾„æ“ä½œã€‚shutil æ¨¡å—æä¾›äº†ç§»åŠ¨ã€å¤åˆ¶ã€ å‹ç¼©ã€è§£å‹ç­‰æ“ä½œï¼Œæ°å¥½ä¸ os äº’è¡¥ï¼Œos å’Œ shutil ä¸€èµ·ä½¿ç”¨ï¼ŒåŸºæœ¬èƒ½å®Œæˆæ‰€æœ‰æ–‡ä»¶çš„æ“ä½œã€‚æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¨¡å—ã€‚</p><h3 id="å¤åˆ¶"><a class="markdownIt-Anchor" href="#å¤åˆ¶"></a> å¤åˆ¶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å¤åˆ¶æ–‡ä»¶</span><br>shutil.copy(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case.txt&quot;</span>,<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case&quot;</span>)<br><br><span class="hljs-comment"># å°†ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­</span><br>shutil.copyfile(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case.txt&quot;</span>,<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case\case3.txt&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">shutil.copytree() æè¿°ï¼šå¤åˆ¶æ•´ä¸ªç›®å½•åŠæ–‡ä»¶ï¼Œä¸éœ€è¦çš„æ–‡ä»¶ç±»å‹å¯ä»¥ä¸å¤åˆ¶</span><br><span class="hljs-string">è¯­æ³•ï¼šshutil.copytree(oripath, despath, ignore= shutil.ignore_patterns(&quot;*.xls&quot;, &quot;*.doc&quot;))</span><br><span class="hljs-string">å‚æ•°ï¼š</span><br><span class="hljs-string">oripath : &quot;æ¥æºè·¯å¾„&quot;</span><br><span class="hljs-string">despath : &quot;ç›®æ ‡è·¯å¾„&quot;</span><br><span class="hljs-string">ignore : shutil.ignore_patterns() æ˜¯å¯¹å†…å®¹è¿›è¡Œå¿½ç•¥ç­›é€‰ï¼Œå°†å¯¹åº”çš„å†…å®¹è¿›è¡Œå¿½ç•¥ã€‚</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>path1 = <span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\case&#x27;</span><br>path2 = <span class="hljs-string">r&#x27;C:\Users\Administrator\Desktop\case1\copytree&#x27;</span><br>shutil.copytree(path1,path2,ignore=shutil.ignore_patterns(<span class="hljs-string">&#x27;case.txt&#x27;</span>,<span class="hljs-string">&#x27;*.DOC&#x27;</span>)) <span class="hljs-comment"># case.txtå’Œdocæ–‡ä»¶å¿½ç•¥</span><br></code></pre></td></tr></table></figure><h3 id="ç§»åŠ¨"><a class="markdownIt-Anchor" href="#ç§»åŠ¨"></a> ç§»åŠ¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç§»åŠ¨æ–‡ä»¶</span><br>shutil.move(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case.txt&quot;</span>,<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="é€’å½’åˆ é™¤"><a class="markdownIt-Anchor" href="#é€’å½’åˆ é™¤"></a> é€’å½’åˆ é™¤</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># é€’å½’åˆ é™¤æ–‡ä»¶åŠæ–‡ä»¶å¤¹</span><br>shutil.rmtree(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\unpack&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹ç£ç›˜ä¿¡æ¯"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹ç£ç›˜ä¿¡æ¯"></a> æŸ¥çœ‹ç£ç›˜ä¿¡æ¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æŸ¥çœ‹ç£ç›˜ä¿¡æ¯</span><br><span class="hljs-built_in">print</span>(shutil.disk_usage(<span class="hljs-string">&#x27;d:&#x27;</span>))<br></code></pre></td></tr></table></figure><h3 id="å‹ç¼©ä¸è§£å‹ç¼©"><a class="markdownIt-Anchor" href="#å‹ç¼©ä¸è§£å‹ç¼©"></a> å‹ç¼©ä¸è§£å‹ç¼©</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">shutil.make_archive æè¿°ï¼šå‹ç¼©æ‰“åŒ…</span><br><span class="hljs-string">è¯­æ³•ï¼šmake_archive(base_name, format, root_dir=None, base_dir=None, verbose=0,dry_run=0, owner=None, group=None, logger=None)</span><br><span class="hljs-string">å‹ç¼©æ‰“åŒ…</span><br><span class="hljs-string">base_nameï¼š å‹ç¼©åŒ…çš„æ–‡ä»¶åï¼Œä¹Ÿå¯ä»¥æ˜¯å‹ç¼©åŒ…çš„è·¯å¾„ã€‚åªæ˜¯æ–‡ä»¶åæ—¶ï¼Œåˆ™ä¿å­˜è‡³å½“å‰ç›®å½•ï¼Œå¦åˆ™ä¿å­˜è‡³æŒ‡å®šè·¯å¾„</span><br><span class="hljs-string">formatï¼š å‹ç¼©æˆ–è€…æ‰“åŒ…æ ¼å¼ &quot;zip&quot;, &quot;tar&quot;, &quot;bztar&quot;or &quot;gztar&quot;</span><br><span class="hljs-string">root_dir : å°†å“ªä¸ªç›®å½•æˆ–è€…æ–‡ä»¶æ‰“åŒ…ï¼ˆä¹Ÿå°±æ˜¯æºæ–‡ä»¶ï¼‰</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>shutil.make_archive(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\a&quot;</span>,<span class="hljs-string">&#x27;zip&#x27;</span>,root_dir=<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\case&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">shutil.unpack_archive æè¿°ï¼š è·å–æ”¯æŒçš„å‹ç¼©æ–‡ä»¶æ ¼å¼ã€‚ç›®å‰æ”¯æŒçš„æœ‰ï¼štarã€zipã€gztarã€bztarã€‚åœ¨Python3è¿˜å¤šæ”¯æŒä¸€ç§æ ¼å¼xztar</span><br><span class="hljs-string">è¯­æ³•ï¼šunpack_archive(filename, extract_dir=None, format=None)</span><br><span class="hljs-string">filenameï¼šæ–‡ä»¶è·¯å¾„</span><br><span class="hljs-string">extract_dirï¼šè§£å‹è‡³çš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚æ–‡ä»¶å¤¹å¯ä»¥ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ</span><br><span class="hljs-string">formatï¼šè§£å‹æ ¼å¼ï¼Œé»˜è®¤ä¸ºNoneï¼Œä¼šæ ¹æ®æ‰©å±•åè‡ªåŠ¨é€‰æ‹©è§£å‹æ ¼å¼</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>shutil.unpack_archive(<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\a.zip&quot;</span>,<span class="hljs-string">r&quot;C:\Users\Administrator\Desktop\unpack&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="å‚è€ƒæ–‡æ¡£-2"><a class="markdownIt-Anchor" href="#å‚è€ƒæ–‡æ¡£-2"></a> å‚è€ƒæ–‡æ¡£</h3><p><a href="https://docs.python.org/zh-cn/3/library/shutil.html">shutil â€” é«˜é˜¶æ–‡ä»¶æ“ä½œ â€” Python 3.10.7 æ–‡æ¡£</a></p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>OS</category>
      
      <category>shutil</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªåŠ¨åŒ–</tag>
      
      <tag>Python</tag>
      
      <tag>OS</tag>
      
      <tag>shutil</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python|PyAutoGUIå®ç°è‡ªåŠ¨ç‚¹èµæ”¶è—</title>
    <link href="/2022/08/14/Python%20PyAutoGUI/"/>
    <url>/2022/08/14/Python%20PyAutoGUI/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å…¬å¸è¦æ±‚æ¯æœˆè¦åœ¨æŸAPPä¸­å®Œæˆ1000ç§¯åˆ†çš„ç§¯ç´¯ï¼Œç®—ä¸‹æ¥æ¯æœˆè¦ç‚¹èµ+æ”¶è—æ–‡ç« ä¸‰ç™¾å¤šç¯‡ã€‚åƒæˆ‘è¿™æ ·ç§¯æçš„é’å¹´å½“ç„¶è¦æƒ³åŠæ³•å·ä¸ªæ‡’~</p><h2 id="æ€è·¯"><a class="markdownIt-Anchor" href="#æ€è·¯"></a> æ€è·¯</h2><p>è¯¥APPæ°å·§æœ‰ç½‘é¡µç‰ˆï¼ˆæ²¡æœ‰ç½‘é¡µç‰ˆçš„è¯PCç«¯ä¼°è®¡è¿˜è¦æ­å»ºä¸ªå®‰å“æ¨¡æ‹Ÿå™¨ï¼‰ã€‚æœ€å¼€å§‹å°è¯•è¿‡é€šè¿‡<a href="https://pypi.org/project/requests/">requestsåº“</a>è·å–æœªè¯»æ–‡ç« å¹¶æ›´æ–°ç§¯åˆ†ï¼Œä¸è¿‡å°è¯•äº†å¾ˆå¤šæµè§ˆå™¨çš„ä¼ªè£…ä¾ç„¶å¤±è´¥äº†ğŸ˜‚ğŸ˜‚åæ¥è€ƒè™‘é€šè¿‡<a href="https://pypi.org/project/PyAutoGUI/">PyAutoGUIåº“</a>å®ç°æ¨¡æ‹Ÿé¼ æ ‡çš„æ“ä½œã€‚<br><br />PyAutoGUIæ˜¯ä¸€ä¸ªçº¯Pythonçš„GUIè‡ªåŠ¨åŒ–åº“ï¼Œå¯å®ç°é¼ æ ‡å’Œé”®ç›˜çš„æ“ä½œã€‚å®ç°æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼šæ‰“å¼€ç›®æ ‡ç½‘ç«™ï¼Œé€šè¿‡ä»£ç æ§åˆ¶é¼ æ ‡ï¼Œæ‰“å¼€æœªè¯»çš„æ–‡ç« ï¼Œå¹¶æ‰¾åˆ°â€œç‚¹èµâ€å’Œâ€œæ”¶è—â€çš„æŒ‰é’®åæ ‡ï¼Œå®Œæˆç‚¹å‡»+æ”¶è—æ“ä½œåå…³é—­è¯¥ç¯‡æ–‡ç« ï¼Œä¹‹åæ›´æ–°æœªè¯»æ–‡ç« åå¾ªç¯æ“ä½œå³å¯ã€‚</p><h2 id="è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è¿‡ç¨‹"></a> è¿‡ç¨‹</h2><p>å®æ“ä¸‹æ¥å°±ç”¨äº†åå‡ è¡Œä»£ç ï¼Œå®æµ‹äº†äº”å…­åˆ†é’Ÿå®Œæˆäº†100ç¯‡æ–‡ç« çš„å¤„ç†ï¼Œè½»è½»æ¾æ¾å®Œæˆä¸¤ç™¾å¤šç§¯åˆ†çš„è·å–ã€‚äº‹äº†æ‹‚è¡£å»ï¼Œæ·±è—åŠŸä¸å~<br></p><h3 id="æºç å¦‚ä¸‹"><a class="markdownIt-Anchor" href="#æºç å¦‚ä¸‹"></a> æºç å¦‚ä¸‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyautogui<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_click</span>():<br>    pyautogui.click(<span class="hljs-number">1645</span>,<span class="hljs-number">774</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># æ”¶è— Point(x=1645, y=774)</span><br>    pyautogui.click(<span class="hljs-number">1742</span>,<span class="hljs-number">772</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># ç‚¹èµ Point(x=1742, y=772)</span><br>    pyautogui.click(<span class="hljs-number">1016</span>,<span class="hljs-number">29</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># å…³é—­æ ‡ç­¾ Point(x=1016, y=29)</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    time.sleep(<span class="hljs-number">5</span>) <span class="hljs-comment"># æ‰‹å·¥æ‰“å¼€å¾…å¤„ç†æµè§ˆå™¨</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> (i&lt;<span class="hljs-number">100</span>):<br>        <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            pyautogui.click(<span class="hljs-number">1594</span>,<span class="hljs-number">447</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># æ—¶é—´ä¼˜å…ˆ Point(x=1594, y=447)</span><br>            pyautogui.click(<span class="hljs-number">615</span>,<span class="hljs-number">578</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># æ‰“å¼€ç¬¬ä¸€ç¯‡æ–‡ç«  Point(x=615, y=578)</span><br>        <span class="hljs-keyword">else</span>:<br>            pyautogui.click(<span class="hljs-number">1751</span>,<span class="hljs-number">447</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># çƒ­åº¦ä¼˜å…ˆ Point(x=1751, y=447)</span><br>            pyautogui.click(<span class="hljs-number">615</span>,<span class="hljs-number">578</span>,duration=<span class="hljs-number">0.6</span>) <span class="hljs-comment"># æ‰“å¼€ç¬¬ä¸€ç¯‡æ–‡ç«  Point(x=615, y=578)</span><br>        auto_click()  <br>        i+=<span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç´¯è®¡å¤„ç†&#123;&#125;ç¯‡&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>PyAutoGUIç›¸æ¯”requestsã€urllibåº“å¯ä»¥ç”¨æ›´å°‘çš„ä»£ç é‡è§£å†³æ­¤é—®é¢˜ï¼Œå…å»äº†åçˆ¬è™«çš„å¤„ç†ï¼Œä½†å®é™…ä½¿ç”¨æ—¶è¿˜æ˜¯å‘ç°äº†ä¸€äº›å°çš„é—®é¢˜ï¼šå› ä¸ºæ˜¯ä¾é å±å¹•åæ ‡ç³»å®Œæˆé¼ æ ‡çš„æ“ä½œï¼Œåœ¨ç‚¹èµã€æ”¶è—å›¾æ ‡ä½ç½®å˜åŒ–ï¼ˆè™½ç„¶é¢‘æ¬¡å¾ˆä½ï¼‰æ—¶ä¸èƒ½å¾ˆå¥½çš„å¤„ç†ã€‚æˆ‘å°è¯•è¿‡pyautogui.locateCenterOnScreen()å»å®šä½ç‚¹èµå’Œæ”¶è—æŒ‰é’®çš„å…·ä½“ä½ç½®æ¥å®Œæˆæ¯ä¸€ç¯‡ç²¾å‡†æ— è¯¯çš„ç‚¹èµ+æ”¶è—ï¼Œä½†å› ä¸ºè¯†åˆ«æˆåŠŸç‡å’Œè¯†åˆ«æ•ˆç‡ä¹Ÿæ²¡æœ‰å¾ˆé«˜å°±æ”¾å¼ƒäº†ã€‚å³ä¾¿å¦‚æ­¤ï¼ŒPyAutoGUIä¾æ—§æ˜¯ç¥å™¨ï¼ŒåŠ©æˆ‘é¡ºåˆ©åˆ’æ°´ï¼Œè½»æ¾å®Œæˆæœˆåº¦ç§¯åˆ†ç›®æ ‡ğŸ˜ğŸ˜ğŸ˜</p><p>PyAutoGUIåº“çš„åŠŸèƒ½æœ‰ç‚¹åƒæˆ‘å‰å‡ å¹´ä½¿ç”¨è¿‡çš„æŒ‰é”®ç²¾çµã€UIPathæœºå™¨äººã€‚ç±»ä¼¼PyAutoGUIçš„pythonåº“è¿˜æœ‰win32guiã€pywinautoç­‰ï¼Œåç»­æœ‰æœºä¼šäº†å†ç ”ç©¶ä¸‹ã€‚ä¸å¯å¦è®¤çš„æ˜¯ï¼Œä½œä¸ºä¸€ç§è§£é‡Šæ€§è¯­è¨€ï¼Œpythonæ¯«æ— ç–‘é—®æ˜¯å€¼å¾—æˆ‘æ·±å…¥å­¦ä¹ å’Œä½¿ç”¨çš„ã€‚</p><h2 id="é™„pyautoguiåº“åŸºæœ¬ç”¨æ³•æ•´ç†"><a class="markdownIt-Anchor" href="#é™„pyautoguiåº“åŸºæœ¬ç”¨æ³•æ•´ç†"></a> é™„ï¼šPyAutoGUIåº“åŸºæœ¬ç”¨æ³•æ•´ç†</h2><h3 id="é¼ æ ‡é”®ç›˜æç¤ºæ¡†åŸºæœ¬æ“ä½œ"><a class="markdownIt-Anchor" href="#é¼ æ ‡é”®ç›˜æç¤ºæ¡†åŸºæœ¬æ“ä½œ"></a> é¼ æ ‡/é”®ç›˜/æç¤ºæ¡†åŸºæœ¬æ“ä½œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">####é¼ æ ‡æ“ä½œ####</span><br>pyautogui.position() <span class="hljs-comment"># è·å–å½“å‰é¼ æ ‡çš„åæ ‡</span><br>pyautogui.locateCenterOnScreen(<span class="hljs-string">r&#x27;C:/Users/admin/Desktop/sc.png&#x27;</span>) <span class="hljs-comment"># æ ¹æ®å›¾åƒè·å–å½“å‰ç•Œé¢å«æœ‰è¯¥å›¾åƒçš„ä¸­å¿ƒåæ ‡</span><br>pyautogui.click(<span class="hljs-number">1751</span>,<span class="hljs-number">447</span>,button=<span class="hljs-string">&#x27;left&#x27;</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># é¼ æ ‡å·¦å•å‡»ã€‚buttonçš„å‚æ•°å€¼æœ‰ï¼šleft,righ,middle</span><br>pyautogui.doubleClick(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)  <span class="hljs-comment"># æŒ‡å®šä½ç½®ï¼ŒåŒå‡»å·¦é”®</span><br>pyautogui.rightClick(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)   <span class="hljs-comment"># æŒ‡å®šä½ç½®ï¼ŒåŒå‡»å³é”®</span><br>pyautogui.middleClick(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)  <span class="hljs-comment"># æŒ‡å®šä½ç½®ï¼ŒåŒå‡»ä¸­é”®</span><br>pyautogui.mouseDown()   <span class="hljs-comment"># é¼ æ ‡æŒ‰ä¸‹</span><br>pyautogui.mouseUp()    <span class="hljs-comment"># é¼ æ ‡é‡Šæ”¾</span><br>pyautogui.dragTo(<span class="hljs-number">100</span>,<span class="hljs-number">300</span>,duration=<span class="hljs-number">1</span>)   <span class="hljs-comment"># æ‹–åŠ¨åˆ°æŒ‡å®šçš„ä½ç½®</span><br>pyautogui.dragRel(<span class="hljs-number">100</span>,<span class="hljs-number">500</span>,duration=<span class="hljs-number">4</span>)   <span class="hljs-comment"># æŒ‰æ–¹å‘æ‹–åŠ¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å·¦å³ç§»åŠ¨åƒç´ å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸Šä¸‹</span><br>pyautogui.scroll(<span class="hljs-number">300</span>)  <span class="hljs-comment"># å‘ä¸Šæ»šåŠ¨300ä¸ªå•ä½ï¼›</span><br>pyautogui.moveTo(<span class="hljs-number">100</span>,<span class="hljs-number">300</span>,duration=<span class="hljs-number">1</span>) <span class="hljs-comment"># ç§»åŠ¨é¼ æ ‡åˆ°x,yçš„ä½ç½®ï¼Œç§»åŠ¨æ—¶é—´1ç§’</span><br>pyautogui.moveRel(<span class="hljs-number">100</span>,<span class="hljs-number">500</span>,duration=<span class="hljs-number">4</span>) <span class="hljs-comment"># å‘å³ç§»åŠ¨xï¼Œå‘ä¸‹ç§»åŠ¨yï¼Œç§»åŠ¨æ—¶é—´4ç§’</span><br><br><span class="hljs-comment">####ç•Œé¢æ“ä½œ####</span><br>im = pyautogui.screenshot() <span class="hljs-comment">#è¿”å›å±å¹•çš„æˆªå›¾ï¼Œæ˜¯ä¸€ä¸ªPillowçš„imageå¯¹è±¡</span><br>im.save(<span class="hljs-string">&#x27;å±å¹•æˆªå›¾.png&#x27;</span>) <span class="hljs-comment">#ä¿å­˜å±å¹•æˆªå›¾</span><br>im.getpixel((<span class="hljs-number">500</span>, <span class="hljs-number">500</span>)) <span class="hljs-comment">#è¿”å›imå¯¹è±¡ä¸Šï¼Œï¼ˆ500ï¼Œ500ï¼‰è¿™ä¸€ç‚¹åƒç´ çš„é¢œè‰²ï¼Œæ˜¯ä¸€ä¸ªRGBå…ƒç»„</span><br>pyautogui.pixelMatchesColor(<span class="hljs-number">500</span>,<span class="hljs-number">500</span>,(<span class="hljs-number">12</span>,<span class="hljs-number">120</span>,<span class="hljs-number">400</span>)) <span class="hljs-comment">#æ˜¯ä¸€ä¸ªå¯¹æ¯”å‡½æ•°ï¼Œå¯¹æ¯”çš„æ˜¯å±å¹•ä¸Šï¼ˆ500ï¼Œ500ï¼‰è¿™ä¸€ç‚¹åƒç´ çš„é¢œè‰²ï¼Œä¸æ‰€ç»™çš„å…ƒç´ æ˜¯å¦ç›¸åŒï¼›</span><br><br><span class="hljs-comment">####é”®ç›˜è¾“å…¥####</span><br>pyautogui.keyDown(<span class="hljs-string">&#x27;shift&#x27;</span>)    <span class="hljs-comment"># æŒ‰ä¸‹shift</span><br>pyautogui.press(<span class="hljs-string">&#x27;4&#x27;</span>)    <span class="hljs-comment"># æŒ‰ä¸‹ 4</span><br>pyautogui.keyUp(<span class="hljs-string">&#x27;shift&#x27;</span>)   <span class="hljs-comment"># é‡Šæ”¾ shift</span><br>pyautogui.typewrite(<span class="hljs-string">&#x27;this&#x27;</span>,<span class="hljs-number">0.5</span>)Â  <span class="hljs-comment"># ç¬¬ä¸€å‚æ•°æ˜¯è¾“å…¥å†…å®¹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¯ä¸ªå­—ç¬¦é—´çš„é—´éš”æ—¶é—´ï¼›</span><br>pyautogui.typewrite([<span class="hljs-string">&#x27;T&#x27;</span>,<span class="hljs-string">&#x27;h&#x27;</span>,<span class="hljs-string">&#x27;i&#x27;</span>,<span class="hljs-string">&#x27;s&#x27;</span>]) <span class="hljs-comment">#typewrite è¿˜å¯ä»¥ä¼ å…¥å•å­—æ¯çš„åˆ—è¡¨ï¼›</span><br>pyautogui.typewrite([<span class="hljs-string">&#x27;T&#x27;</span>,<span class="hljs-string">&#x27;i&#x27;</span>,<span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>,<span class="hljs-string">&#x27;h&#x27;</span>,])   <span class="hljs-comment"># æœ‰æ—¶æˆ‘ä»¬éœ€è¦è¾“å…¥ä¸€äº›ç‰¹æ®Šçš„æŒ‰é”®ï¼Œæ¯”å¦‚å‘å·¦çš„ç®­å¤´ï¼Œè¿™äº›æœ‰ç›¸å¯¹åº”çš„é”®ç›˜å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œä¾‹å¦‚è¾“å‡ºï¼šThis</span><br>pyautogui.hotkey(<span class="hljs-string">&#x27;ctrl&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>) <span class="hljs-comment"># å¿«æ·é”®</span><br><br><span class="hljs-comment">####æç¤ºä¿¡æ¯æ¡†####</span><br>a = pyautogui.alert(text=<span class="hljs-string">&#x27;This is an alert box.&#x27;</span>, title=<span class="hljs-string">&#x27;Test&#x27;</span>) <span class="hljs-comment"># æç¤ºæ¡†/è­¦ç¤ºæ¡†</span><br><span class="hljs-built_in">print</span>(a)<br>a = pyautogui.confirm(<span class="hljs-string">&#x27;é€‰æ‹©ä¸€é¡¹&#x27;</span>, buttons=[<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>]) <span class="hljs-comment"># é€‰æ‹©æ¡†</span><br><span class="hljs-built_in">print</span>(a)<br>a = pyautogui.password(<span class="hljs-string">&#x27;Enter password (text will be hidden)&#x27;</span>) <span class="hljs-comment"># å¯†ç è¾“å…¥ï¼Œè¿”å›å€¼ä¸ºåˆšåˆšè¾“å…¥çš„å€¼</span><br><span class="hljs-built_in">print</span>(a)<br>a = pyautogui.prompt(<span class="hljs-string">&#x27;è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼š&#x27;</span>) <span class="hljs-comment"># æ™®é€šè¾“å…¥ï¼Œè¿”å›å€¼ä¸ºåˆšåˆšè¾“å…¥çš„å€¼</span><br><span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-comment">####å…¶ä»–####</span><br>pyautogui.size() <span class="hljs-comment"># è·å–å±å¹•åˆ†è¾¨ç‡</span><br><br><span class="hljs-comment">## åœé¡¿åŠŸèƒ½ã€‚æ„å‘³ç€æ‰€æœ‰pyautoguiçš„æŒ‡ä»¤éƒ½è¦æš‚åœä¸€ç§’ï¼›å…¶ä»–æŒ‡ä»¤ä¸ä¼šåœé¡¿ï¼›è¿™æ ·åšï¼Œå¯ä»¥é˜²æ­¢é”®ç›˜é¼ æ ‡æ“ä½œå¤ªå¿«ï¼›</span><br>pyautogui.PAUSE = <span class="hljs-number">1</span> <br><span class="hljs-comment">## è‡ªåŠ¨é˜²æ•…éšœï¼Œé»˜è®¤è¿™é¡¹åŠŸèƒ½ä¸ºTrue, è¿™é¡¹åŠŸèƒ½æ„å‘³ç€ï¼šå½“é¼ æ ‡çš„æŒ‡é’ˆåœ¨å±å¹•çš„æœ€åä¸Šæ–¹ï¼Œç¨‹åºä¼šæŠ¥é”™ï¼›ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢ç¨‹åºæ— æ³•åœæ­¢ï¼›</span><br>pyautogui.FAILSAFE =<span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure><h3 id="è¯†åˆ«å›¾åƒ"><a class="markdownIt-Anchor" href="#è¯†åˆ«å›¾åƒ"></a> è¯†åˆ«å›¾åƒ</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆè·å¾—ä¸€ä¸ªå±å¹•å¿«ç…§ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³è¦ç‚¹èµï¼Œæˆ‘ä»¬å°±å…ˆæŠŠå¤§æ‹‡æŒ‡çš„å›¾ç‰‡ä¿å­˜ä¸‹æ¥ï¼›ç„¶åä½¿ç”¨å‡½æ•°ï¼šlocateOnScreen(â€˜zan.pngâ€™) ï¼Œå¦‚æœå¯ä»¥æ‰¾åˆ°å›¾ç‰‡ï¼Œåˆ™è¿”å›å›¾ç‰‡çš„ä½ç½®ï¼Œå¦‚ï¼šBox(left=25, top=703, width=22, height=22)ï¼›å¦‚æœæ‰¾ä¸åˆ°å›¾ç‰‡ï¼Œåˆ™è¿”å›None;<br />å¦‚æœï¼Œå±å¹•ä¸Šæœ‰å¤šå¤„å›¾ç‰‡å¯ä»¥åŒ¹é…ï¼Œåˆ™éœ€è¦ä½¿ç”¨locateAllOnScreen(â€˜zan.pngâ€™) ï¼Œå¦‚æœåŒ¹é…åˆ°å¤šä¸ªå€¼ï¼Œåˆ™è¿”å›ä¸€ä¸ªlistï¼Œå‚è€ƒå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyautogui<br>pyautogui.PAUSE = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># å›¾åƒè¯†åˆ«ï¼ˆä¸€ä¸ªï¼‰</span><br>btm = pyautogui.locateOnScreen(<span class="hljs-string">&#x27;zan.png&#x27;</span>)<br><span class="hljs-built_in">print</span>(btm)  <span class="hljs-comment"># Box(left=1280, top=344, width=22, height=22)</span><br><br><span class="hljs-comment"># å›¾åƒè¯†åˆ«ï¼ˆå¤šä¸ªï¼‰</span><br>btm = pyautogui.locateAllOnScreen(<span class="hljs-string">&#x27;zan.png&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(btm)) <br></code></pre></td></tr></table></figure><p>pyautogui.center((left, top, width, height)) è¿”å›æŒ‡å®šä½ç½®çš„ä¸­å¿ƒç‚¹ï¼›è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†é…åˆé¼ æ ‡æ“ä½œç‚¹å‡»æ‰¾åˆ°å›¾ç‰‡çš„ä¸­å¿ƒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
      <category>GUIè‡ªåŠ¨åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªåŠ¨åŒ–</tag>
      
      <tag>Python</tag>
      
      <tag>PyAutoGui</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kettle|è‡ªåŠ©å·¡æ£€</title>
    <link href="/2022/04/25/Kettle-%E8%87%AA%E5%8A%A9%E5%B7%A1%E6%A3%80/"/>
    <url>/2022/04/25/Kettle-%E8%87%AA%E5%8A%A9%E5%B7%A1%E6%A3%80/</url>
    
    <content type="html"><![CDATA[<h2 id="æƒ³åˆ’æ°´è‚¯å®šæœ‰å®ƒçš„åŸå› "><a class="markdownIt-Anchor" href="#æƒ³åˆ’æ°´è‚¯å®šæœ‰å®ƒçš„åŸå› "></a> æƒ³åˆ’æ°´è‚¯å®šæœ‰å®ƒçš„åŸå› </h2><p>æ˜¯çš„ï¼Œæˆ‘åˆæƒ³åˆ’æ°´äº†~ ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å¼€å§‹ï¼Œæˆ‘è´Ÿè´£çš„ç³»ç»Ÿçªç„¶å°±å¤šçš„ä¸€æ‰¹ã€‚æ¯å¤©ä¸€å¤§æ—©è¦å¼€æµè§ˆå™¨æ£€æŸ¥B/Sç±»çš„å‡ ä¸ªç³»ç»Ÿæ˜¯å¦æ­£å¸¸ã€è¦å¼€å®¢æˆ·ç«¯æ£€æŸ¥C/Sç±»çš„å‡ ä¸ªç³»ç»Ÿæ˜¯å¦æ­£å¸¸ã€è¿˜è¦æ£€æŸ¥å¥½å‡ ä¸ªç³»ç»Ÿçš„å®šæ—¶ä»»åŠ¡æ˜¯å¦æ­£å¸¸ã€è¿˜è¦æ£€æŸ¥ä¸ƒå…«å°æ•°æ®åº“çš„å¤‡ä»½æ˜¯ä¸æ˜¯æ­£å¸¸ã€‚åæ¥å‘ç°ï¼ï¼ï¼æˆ‘ç«Ÿç„¶è¿˜æœ‰ä¸€ä¸ªLDAPçš„æ•°æ®è¦åŠæ—¶æ£€æŸ¥æ›´æ–°ï¼ˆå…³äºLDAPçœŸçš„æ˜¯åˆçˆ±åˆæ¨ï¼Œæœ‰ç©ºè¦å±•å¼€è¯´è¯´ï¼‰ã€‚å‰æ®µæ—¶é—´æ¯å¤©æ—©ä¸Šå¿™æ´»ä¸€é˜µå·²ç»äºŒååˆ†é’Ÿè¿‡å»äº†~åæ­£æˆ‘åˆæƒ³å·æ‡’äº†ğŸ˜µğŸ˜µğŸ˜µ</p><h2 id="æ€ä¹ˆçªç„¶æƒ³åˆ°äº†kettle"><a class="markdownIt-Anchor" href="#æ€ä¹ˆçªç„¶æƒ³åˆ°äº†kettle"></a> æ€ä¹ˆçªç„¶æƒ³åˆ°äº†KETTLE</h2><p>ETLå·¥å…·æˆ‘å¹³æ—¶å·¥ä½œå…¶å®æ˜¯ä¸æ€ä¹ˆç”¨å¾—åˆ°çš„ï¼Œæ„Ÿè§‰æ—¥å¸¸çš„ä½¿ç”¨éœ€æ±‚ç”¨ETLå·¥å…·å¤ªç¬¨é‡äº†ã€‚æƒ³åˆ°ç”¨KETTLEä¹Ÿæ˜¯æ²¡åŠæ³•äº†ï¼Œæ—¥å¸¸å·¡æ£€æ¶‰åŠåˆ°æ•°æ®åº“å’Œç½‘ç»œçš„æ£€æŸ¥/å¤„ç†ï¼Œå¾ˆå°‘æœ‰ä¸€æ¬¾å·¥å…·å¯ä»¥ä¸€é”®æå®šï¼Œè€Œä¸”è‡ªå·±å†™Shellæˆ–Pythonè„šæœ¬çš„è¯ä¹Ÿå¾ˆæœ‰ç‚¹éº»çƒ¦ã€‚<br><br />Kettleæ˜¯ä¸€æ¬¾å¼€æºçš„ETLå·¥å…·ï¼Œçº¯javaç¼–å†™ï¼Œå¯ä»¥åœ¨Windowã€Linuxã€Unixä¸Šè¿è¡Œï¼Œç»¿è‰²æ— éœ€å®‰è£…ï¼Œæ•°æ®æŠ½å–é«˜æ•ˆç¨³å®šã€‚ï¼ˆè¿™ä¸€å¥æºäºç™¾åº¦~ ï¼‰åæ­£KETTLåœ¨æ•°æ®å¤„ç†ä¸Šå°±æ˜¯å¾ˆçµæ´»ï¼ŒåŸºæœ¬æ”¯æŒå¸¸ç”¨çš„å„ç±»æ ¼å¼çš„æ•°æ®æ¥å…¥ã€å¸¸è§è§„åˆ™ä¸‹çš„æ•°æ®è½¬æ¢å’ŒåŠ å·¥ã€å¸¸è§æ ¼å¼çš„æ•°æ®è¾“å‡ºï¼Œè€Œä¸”å¯¹WebæœåŠ¡çš„å¸¸è§éœ€æ±‚ä¹Ÿå¯ä»¥æå®šã€‚ç®€ç›´ä¸‡é‡‘æ²¹ä¸€æ ·çš„å·¥å…·~ğŸ‘ğŸ‘ğŸ‘</p><h2 id="ç®€å•å°è¯•äº†ä¸€ä¸‹"><a class="markdownIt-Anchor" href="#ç®€å•å°è¯•äº†ä¸€ä¸‹"></a> ç®€å•å°è¯•äº†ä¸€ä¸‹</h2><p>Kettleåˆ†ä¸ºä½œä¸šå’Œè½¬æ¢æ¨¡å¼ï¼Œâ€œä½œä¸šâ€åŸºæœ¬å°±ç­‰åŒäºå®Œæ•´çš„æµç¨‹åŒ–å¤„ç†ã€â€œè½¬æ¢â€å¸¸ç”¨äºæ•°æ®çš„å¤„ç†å’ŒåŠ å·¥ã€‚<br><br />âœ”ï¸å…¬å¸æ—¥å¸¸äººå‘˜å˜åŠ¨éœ€è¦å»LDAPä¸­è¿›è¡Œç‰©ç†åˆ é™¤ç›¸å…³ä¿¡æ¯ï¼šå†™ä¸ªè½¬æ¢ï¼ŒæŸ¥è¯¢å‡ºæ¥å†…ç½‘é—¨æˆ·ä¸­äººå‘˜å˜åŠ¨æ¸…å•ï¼Œç„¶åå»LDAPä¸­æŸ¥åˆ°åæ‰§è¡Œåˆ é™¤æ“ä½œã€‚<br><br />âœ”ï¸å…¬å¸é€šè®¯å½•åå•ï¼ˆexcelï¼‰å®šæœŸæ›´æ–°åˆ°æ•°æ®åº“ä¸­ï¼šå†™ä¸ªè½¬æ¢ï¼Œè¯»å–excelæ•°æ®ï¼Œç„¶åå»å¯¹åº”çš„æ•°æ®åº“ä¸­æ‰§è¡Œæ›´æ–°æ“ä½œã€‚<br><br />âœ”ï¸å‡ ä¸ªæ—¥å¸¸éœ€è¦æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸çš„ç³»ç»Ÿï¼šé€šè¿‡ä½œä¸šï¼Œæ£€æŸ¥WebæœåŠ¡æ˜¯å¦æ­£å¸¸<br><br />âœ”ï¸å‡ ä¸ªæ—¥å¸¸éœ€è¦æ£€æŸ¥å®šæ—¶ä»»åŠ¡æ˜¯å¦æ­£å¸¸çš„ç³»ç»Ÿï¼šé€šè¿‡ä½œä¸šï¼Œæ£€æŸ¥æ•°æ®åº“æ˜¯å¦æ­£å¸¸<br><br />ç°åœ¨æ¯å¤©æ—©ä¸Šç‚¹å¼€æ‰§è¡Œä»¥ä¸‹ï¼Œç„¶ååªéœ€è¦æ£€æŸ¥ä¸‹æ•°æ®åº“å¤‡ä»½å°±å®Œäº‹äº†~ï¼ˆæ•°æ®åº“å·¡æ£€çš„äº‹æˆ‘æ—©æ™šä¹Ÿè¦æä¸€ä¸‹ğŸ˜‚ğŸ˜‚ğŸ˜‚ï¼‰<br /><img src="https://s2.loli.net/2022/08/17/IXgUKAqOFnzcGV9.png" alt="LDAPç¦»èŒäººå‘˜å¤„ç†" /><br /><img src="https://s2.loli.net/2022/08/17/U1PW689arvsJFOH.png" alt="å‘˜å·¥ç”µè¯å·ç æ›´æ–°" /><br /><img src="https://s2.loli.net/2022/08/17/U6XLeYaOcW7bpEi.png" alt="kettleæ—¥å¸¸å·¡æ£€æ‰§è¡Œ" /></p><h2 id="æœ€å"><a class="markdownIt-Anchor" href="#æœ€å"></a> æœ€å</h2><p>ç”¨Kettleæ¥åšæ—¥å¸¸å·¡æ£€æ„Ÿè§‰æœ‰ç‚¹å¤§æå°ç”¨äº†ï¼Œä½†å€Ÿæ­¤æœºä¼šåˆäº†è§£ä¸€ä¸ªæ–°çš„å·¥å…·è¿˜æ˜¯å¾ˆæ»¡æ„çš„ã€‚æ€»ä½“çœ‹æ¥Kettleè¿˜æ˜¯å¾ˆå®¹æ˜“ä¸Šæ‰‹çš„ï¼Œå›¾å½¢åŒ–ç•Œé¢ä¹Ÿç›¸å¯¹å‹å¥½ï¼Œæ“ä½œä¹Ÿå¾ˆç®€å•ã€‚æœ¬ç€è™šå¿ƒå­¦ä¹ çš„å¿ƒæ€æˆ‘åœ¨Bç«™ä¸Šæ‰¾äº†æ“ä½œæ•™ç¨‹ï¼Œä½†æ ¹æœ¬æ²¡åšæŒçœ‹å®ŒğŸ˜‚ğŸ˜‚ğŸ˜‚UPä¸»è®²çš„å¾ˆå¥½ï¼Œä¸»è¦æ˜¯Kettleå¤ªå®¹æ˜“ä¸Šæ‰‹äº†ã€‚<br><br />Bç«™é“¾æ¥ï¼š<a href="https://b23.tv/P65jHuI">2019kettle8.2æœ€æ–°æ•™ç¨‹-å“”å“©å“”å“©</a></p>]]></content>
    
    
    <categories>
      
      <category>Kettle</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Kettle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Excel|åˆå¹¶å½“å‰ç›®å½•æ‰€æœ‰çš„excelæ–‡ä»¶</title>
    <link href="/2019/08/29/VBA-%E5%90%88%E5%B9%B6excel%E6%96%87%E4%BB%B6/"/>
    <url>/2019/08/29/VBA-%E5%90%88%E5%B9%B6excel%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="åŠŸèƒ½æè¿°"><a class="markdownIt-Anchor" href="#åŠŸèƒ½æè¿°"></a> åŠŸèƒ½æè¿°</h2><p>å‰å‡ å¹´åšé¡¹ç›®æ—¶æœ‰æ¬¡é¡¹ç›®ç»„æ•´ç†å®¢æˆ·çš„ç‰©æ–™ç¼–ç ï¼Œæ¶‰åŠä¸Šä¸‡æ¡æ•°æ®çš„æ•´ç†ã€‚åå‡ ä¸ªäººåˆ†å·¥æ•´ç†åè¿˜éœ€è¦åˆå¹¶åˆ°ä¸€ä¸ªexcelåšè¿›ä¸€æ­¥å¤„ç†ã€‚é€ä¸ªç²˜è´´åˆ°ä¸€ä¸ªè¡¨ä¸­ä¸ä»…è´¹æ—¶é—´è¿˜å®¹æ˜“å‡ºé”™ï¼Œåæ¥ç™¾åº¦äº†ä¸€ä¸ªæ–¹æ³•ï¼šé€šè¿‡VBAåˆå¹¶å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰å·¥ä½œç°¿çš„å…¨éƒ¨å·¥ä½œè¡¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs VBA">Sub åˆå¹¶å½“å‰ç›®å½•ä¸‹æ‰€æœ‰å·¥ä½œç°¿çš„å…¨éƒ¨å·¥ä½œè¡¨()<br>Dim MyPath, MyName, AWbName<br>Dim Wb As Workbook, WbN As String<br>Dim G As Long<br>Dim Num As Long<br>Dim BOX As String<br>Application.ScreenUpdating = False<br>MyPath = ActiveWorkbook.Path<br>MyName = Dir(MyPath &amp; &quot;\&quot; &amp; &quot;*.xls&quot;)<br>AWbName = ActiveWorkbook.Name<br>Num = 0<br>Do While MyName &lt;&gt; &quot;&quot;<br>If MyName &lt;&gt; AWbName Then<br>Set Wb = Workbooks.Open(MyPath &amp; &quot;\&quot; &amp; MyName)<br>Num = Num + 1<br>With Workbooks(1).ActiveSheet<br>.Cells(.Range(&quot;B65536&quot;).End(xlUp).Row + 2, 1) = Left(MyName, Len(MyName) - 4)<br>For G = 1 To Sheets.Count<br>Wb.Sheets(G).UsedRange.Copy .Cells(.Range(&quot;B65536&quot;).End(xlUp).Row + 1, 1)<br>Next<br>WbN = WbN &amp; Chr(13) &amp; Wb.Name<br>Wb.Close False<br>End With<br>End If<br>MyName = Dir<br>Loop<br>Range(&quot;B1&quot;).Select<br>Application.ScreenUpdating = True<br>MsgBox &quot;å…±åˆå¹¶äº†&quot; &amp; Num &amp; &quot;ä¸ªå·¥ä½œè–„ä¸‹çš„å…¨éƒ¨å·¥ä½œè¡¨ã€‚å¦‚ä¸‹ï¼š&quot; &amp; Chr(13) &amp; WbN, vbInformation, &quot;æç¤º&quot;<br>End Sub<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Excel</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VBA</tag>
      
      <tag>Excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
